var eba_server_version;var eba_serverVersion; var eba_client_version;var eba_clientVersion; var eba_login_name; var eba_login_password; var eba_loginName; var eba_loginPassword; var eba_server; var eba_speech_server; var eba_speechServer; var eba_speech_server_backup;var eba_speechServerBackup; var eba_folder;var eba_client_folder;var eba_clientFolder; var eba_voice; var eba_hover_flag; var eba_bubble_mode; var eba_bubble_freeze_on_shift_flag; var eba_voice_from_lang_flag; var eba_speed_value; var eba_speedValue; var eba_speed_offset; var eba_initial_speech_on; var eba_continuous_reading; var eba_play_start_point; var eba_speech_started_callback; var eba_rendering_speech_callback; var eba_speech_complete_callback; var eba_page_complete_callback; var eba_speak_selection_by_sentence; var eba_page_complete_after_selection; var eba_use_container; var eba_override_x; var eba_override_y; var eba_icons;var eba_no_display_icons; var eba_no_title; var eba_noTitleFlag;var eba_hidden_bar; var eba_speech_range_colours; var eba_speech_word_colours; var eba_allow_alerts_flag; var eba_language; var eba_locale; var eba_ignore_buttons;var eba_max_word_count;var eba_logo_url = null; var eba_inline_img; var eba_cache_buster; var eba_dictionary_server; var eba_custom_dictionary_url; var eba_alt_dictionary_url; var eba_translate_server; var eba_translate_source; var eba_translate_target; var eba_mp3_id; var eba_mp3_limit; var eba_mp3_callback; var eba_cust_id; var eba_custId; var eba_book_id; var eba_bookId; var eba_page_id; var eba_pageId; var eba_clientside_pronunciation; var eba_annotate_confirm_delete_note; var eba_annotate_persist_notes; var eba_annotate_persist_highlights; var eba_annotate_note_editor_id; var eba_annotate_highlight_editor_id; var eba_annotate_storage_url; var eba_annotate_note_reader_id; var eba_annotate_highlight_reader_id; var eba_speechCacheGenerateFlag;var eba_cache_building_mode;var eba_speechCacheFlag;var eba_speech_cache_flag;var eba_cache_mode; var eba_cache_live_generation;var eba_autoCachePage;var eba_cacheResult =""; var eba_cache_retry; var eba_cache_retry_timeout; var eba_cache_selection; var eba_cache_user_text; var eba_split_cache_path; var eba_autocache_generate;var eba_autocache_check;var eba_autocache_allspeeds;var eba_autocache_callback;var eba_check_pronunciation_before_cache; var eba_skip_on_error; var eba_alter_browser_for_consistency;var eba_ssl_flag; var eba_ssl_speech; var eba_ssl_toolbar; var eba_search_speech_server; var eba_replace_speech_server; var eba_store_pref; var eba_no_flash; var eba_handle_radio_checkbox_click; var eba_bypass_dom_check = false; var eba_limit_cookies; var eba_title;var ls_teacherFlag = false; var eba_reading_age;/* Copyright 2005-2008 Texthelp Systems Ltd
*/var baa = false;var caa ="DISABLED CLICK_SPEAK HOVER_SPEAK BUBBLE_SPEAK KEY_PRESS_SPEAK";var daa ="r\x77DontA\x6cter";var eaa ="r\x77T\x48c\x6fmp";var faa ="r\x77THgen";var gaa ="r\x77THpgen";var haa ="t\x65xth\x65\x6cpSt\x6fpC\x6fntinuo\x75s";var iaa ="t\x65xthelp\x53ki\x70";var jaa = false; var FAST_SPEED = 55;var MEDIUM_SPEED = 40;var DEFAULT_SPEED = MEDIUM_SPEED;var SLOW_SPEED = 25;var VERY_SLOW_SPEED = 15;var READING_AGE_4 = 25;var READING_AGE_5 = 25;var READING_AGE_6 = 26;var READING_AGE_7 = 27;var READING_AGE_8 = 28;var paa = 29;var READING_AGE_10 = 30;var READING_AGE_11 = 35;var READING_AGE_12 = 40;var READING_AGE_13 = 44;var READING_AGE_14 = 46;var READING_AGE_15 = 48;var READING_AGE_16 = 50;var qaa ="eba_language ENG_UK  ENGLISH UK ENG_US ENGLISH_US SPANISH SPANISH_US ESPANOL SPANISH_ES FRENCH FRENCH_CN GERMAN ITALIAN DUTCH SWEDISH AUSTRALIAN";var ENG_UK = 0;var UK = 0; var ENGLISH = 0; var ENGLISH_UK = 0; var ENG_US = 1;var ENGLISH_US = 1;var SPANISH = 2;var SPANISH_US = 2;var ESPANOL = 3; var SPANISH_ES = 3;var FRENCH = 4;var FRENCH_CN = 5;var GERMAN = 6;var ITALIAN = 7;var DUTCH = 8;var SWEDISH = 9;var AUSTRALIAN = 10;var Hba = ["ScanSoft Emily_Full_22kHz","ScanSoft Samantha_Full_22kHz","ScanSoft Paulina_Full_22kHz","ScanSoft Isabel_Full_22kHz","ScanSoft Virginie_Full_22kHz","ScanSoft Julie_Full_22kHz","ScanSoft Steffi_Full_22kHz","ScanSoft Silvia_Full_22kHz","ScanSoft Claire_Full_22kHz","ScanSoft Ingrid_Full_22kHz","ScanSoft Karen_Full_22kHz"]; var Iba ="eba_locale LOCALE_UK LOCALE_US ";var LOCALE_UK ="UK";var LOCALE_US ="US";var Lba = [ ["\x43l\x69ck\x20To\x20Spe\x61k\x20Mode","\x53e\x6c\x65ct\x20this\x20th\x65n\x20click\x20anywher\x65\x20in\x20the\x20boo\x6b\x20t\x6f\x20start\x20readin\x67\x20text","\x48az\x20clic\x20para\x20el\x20mod\x6f\x20hab\x6cad\x6f"], ["\x53pe\x61k\x20T\x68e\x20Current\x20Select\x69on","\x53pea\x6b\x20th\x65\x20curr\x65nt\x20select\x69on","\x4ce\x65r\x20en\x20voz\x20alta\x20e\x6c\x20texto\x20se\x6ce\x63c\x69onado"], ["\x50a\x75se\x20Spe\x65ch","\x50ause\x20S\x70eech","\x44\x69scurso\x20de\x20p\x61usa"], ["\x53top\x20\x53pe\x65ch","\x53to\x70s\x20speec\x68\x20pl\x61y\x62ack","\x50\x61rar\x20v\x6fz"], ["\x54ranslat\x65\x20Word","\x44ou\x62le-cli\x63\x6b\x20a\x20word\x20in\x20t\x68\x65\x20b\x6fo\x6b\x20and\x20cl\x69ck\x20this\x20\x69con\n"+"t\x6f\x20translat\x65\x20th\x65\x20wor\x64\x20into\x20Spanis\x68","\x54radu\x63ir\x20palabr\x61"], ["\x46act\x20Fin\x64\x65r","\x53e\x6ce\x63t\x20som\x65\x20text\x20in\x20the\x20\x62ook\x20and\x20click\x20t\x68is\x20ic\x6fn\x20to\n"+"\x70erform\x20a\x20Google\x20s\x65arc\x68","\x42us\x63\x61d\x6fr\x20d\x65\x20\x64atos"], ["\x44iction\x61ry","\x44\x6fuble-c\x6ci\x63k\x20\x61\x20word\x20in\x20t\x68e\x20b\x6f\x6fk\x20and\x20c\x6c\x69c\x6b\x20this\x20i\x63on\x20to\n"+"s\x65e\x20d\x69\x63ti\x6fnary\x20def\x69nitions","\x44iccion\x61rio"], ["\x48ighlig\x68t\x20Cyan","\x4dak\x65\x20a\x20select\x69on\x20in\x20the\x20\x62oo\x6b\x20and\x20c\x6cick\x20th\x69s\x20icon\x20to\n"+"\x63re\x61t\x65\x20a\x20bl\x75e\x20h\x69ghl\x69g\x68t","\x52\x65alce\x20a\x7aul\x20verdoso"], ["\x48\x69gh\x6cight\x20Magent\x61","\x4dake\x20a\x20select\x69on\x20\x69n\x20the\x20\x62\x6fok\x20\x61nd\x20c\x6cic\x6b\x20t\x68is\x20i\x63on\x20to\n"+"\x63reate\x20a\x20pink\x20h\x69\x67hl\x69g\x68t","\x52ealce\x20morad\x6f"], ["\x48ig\x68light\x20Ye\x6clow","\x4dak\x65\x20a\x20s\x65lection\x20in\x20th\x65\x20b\x6fok\x20and\x20cl\x69c\x6b\x20this\x20i\x63on\x20to\n"+"\x63reate\x20a\x20ye\x6clow\x20\x68ighlig\x68t","\x52ealce\x20amaril\x6co"], ["\x48ig\x68l\x69ght\x20Gr\x65en","\x4d\x61ke\x20\x61\x20select\x69\x6fn\x20\x69n\x20t\x68e\x20b\x6fok\x20and\x20cl\x69c\x6b\x20this\x20i\x63on\x20to\n"+"\x63reat\x65\x20a\x20\x67reen\x20hi\x67\x68light","\x52ealc\x65\x20\x76\x65r\x64e"], ["\x52e\x6dov\x65\x20Hi\x67hl\x69ghts","\x52\x65move\x20all\x20\x79our\x20\x68i\x67hl\x69ghts\x20from\x20this\x20page","\x42orrar\x20realce"], ["\x43o\x6clect\x20\x48igh\x6cights","\x43ollect\x20a\x6cl\x20\x79our\x20\x68ighl\x69g\x68ts\x20\x61nd\x20d\x69splay\x20th\x65m\n"+"\x69n\x20\x61\x20window,\x20group\x65d\x20b\x79\x20c\x6flor","\x52\x65\x63opil\x61r\x20realces"], ["\x43lick\x20here\x20t\x6f\x20select\x20the\x20t\x65xt","\x43lick\x20here\x20t\x6f\x20select\x20th\x65\x20text","clic aqu"+ String.fromCharCode(237) +"\x20par\x61\x20desta\x63ar"], ["\x4d\x503\x20Maker","\x4dP3\x20Maker","\x4d\x503\x20Mak\x65r"], ["\x43alcul\x61t\x6fr","\x43alcul\x61tor","\x43a\x6cculator"], ["\x47enerat\x65\x20\x43ac\x68e","\x47enerate\x20Cac\x68e","\x47\x65nerate\x20Cac\x68e"], ["\x43heck\x20Cac\x68e","\x43hec\x6b\x20Cac\x68e","\x43hec\x6b\x20C\x61che"], ["\x50icture\x20D\x69ctionar\x79","\x50\x69ct\x75re\x20Dicti\x6fn\x61r\x79","\x50ict\x75re\x20Dicti\x6fn\x61ry"]];var Mba = 0;var Nba = Mba++;var Oba = Mba++;var Pba = Mba++;var Qba = Mba++;var Rba = Mba++;var Sba = Mba++;var Tba = Mba++;var Uba = Mba++;var Vba = Mba++;var Wba =Mba++;var Xba = Mba++;var Yba = Mba++;var Zba = Mba++;var aba = Mba++;var bba = Mba++;var cba = Mba++;var dba = Mba++;var eba = Mba++;var fba = Mba++;var clicktospeak_icon = 1;var play_icon = 2;var search_icons = 28;var translation_icon = 4;var factfinder_icon = 8;var dictionary_icon = 16;var language_icons = 224;var spelling_icon = 32;var homophone_icon = 64;var prediction_icon = 128;var highlight_icons = 3840;var highlightcyan_icon = 256;var highlightmagenta_icon = 512;var highlightyellow_icon = 1024;var highlightgreen_icon = 2048;var collect_icon = 4096;var submit_icon = 8192;var sticky_icon = 16384;var funplay_icon = 32768;var proncreate_icon = 65536;var pronCreate_icon = 65536;var pronedit_icon = 131072;var pronEdit_icon = 131072;var selectSpeed_icon = 262144;var selectspeed_icon = 262144;var pause_icon = 524288;var mp3_icon = 1048576;var calculator_icon = 2097152;var generatecache_icon = 4194304;var checkcache_icon = 8388608;var picturedictionary_icon = 16777216;var imagedictionary_icon = 16777216;var fullbrowsealoud_icons = 7967;var standardbrowsealoud_icons = 31;var minbrowsealoud_icons = 1;var lessonserver_icons = 12063;var lessonserverswa_icons = 12287;var no_bar = 0;var main_icons = 7967;var standard_icons = 31;var min_icons = 1;var title_rw = 0;var title_ba = 1;var title_ebooks = 2;var title_th = 3;var title_portal = 4;var gba = false;var hba = false;var iba = false;var jba = false;var kba = false;var lba = false;var mba = false;var nba = false;var oba = false;var pba = false;var qba = true;var rba = true;var sba =" ls_teacherFlag FAST_SPEED DEFAULT_SPEED MEDIUM_SPEED SLOW_SPEED VERY_SLOW_SPEED pause_icon mp3_icon calculator_icon generatecache_icon checkcache_icon picturedictionary_icon";var tba;var uba = false;var vba ="color:#000000; background:#FFFF00";var wba ="color:#FFFFFF; background:#0000FF";var xba = null;var yba = false; var zba = false;var Aca = false;var eba_actual_version ="183";var Bca ="3";var Cca ="183"; var Dca ="159"; var Eca = fullbrowsealoud_icons;var Fca = 0;var Gca ="speechus.texthelp.com";var Hca ="speechus.texthelp.com";var Ica = null; var Jca = null;var Kca = null;var Lca ="SpeechStream";var Mca ="/SpeechStream/";var Nca ="ScanSoft Samantha_Full_22kHz";var Oca = title_th;var Pca = null; var Qca = null; var Rca = null; var Sca = -1;var Tca ="rwonline"; var Uca ="rwonline";var Vca = 0; var Wca = false; var Xca = null; var Yca ="US"; var Zca = MEDIUM_SPEED;var aca = false;var bca = false; var cca = false;var dca = false;var eca = false;var fca = false;var gca = false;var hca = false;var ica = null;var jca = 1;var kca = false;var lca = false;var mca = -1; var nca = -1; var oca = false;var pca = false;var qca = CLICK_SPEAK;var rca = false; var sca = false; var tca ="*"; var uca ="*"; var vca ="*"; var wca ="*"; var xca = false; var yca = false; var zca ="portal.texthelp.com"; var Ada =""; var Bda = true;var Cda = null;var Dda = null;var Eda = false;var Fda = false;var Gda = null;var Hda = 10 * 1024;var Ida = false;var Jda = false;var Kda = -1;var Lda = -1;var Mda = -1;var Nda = -1;var Oda = -1;var Pda = false;var Qda = false;var Rda = false;var Sda = false;var Tda = true;var Uda = null;var Vda = false;var Wda = false;var Xda = true;var Yda = false;var Zda = false;var ada = false;var bda = false;var cda = false;var dda = false;var eda = true;var fda = true;var gda = null;var hda = false;var ida = null;var jda = null; var kda = 0; var lda = 0; var mda = 0; var nda = 0; var oda = false;var pda = false;var qda = false;var rda = null;function $rw_setIconsToLoad(p_nIcons){ var sda = false; if((p_nIcons & clicktospeak_icon) == clicktospeak_icon) { if(!Wda) { Kda = Uha('hover', Lba[Nba][Vca]); } sda = true; } if((p_nIcons & play_icon) == play_icon) { if(! (eca && !dca && !fca) ) { if(!Wda) { Gha('play', Lba[Oba][Vca]); } sda = true; } } if((p_nIcons & pause_icon) == pause_icon) { Gha('pause', Lba[Pba][Vca],"gif"); } if(sda) { Gha('stop', Lba[Qba][Vca]); } var tda = false; if((p_nIcons & funplay_icon) == funplay_icon) { Gha('funplay', Lba[Oba][Vca]); tda = true; } if(tda) { Gha('funstop', Lba[Qba][Vca]); } if((p_nIcons & translation_icon) == translation_icon) { Gha('trans', Lba[Rba][Vca]); } if((p_nIcons & factfinder_icon) == factfinder_icon) { Gha('ffinder', Lba[Sba][Vca]); } if((p_nIcons & dictionary_icon) == dictionary_icon) { Gha('dict', Lba[Tba][Vca]); } if((p_nIcons & picturedictionary_icon) == picturedictionary_icon) { Gha('picturedictionary', Lba[fba][Vca],"gif"); } if((p_nIcons & spelling_icon) == spelling_icon) { Mda = Uha('spell','Spell Checker'); } if((p_nIcons & homophone_icon) == homophone_icon) { Nda = Uha('homophone','Homophone Checker'); } if((p_nIcons & prediction_icon) == prediction_icon) { Oda = Uha('pred','Prediction Checker'); } var uda = false; if((p_nIcons & highlightcyan_icon) == highlightcyan_icon) { Gha('cyan', Lba[Uba][Vca]); uda = true; } if((p_nIcons & highlightmagenta_icon) == highlightmagenta_icon) { Gha('magenta', Lba[Vba][Vca]); uda = true; } if((p_nIcons & highlightyellow_icon) == highlightyellow_icon) { Gha('yellow', Lba[Wba][Vca]); uda = true; } if((p_nIcons & highlightgreen_icon) == highlightgreen_icon) { Gha('green', Lba[Xba][Vca]); uda = true; } if(uda) { Gha('clear', Lba[Yba][Vca]); } if((p_nIcons & collect_icon) == collect_icon) { Gha('collect', Lba[Zba][Vca]); } if((p_nIcons & mp3_icon) == mp3_icon) { Gha('mp3', Lba[bba][Vca],"gif"); } if((p_nIcons & calculator_icon) == calculator_icon) { Gha('calculator', Lba[cba][Vca],"gif"); } if((p_nIcons & generatecache_icon) == generatecache_icon) { Gha('generate_cache', Lba[dba][Vca],"gif"); } if((p_nIcons & checkcache_icon) == checkcache_icon) { Gha('check_cache', Lba[eba][Vca],"gif"); } if((p_nIcons & submit_icon) == submit_icon) { Gha('submit','Submit'); } if((p_nIcons & sticky_icon) == sticky_icon) { Lda = Uha('sticky','Sticky note','gif'); } if(Pca != null && Qca != null && Rca != null) { if((p_nIcons & pronCreate_icon) == pronCreate_icon) { Gha('pronCreate','Create pronunciation','gif'); } if((p_nIcons & pronEdit_icon ) == pronEdit_icon ) { Gha('pronEdit','Edit pronunciation','gif'); } }}var vda = 0;function $rw_setVoice(sPb){ if(typeof(sPb) =="string") { if(sPb != null && sPb.length > 0) { eba_voice = sPb; Nca = sPb; try { var xda = cka(); xda.setVoiceName(Nca); } catch(err) { pJb(err); } } }}function $rw_setVoiceForLanguage(sPb, p_nLanguageCode){ if(typeof(p_nLanguageCode) =="string") { try { p_nLanguageCode = parseInt(p_nLanguageCode); } catch(err) { pJb(err); return; } } if(typeof(sPb) =="string"&& typeof(p_nLanguageCode) =="number") { if(sPb != null && sPb.length > 0 && p_nLanguageCode >= 0 && p_nLanguageCode < Hba.length) { Hba[p_nLanguageCode] = sPb; } }}function $rw_setSpeedValue(p_nSpeedValue){ if(typeof(p_nSpeedValue) =="number") { if(p_nSpeedValue > -4 && p_nSpeedValue < 101) { eba_speedValue = p_nSpeedValue; eba_speed_value = p_nSpeedValue; eba_reading_age = p_nSpeedValue; Zca = p_nSpeedValue; try { if(vfa) { var xda = cka(); xda.setSpeedValue(""+ Zca); } } catch(err) { pJb(err); } } } else if(typeof(p_nSpeedValue) =="string") { var lab = p_nSpeedValue.toUpperCase(); if(lab =="VERY_SLOW_SPEED") { $rw_setSpeedValue(VERY_SLOW_SPEED); } else if(lab =="SLOW_SPEED") { $rw_setSpeedValue(SLOW_SPEED); } else if(lab =="MEDIUM_SPEED") { $rw_setSpeedValue(MEDIUM_SPEED); } else if(lab =="FAST_SPEED") { $rw_setSpeedValue(FAST_SPEED); } }}function $rw_setBarVisibility(Hna){ if(typeof(Hna) =="\x62oo\x6cean") { var zda = document.getElementById("r\x77Drag"); if(Hna) { zda.style.visibility ="\x76isible"; zda.style.display ="\x69nl\x69ne"; } else { zda.style.visibility ="\x68idden"; zda.style.display ="n\x6fne"; } bca = !Hna; Jma(); }}function $rw_enableClickToSpeak(p_bEnable){ if(p_bEnable && !$g_bMouseSpeech) { $rw_event_hover(null, Kda); } else if(!p_bEnable && $g_bMouseSpeech) { $rw_event_hover(null, Kda); if(Kda > -1) { var KGb = Gga; Gga = 0; Foa("\x68o\x76er"); Gga = KGb; } }}function $rw_enableSpeachByBubbleMode(rma){ if(baa) { Wda = rma; if(Wda == false) { vja(); wja(); $rw_stopSpeech(); } } else { Yda = !rma; }}function $rw_enableContinuousReading(rma){ Tda = rma; eba_continuous_reading = rma; if(!Tda) { Uda = null; eda = false; } else { if(typeof(eba_speak_selection_by_sentence) =="boolean") { eda = eba_speak_selection_by_sentence; } else { eda = true; } if($rw_isSpeaking() && Era != null && Uda == null) { if(jHb != null) { var i; for(i=0; i<jHb.length; i++) { if(jHb[i].indexOf("$rw_readNextTarget") > -1) { jHb.splice(i, 1); --i; } } } ksa(Era); } }}var Bea = null;var eba_ignore_hidden;var Cea = true;var Dea ="The SpeechStream object will contain parameter objects in the future. It holds actionOnError cacheMode and pronunciation";var Eea = function(){ this.STOP = 0; this.SKIP = 1; this.action = this.STOP;};var Fea = function(){ this.NONE = 0; this.CACHE_WITH_LIVE_SERVER = 1; this.CACHE_ONLY = 2; this.CACHE_BUILDING_MODE = 3; this.mode = this.NONE; this.getLiveServer = function() { if(this.mode == this.NONE) { return Hca; } else if(this.mode == this.CACHE_ONLY) { return null; } else if(this.mode == this.CACHE_WITH_LIVE_SERVER) { return Ica; } else if(this.mode == this.CACHE_BUILDING_MODE) { if(Ica != null) { return Ica; } else { return Hca; } } }; this.setCacheMode = function(p_nMode) { try { switch(p_nMode) { case this.NONE: this.mode = this.NONE; eba_cache_mode = false; eba_cache_building_mode = false; eba_cache_live_generation = false; eca = false; dca = false; fca = false; cka().setCacheMode(false, false); break; case this.CACHE_WITH_LIVE_SERVER: this.mode = this.CACHE_WITH_LIVE_SERVER; eba_cache_mode = true; eba_cache_building_mode = false; eba_cache_live_generation = true; eca = true; dca = false; fca = true; cka().setCacheMode(true, true); break; case this.CACHE_ONLY: this.mode = this.CACHE_ONLY; eba_cache_mode = true; eba_cache_building_mode = false; eba_cache_live_generation = false; eca = true; dca = false; fca = false; cka().setCacheMode(true, false); break; case this.CACHE_BUILDING_MODE: this.mode = this.CACHE_BUILDING_MODE; eba_cache_mode = false; eba_cache_building_mode = true; eba_cache_live_generation = false; eca = false; dca = true; fca = false; cka().setCacheMode(true, true); break; default: oJb("Tried to set to an invalid mode, "+ p_nMode +" is not recognised."); } } catch(err) { } };};var Pronunciation = function(){ this.NONE = 0; this.SERVER_PRONUNCIATION = 1; this.CLIENT_PRONUNCIATION_FOR_OFFLINE_CACHE = 2; this.CLIENT_PRONUNCIATION_FOR_LIVE_SERVER = 3; this.mode = this.CLIENT_PRONUNCIATION_FOR_OFFLINE_CACHE; this.checkPronunciation = function() { return (this.mode != this.NONE && SpeechStream.cacheMode.mode != SpeechStream.cacheMode.CACHE_ONLY && this.mode != this.SERVER_PRONUNCIATION); }; this.fetchData = function() { if(this.mode == this.NONE || SpeechStream.cacheMode.mode == SpeechStream.cacheMode.CACHE_ONLY) { return false; } if(this.mode != this.SERVER_PRONUNCIATION) { return true; } else { if( (Eca & pronCreate_icon) == pronCreate_icon || (Eca & pronEdit_icon) == pronEdit_icon ) { return true; } } return false; }; this.encodeData = function() { return (this.mode != this.NONE && this.mode != this.SERVER_PRONUNCIATION); };};var SpeechStream = new function(){ this.actionOnError = new Eea(); this.cacheMode = new Fea(); this.pronunciation = new Pronunciation();};function $rw_stopSpeech(){ $rw_event_stop();}var Iea = 200;function $rw_speakById(id){ var gOb = (new Date).getTime(); if((gOb - vda) < Iea ) { return; } tba = gOb; var target = Zea(id); if(target != null) { $rw_stopSpeech(); Bea = target; rw_speakHoverTarget(target); }}function $rw_speakByIdFromFile(id, EHb){ var gOb = (new Date).getTime(); if((gOb - vda) < Iea ) { return; } tba = gOb; var target = Zea(id); if(target != null) { $rw_stopSpeech(); Bea = target; rsa(target, EHb); }}function $rw_speakByIdHighlightOnly(id){ var gOb = (new Date).getTime(); if((gOb - vda) < Iea ) { return; } tba = gOb; var target = Zea(id); if(target != null) { $rw_stopSpeech(); Bea = target; rw_speechHighlightOnly(target); }}function $rw_speakByIdWithSpeaker(id){ var gOb = (new Date).getTime(); if((gOb - vda) < Iea ) { return; } tba = gOb; var target = Zea(id); if(target != null) { $rw_stopSpeech(); ida = id; Bea = target; rw_speakHoverTarget(target); }}function Zea(id){ var HWb = document.getElementById(id); if(HWb != null) { var Oea = HWb.innerHTML; if(Oea.length > 0) { var Wua = eva(HWb, true); if(Wua == null || Wua.nodeType != 3) { return null; } var UOb = iva(HWb, true); if(UOb == null || UOb.nodeType != 3) { return null; } var rVb = npa(Wua, 0); var sVb = (UOb.nodeType == 3)? npa(UOb, UOb.nodeValue.length) : npa(UOb, 0); var eSb = new cpa(HWb.ownerDocument.body, rVb, sVb); var target = new THHoverTarget(null, null, eSb); return target; } } return null;}function $rw_setSentenceFromSelection(){ try { var lOb = $rw_getTHCaretRangeFromSelection(); if(lOb == null) { return; } var zVb = wva(lOb.zVb); var AWb = Kwa(lOb.AWb); if(zVb != null && AWb != null) { var Xea = new qoa(zVb, AWb); var eSb = qFb(Xea); if(eSb != null) { Bea = new THHoverTarget(null, null, eSb); } } } catch(err) { pJb(err); }}function $rw_speakCurrentSentence(oYb, NWb){ var gOb = (new Date).getTime(); var bea = (gOb - vda); if(bea < Iea ) { return; } var Jfa = hea(oYb, NWb); if(Jfa != null) { if(Jfa.equals(Bea)) { if(bea < Iea * 5) { return; } } $rw_stopSpeech(); Bea = Jfa; rw_speakHoverTarget(Jfa); } vda = gOb;}function $rw_speakCurrentSentenceHighlightOnly(oYb, NWb){ var gOb = (new Date).getTime(); if((gOb - vda) < Iea ) { return; } vda = gOb; var Jfa = hea(oYb, NWb); if(Jfa != null) { $rw_stopSpeech(); Bea = Jfa; rw_speechHighlightOnly(Jfa); }}function hea(oYb, NWb){ var eSb; var Jfa; if(typeof(oYb) =="undefined"|| oYb == null) { if(Bea == null) { var lOb = fxa(document.body); if(lOb == null) { return null; } eSb = qFb(lOb); Jfa = new THHoverTarget(null, null, eSb); } else { Jfa = Bea; } } else { if(oYb instanceof qoa) { eSb = qFb(oYb); } else { var gWb; if(typeof(NWb) =="undefined") { gWb = new THCaret(oYb, 0, true); } else { gWb = new THCaret(oYb, NWb, true); } var zVb = wva(gWb); var AWb = Kwa(gWb); if(zVb == null || AWb == null) { return null; } var lOb = new qoa(zVb, AWb); if(lOb == null) { return null; } eSb = qFb(lOb); } Jfa = new THHoverTarget(null, null, eSb); } return Jfa;}function $rw_getCurrentTarget(){ return Bea;}function $rw_setCurrentTarget(YGb){ Bea = YGb;}function $rw_speakFirstSentence(){ var uVb = null; if( xba != null && xba !="") { uVb = document.getElementById(xba); } if(uVb == null) { uVb = document.body; } uVb = Jxa(uVb, false, null); $rw_speakCurrentSentence(uVb, 0);}function $rw_speakNextSentence(){ var gOb = (new Date).getTime(); if((gOb - vda) < Iea ) { return; } vda = gOb; if(Bea == null) { $rw_speakCurrentSentence(); return; } var Gfa = Bea.getCaretRange(); var nsa = zxa(Gfa); if(nsa == null) { return; } if(Bta(Gfa.zVb.node, nsa.zVb.node)) { return; } var eSb = qFb(nsa); var Jfa = new THHoverTarget(null, null, eSb); $rw_stopSpeech(); Bea = Jfa; rw_speakHoverTarget(Jfa);}function $rw_speakNextSentenceHighlightOnly(){ var gOb = (new Date).getTime(); if((gOb - vda) < Iea ) { return; } vda = gOb; if(Bea == null) { $rw_speakCurrentSentenceHighlightOnly(); return; } var Gfa = Bea.getCaretRange(); var nsa = zxa(Gfa); if(nsa == null) { return; } var eSb = qFb(nsa); var Jfa = new THHoverTarget(null, null, eSb); $rw_stopSpeech(); Bea = Jfa; rw_speechHighlightOnly(Jfa);}function $rw_speakPreviousSentence(){ var gOb = (new Date).getTime(); if((gOb - vda) < Iea ) { return; } vda = gOb; if(Bea == null) { $rw_speakCurrentSentence(); return; } var Gfa = Bea.getCaretRange(); var Hfa = Lya(Gfa); if(Hfa == null) { return; } if(Bta(Hfa.AWb.node, Gfa.AWb.node)) { return; } var eSb = qFb(Hfa); var Jfa = new THHoverTarget(null, null, eSb); $rw_stopSpeech(); Bea = Jfa; rw_speakHoverTarget(Jfa);}function $rw_speakPreviousSentenceHighlightOnly(){ var gOb = (new Date).getTime(); if((gOb - vda) < Iea ) { return; } vda = gOb; if(Bea == null) { $rw_speakCurrentSentenceHighlightOnly(); return; } var Gfa = Bea.getCaretRange(); var Hfa = Lya(Gfa); if(Hfa == null) { return; } var eSb = qFb(Hfa); var Jfa = new THHoverTarget(null, null, eSb); $rw_stopSpeech(); Bea = Jfa; rw_speechHighlightOnly(Jfa);}function $rw_getTHCaretRangeFromSelection(){ var UKb = XDb(); if(UKb != null && UKb.range instanceof cpa) { return CGb(UKb.range); } return null;}function $rw_isTextSelectedForPlay(){ if(vfa) { try { if(g_speakableTextAreaTarget != null) { if($rw_isPaused()) { return true; } if(g_nSpeakableTextAreaTimerId != 0) { return false; } return true; } else { if($rw_isPaused()) { return true; } var OGb = XDb(); if(OGb != null && OGb.range != null) { var eSb = OGb.range; if(eSb instanceof String) { return true; } else { var target = new THHoverTarget(null, null, eSb); var cYb = target.getTextPreparedForSpeech(); if(cYb != null && cYb.length > 0) { return true; } } } } } catch(err) { pJb(err); } } return false;}function $rw_getNumberOfHighlights(){ if(typeof(ZSb) !="undefined") { return ZSb.length; } else { return 0; }}function $rw_getHighlightText(index){ if(typeof(ZSb) !="undefined"&& index > -1 && index < ZSb.length) { if (hga) { return ZSb[index].text; } else { return ZSb[index].toString(); } } return"";}function $rw_getHighlightColor(index){ if(typeof(aSb) !="undefined"&& index > -1 && index < aSb.length) { if (hga) { return aSb[index]; } else { return aSb[index]; } } return"";}function $rw_getHighlightColour(index){ return $rw_getHighlightColor(index);}function $rw_isPageLoaded(){ return (baa && vfa);}var Ofa = -1;var DISABLED = 0;var CLICK_SPEAK = 1;var HOVER_SPEAK = 2;var BUBBLE_SPEAK = 4;var KEY_PRESS_SPEAK = 8;function $rw_highlightOnlyWTSFailed(){}function $rw_log(LKb){ oJb(LKb);}function $rw_setReadingAge(p_nAge){ if(typeof(p_nAge) =="string") { try { p_nAge = parseInt(p_nAge); } catch(e) { pJb(e); return; } } if(typeof(p_nAge) =="number") { switch(p_nAge) { case 1: case 2: case 3: case 4: $rw_setSpeedValue(READING_AGE_4); break; case 5: $rw_setSpeedValue(READING_AGE_5); break; case 6: $rw_setSpeedValue(READING_AGE_6); break; case 7: $rw_setSpeedValue(READING_AGE_7); break; case 8: $rw_setSpeedValue(READING_AGE_8); break; case 9: $rw_setSpeedValue(paa); break; case 10: $rw_setSpeedValue(READING_AGE_10); break; case 11: $rw_setSpeedValue(READING_AGE_11); break; case 12: $rw_setSpeedValue(READING_AGE_12); break; case 13: $rw_setSpeedValue(READING_AGE_13); break; case 14: $rw_setSpeedValue(READING_AGE_14); break; case 15: $rw_setSpeedValue(READING_AGE_15); break; case 16: $rw_setSpeedValue(READING_AGE_16); break; default: $rw_setSpeedValue(READING_AGE_10); } }}function $rw_setPlayMode(p_nMode){ if(typeof(p_nMode) =="number") { switch(p_nMode) { case DISABLED: $g_bMouseSpeech = false; dma = false; $rw_enableSpeachByBubbleMode(false); break; case CLICK_SPEAK: qba = true; $g_bMouseSpeech = true; dma = true; $rw_enableSpeachByBubbleMode(false); break; case HOVER_SPEAK: qba = false; $g_bMouseSpeech = true; dma = true; $rw_enableSpeachByBubbleMode(false); break; case BUBBLE_SPEAK: $g_bMouseSpeech = false; dma = false; $rw_enableSpeachByBubbleMode(true); break; case KEY_PRESS_SPEAK: $g_bMouseSpeech = false; dma = false; $rw_enableSpeachByBubbleMode(false); break; default: return; } Ofa = p_nMode; }}function $rw_getPlayMode(){ if(Ofa == -1) { if(Wda) { Ofa = BUBBLE_SPEAK; } else if($g_bMouseSpeech && qba) { Ofa = CLICK_SPEAK; } else if($g_bMouseSpeech && !qba) { Ofa = HOVER_SPEAK; } else { Ofa = KEY_PRESS_SPEAK; } } return Ofa;}function $rw_getVoice(){ return eba_voice;}function $rw_getSpeed(){ return eba_speed_value;}function $rw_setCustomerId(p_strVal){ try { eba_cust_id = p_strVal; Pca = p_strVal; var flash = cka(); if(flash != null) { flash.setCustomerId(p_strVal); } var cab = document.getElementById("editPageMsg"); if(cab != null) { cab.innerHTML =""; } if(Fha ) { pQb.deleteAll(); vRb(); } } catch(ignore) { pJb(ignore); }}function $rw_setBookId(p_strVal){ try { eba_book_id = p_strVal; Qca = p_strVal; var flash = cka(); if(flash != null) { flash.setBookId(p_strVal); } var cab = document.getElementById("editPageMsg"); if(cab != null) { cab.innerHTML =""; } if(Fha ) { pQb.deleteAll(); vRb(); } } catch(ignore) { pJb(ignore); }}function $rw_setPageId(p_strVal){ try { eba_page_id = p_strVal; Rca = p_strVal; var flash = cka(); if(flash != null) { flash.setPageId(p_strVal); } var cab = document.getElementById("editPageMsg"); if(cab != null) { cab.innerHTML =""; } if(Fha ) { pQb.deleteAll(); vRb(); } } catch(ignore) { pJb(ignore); }}function afa(){ kda = 0; lda = 1; if(oda) { jca = 1; $rw_setSpeedValue(SLOW_SPEED); } jda = fxa(document.body); kda = cfa(jda); lfa(true);}function cfa(dfa){ var sOb = dfa; var i = 0; while(sOb != null) { i++; sOb = zxa(sOb); } if(oda) { return i * 3; } else { return i; }}function lfa(mfa){ var XPb = Yta(jda, new Array()); eOb(XPb.voice); if(XPb.fWb != null) { jda = XPb.fWb; kda++; } var Fab = XPb.cYb; var gfa = XPb.cta; var flash = cka(); if(flash != null) { var ePb = qPb(); var rGb; if(SpeechStream.cacheMode.mode == SpeechStream.cacheMode.CACHE_ONLY || SpeechStream.pronunciation.mode == SpeechStream.pronunciation.CLIENT_PRONUNCIATION_FOR_LIVE_SERVER) { rGb = OPb(Fab); } else { rGb = OPb(gfa); } if(gca) { var kPb = rPb(rGb); ePb = ePb +"/"+ kPb; } if(mfa) { var uGb = KLb(true) + SpeechStream.cacheMode.getLiveServer() +"/"; flash.autogenSpeechFiles(Fab, ePb, rGb, !Eha, uGb); } else { var IWb = ePb +"/"+ rGb; flash.checkAutogenCachedFiles(IWb); } }}function $rw_autogenSpeechFilesCallback(tfa){ if(tfa =='Success') { var ufa = false; if(oda ) { if(jca == 1 || jca == 2) { jca++; } else { jca = 1; ufa = true; } switch(jca) { case 1: $rw_setSpeedValue(SLOW_SPEED); break; case 2: $rw_setSpeedValue(MEDIUM_SPEED); break; case 3: $rw_setSpeedValue(FAST_SPEED); break; } } else { ufa = true; } if(ufa) { jda = zxa(jda, null); if(jda != null) { lda++; if(kda >= lda) { $rwj('#pb1').progressBar((lda / kda) * 100); lfa(true); } else { $rwj.unblockUI(); alert("Error: More sentences to be cached than counted in initial count at the start of this process!"); } } else { $rwj.unblockUI(); var uGb = KLb(true) + SpeechStream.cacheMode.getLiveServer() +"/"; var flash = cka(); flash.autoGenComplete(uGb); if(rda == null) { alert("Page Cached Successfully!"); } } } else { lda++; lfa(true); } } else { $rwj.unblockUI(); alert(tfa); }}function sfa(){ kda = 0; lda = 1; mda = 0; nda = 0; if(oda) { jca = 1; $rw_setSpeedValue(SLOW_SPEED); } jda = fxa(document.body); kda = cfa(jda); lfa(false);}function $rw_checkAutogenCachedFilesCallback(tfa){ if(tfa =='Success') { ++mda; } else { ++nda; } var ufa = false; if(oda) { if(jca == 1 || jca == 2) { jca++; } else { jca = 1; ufa = true; } switch(jca) { case 1: $rw_setSpeedValue(SLOW_SPEED); break; case 2: $rw_setSpeedValue(MEDIUM_SPEED); break; case 3: $rw_setSpeedValue(FAST_SPEED); break; } } else { ufa = true; } if(ufa) { jda = zxa(jda, null); if(jda != null) { lda++; if(kda >= lda) { $rwj('#pb1').progressBar((lda / kda) * 100); lfa(false); } else { $rwj.unblockUI(); alert("Error: More sentences to be cached than counted in initial count at the start of this process!"); } } else { $rwj.unblockUI(); if(nda > 0) { alert("Missing files!  Checked page and found that "+ nda +" sentences out of "+ lda +" where not cached."); } if(rda != null) { eval(rda); } else { if(nda == 0) { alert("Checked page and found that all "+ lda +" sentences were cached."); } } } } else { lda++; lfa(false); }}function $rw_autogenCompleteCallback(tfa){ if(tfa !="Success") { alert("Finished autogeneration process.  "+ tfa); } if(rda != null) { eval(rda); }}function $rw_setTranslateSource(p_strSource){ oWb.setSource(p_strSource);}function $rw_setTranslateTarget(p_strTarget){ oWb.setTarget(p_strTarget);}function $rw_getVersion(){ return eba_actual_version;}function $rw_getRevision(){ return Bca;}iba = true;iba = true;/*Code designed and developed by Stuart McWilliams.*/var vfa = false;var g_icons = new Array();var wfa = new Array();var xfa = 0;var yfa = 0;var zfa = 300;var Aga = { x:0,y:0 };var Bga = { x:0,y:0 };var Cga = null;var Dga = false;var Ega = 5;var Fga = false;var Gga = 0;var Hga ="";var Iga = 1.0;var Jga = 0.01;var Kga = true;var Lga;if(Oca == title_th){ Lga = 8;}else{ Lga = 4;}var Mga = 60;var Nga = [0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00];var Oga = [0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00];var Pga = [300, 300, 300, 300, 600, 250, 220, 660, 240, 300, 300, 100];var Qga = [40, 40, 40, 40, 40, 250, 40, 60, 256, 30, 30, 30];var Rga = [false, false, false, false, false, false, false, false, false, false, false, false];var $g_bMouseSpeech = false;var Sga = 0;var Tga = 1;var Uga = 2;var Vga = 3;var Wga = 4;var Xga = 5;var Yga = 6;var Zga = 7;var aga = 8;var bga = 9;var cga = 10;var dga = 11;var ega ="";var fga = false;var gga = false;var hga = navigator.appName =="\x4dicros\x6fft\x20\x49nt\x65rnet\x20Exp\x6corer";var iga = navigator.appVersion.indexOf("MSIE 6.") > -1;var jga = navigator.appVersion.indexOf("MSIE 7.") > -1;var kga = navigator.appVersion.indexOf("MSIE 8.") > -1;var lga = navigator.appVersion.indexOf("MSIE 9.") > -1;var mga = false;if(hga){ if(jga) { kga = true; } if (document.documentMode && !jga) { kga = true; fga = true; } else { if (document.compatMode) { if (document.compatMode =="CSS1Compat") { mga = true; } else { if(jga || kga) { fga = true; } } } }}; if(!Array.indexOf) { Array.prototype.indexOf = function(kRb) { for(var i=0; i<this.length; i++) { if(this[i]==kRb) { return i; } } return -1; }; };var nga = navigator.appVersion.indexOf("\x43hrome") > -1;var oga = navigator.appVersion.indexOf("\x53a\x66ari") > -1;var pga = !(hga || oga); var qga ="\x6coc\x61\x6ch\x6fst";var $g_strFileLoc =""; var rga ="";var g_speakableTextAreaTarget = null;var g_nSpeakableTextAreaTimerId = 0;var uga = 1;var vga = 0;var wga = false;var xga = false;var yga = null;var zga = 1;var Aha = 2;var Bha = 3;var Cha = 1;var Dha = false;var Eha = false;var Fha = false;function Gha(sPb, pha, Pia){ if(typeof(Pia) =="\x75n\x64efined") { Pia ="\x6apg"; } g_icons[xfa] = new Array(6); g_icons[xfa][0] = sPb; g_icons[xfa][1] = new Image(); g_icons[xfa][1].name = sPb; g_icons[xfa][1].id = sPb; g_icons[xfa][1].src = $g_strFileLoc +'rwimgs/'+ sPb +'-flat.'+ Pia; g_icons[xfa][2] = new Image(); g_icons[xfa][2].name = sPb; g_icons[xfa][2].id = sPb; g_icons[xfa][2].src = $g_strFileLoc +'rwimgs/'+ sPb +'-hover.'+ Pia; g_icons[xfa][3] = new Image(); g_icons[xfa][3].name = sPb; g_icons[xfa][3].id = sPb; g_icons[xfa][3].src = $g_strFileLoc +'rwimgs/'+ sPb +'-toggle.'+ Pia; g_icons[xfa][4] = pha; g_icons[xfa][5] = new Image(); g_icons[xfa][5].name = sPb; g_icons[xfa][5].id = sPb; g_icons[xfa][5].src = $g_strFileLoc +'rwimgs/'+ sPb +'-grey.'+ Pia; xfa++;}var Kha = 1;var Lha = 2;var Mha = 3;var Nha = 4;var Oha = 1;var Pha = 2;var Qha = 3;var Rha = 5;var Sha = 6;var Tha = 7;function Uha(name, alt, Pia){ if(typeof(Pia) =="\x75ndefin\x65d") { Pia ="\x6ap\x67"; } var Kab = yfa; wfa[yfa] = new Array(9); wfa[yfa][0] = name; wfa[yfa][1] = new Image(); wfa[yfa][1].name = name; wfa[yfa][1].id = name; wfa[yfa][1].src = $g_strFileLoc +'rwimgs/'+ name +'off-flat.'+ Pia; wfa[yfa][2] = new Image(); wfa[yfa][2].name = name; wfa[yfa][2].id = name; wfa[yfa][2].src = $g_strFileLoc +'rwimgs/'+ name +'off-hover.'+ Pia; wfa[yfa][3] = new Image(); wfa[yfa][3].name = name; wfa[yfa][3].id = name; wfa[yfa][3].src = $g_strFileLoc +'rwimgs/'+ name +'off-toggle.'+ Pia; wfa[yfa][4] = alt; wfa[yfa][5] = new Image(); wfa[yfa][5].name = name; wfa[yfa][5].id = name; wfa[yfa][5].src = $g_strFileLoc +'rwimgs/'+ name +'off-grey.'+ Pia; wfa[yfa][6] = new Image(); wfa[yfa][6].name = name; wfa[yfa][6].id = name; wfa[yfa][6].src = $g_strFileLoc +'rwimgs/'+ name +'on-toggle.'+ Pia; wfa[yfa][7] = new Image(); wfa[yfa][7].name = name; wfa[yfa][7].id = name; wfa[yfa][7].src = $g_strFileLoc +'rwimgs/'+ name +'on-grey.'+ Pia; wfa[yfa][8] = false; yfa++; return Kab;}function bha(sPb){ var i=0; for(i=0; i<wfa.length; i++) { if(wfa[i][0] == sPb) { return i; } } for(i=0; i<g_icons.length; i++) { if(g_icons[i][0] == sPb) { return i; } } return -1;}function dha(i){ var sha = g_icons[i][1].src; var pYb = g_icons[i][0]; var Tra = g_icons[i][4]; if(oga) { var Cia; if(pYb.equalsTH("s\x75bmit")) { Cia = 53; } else { Cia = 33; } Lga += Cia; var bja = {}; bja["ignore"] ="1"; bja["name"] = pYb; bja["width"] =""+ Cia; bja["height"] ="32"; bja["alt"] = Tra; bja["title"] = Tra; bja["src"] = sha; var yha = uBb("img", bja, null,"rwIcon"); Fma(yha,"click", function() { if($rw_blockClick(pYb)) { return true; } else { var xTb ='$rw_event_'+ pYb +'(null);'; eval(xTb); } }); Fma(yha,"mouseover", function() { Doa(pYb); }); Fma(yha,"mouseout", function() { Foa(pYb); }); Fma(yha,"mousedown", function() { Hoa(pYb); }); Fma(yha,"mouseup", function() { Doa(pYb); }); return yha; } else { var Cia = 33; if(pYb.equalsTH("s\x75bmit")) { Cia = 53; } Lga += Cia; var Aia = oBb("span", ["ignore","1"]); Fma(Aia,"mouseover", function() { Doa(pYb); }); Fma(Aia,"mouseout", function() { Foa(pYb); }); Fma(Aia,"mousedown", function() { Hoa(pYb); Hga= pYb ; }); Fma(Aia,"mouseup", function() { Doa(pYb); if(Hga.equalsTH(pYb)) { if($rw_blockClick(pYb)) {return true;} else { var xTb ='$rw_event_'+ pYb +'(null);'; eval(xTb); } } }); Aia.appendChild(lha(g_icons[i][1].src, pYb,"\x66l\x61t", Tra, Cia, true)); Aia.appendChild(lha(g_icons[i][2].src, pYb,"\x68over", Tra, 0, false)); Aia.appendChild(lha(g_icons[i][3].src, pYb,"t\x6f\x67\x67le", Tra, 0, false)); Aia.appendChild(lha(g_icons[i][5].src, pYb,"\x6dask", Tra, 0, false)); return Aia; }}function lha(mha, sPb, Pia, pha, qha, Hna){ var bja = {}; bja["ignore"] ="1"; bja["name"] = sPb + Pia; bja["src"] = mha; bja["width"] =""+ qha; bja["height"] ="32"; bja["alt"] = pha; bja["title"] = pha; if(Hna) { bja["style"] ="width:"+ qha +"px; visibility:visible; display:inline"; } else { bja["style"] ="width:"+ qha +"px; visibility:hidden; display:none"; } return uBb("img", bja, (sPb + Pia),"rwIcon");}function wha(i){ var sha = wfa[i][1].src; var pYb = wfa[i][0]; var Tra = wfa[i][4]; var vha = false; if(pYb=="\x68o\x76\x65r"&& typeof(eba_initial_speech_on) =="boolean"&& eba_initial_speech_on) { sha = wfa[i][Sha].src; wfa[i][8] = true; vha = true; } if(oga) { Lga += 33; var bja = {}; bja["name"] = pYb; bja["src"] = sha; bja["width"] ="33"; bja["height"] ="32"; bja["style"] ="visibility:visible; display:inline"; bja["alt"] = Tra; bja["title"] = Tra; bja["ignore"] ="1"; var yha = uBb("img", bja, null,"rwIcon"); Fma(yha,"mouseover", function() { if(!wfa[i][8]) { Doa(pYb); } }); Fma(yha,"mouseout", function() { if(!wfa[i][8]) { Foa(pYb); } }); Fma(yha,"mousedown", function() { if(!wfa[i][8]) { Hoa(pYb); } Hga= pYb ; }); Fma(yha,"mouseup", function() { if(Hga.equalsTH(pYb)) { if(dma && fma.indexOf(pYb)> -1) { return true; } else { var xTb ='$rw_event_'+ pYb +'(null, '+ i +');'; eval(xTb); } } if(!wfa[i][8]) { Doa(pYb); } }); return yha; } else { var Aia = oBb("span", ["ignore","1"], null,null); Fma(Aia,"mouseover", function() { if(!wfa[i][8]) { Doa(pYb); } }); Fma(Aia,"mouseout", function() { if(!wfa[i][8]) { Foa(pYb); } }); Fma(Aia,"mousedown", function() { if(!wfa[i][8]) { Hoa(pYb); } Hga= pYb ; }); Fma(Aia,"mouseup", function() { if(Hga.equalsTH(pYb)) { if(dma && fma.indexOf(pYb)> -1) {return true;} else { var xTb ='$rw_event_'+ pYb +'(null, '+ i +');'; eval(xTb); } } if(!wfa[i][8]) { Doa(pYb); } }); var Cia = 33; Lga += 33; Aia.appendChild(lha(wfa[i][1].src, pYb,"\x66\x6cat", Tra, (!vha?Cia:0), !vha)); Aia.appendChild(lha(wfa[i][2].src, pYb,"\x68over", Tra, 0, false)); Aia.appendChild(lha(wfa[i][3].src, pYb,"t\x6f\x67gle", Tra, 0, false)); Aia.appendChild(lha(wfa[i][5].src, pYb,"\x6dask", Tra, 0, false)); Aia.appendChild(lha(wfa[i][6].src, pYb,"t\x6fgg\x6c\x65On", Tra, (vha?Cia:0), vha)); Aia.appendChild(lha(wfa[i][7].src, pYb,"\x6daskOn", Tra, 0, false)); return Aia; } return strHtml;}function Eia(){ Lga += 100; var bja = {}; bja["ignore"] ="1"; if(hga) { bja["style"] ="width:95px;position:relative;top:-10px;border: 1px solid;color:#000000;backgroundColor:#f1efe5"; } else { bja["style"] ="width:95px;position:relative;top:-10px;border: 1px solid;color:#000000;background-color:#f1efe5"; } var Fia = uBb("select", bja, null, null); Fma(Fia,"change", function() { $rw_setSpeedValue(parseInt(Fia.value)); }); var Gia; bja = {}; bja["ignore"] ="1"; bja["value"] =""+ SLOW_SPEED; if(Zca == -3 || Zca == SLOW_SPEED) { bja["selected"] ="1"; } Gia = uBb("option", bja, null, null); Gia.innerHTML ="Slow"; var Hia; bja = {}; bja["ignore"] ="1"; bja["value"] =""+ MEDIUM_SPEED; if(Zca == -2 || Zca == MEDIUM_SPEED) { bja["selected"] ="1"; } Hia = uBb("option", bja, null, null); Hia.innerHTML ="Medium"; var Iia; bja = {}; bja["ignore"] ="1"; bja["value"] =""+ FAST_SPEED; if(Zca == -1 || Zca == FAST_SPEED) { bja["selected"] ="1"; } Iia = uBb("option", bja, null, null); Iia.innerHTML ="Fast"; Fia.appendChild(Gia); Fia.appendChild(Hia); Fia.appendChild(Iia); return Fia;}function Kia(sPb, Pia){ if(Pia != null) { var Toa = document.images[sPb + Pia].style; Toa.visibility ="\x76isi\x62le"; Toa.display ="\x69nl\x69n\x65"; Toa.width ="\x326px"; } if(Pia !="\x6ff\x66") { document.images[sPb +"off"].style.visibility ="\x68i\x64den"; document.images[sPb +"off"].style.display ="n\x6fn\x65"; document.images[sPb +"off"].style.width ="\x30px"; } if(Pia !="\x6fn") { document.images[sPb +"on"].style.visibility ="\x68idden"; document.images[sPb +"on"].style.display ="n\x6fne"; document.images[sPb +"on"].style.width ="\x30\x70x"; }}function Nia(sPb, Pia, Qia){ if(Pia != null) { if(Pia =="t\x6fg\x67le") { Gga = 2; } var Toa = document.images[sPb + Pia].style; Toa.visibility ="\x76\x69si\x62le"; Toa.display ="\x69n\x6cine"; if(sPb =="s\x75bmit") { Toa.width ="\x353px"; } else { Toa.width ="\x333px"; } } if(Pia !="\x66lat") { document.images[sPb +"flat"].style.visibility ="\x68idden"; document.images[sPb +"flat"].style.display ="n\x6fn\x65"; document.images[sPb +"flat"].style.width ="\x30px"; } if(Pia !="hover") { document.images[sPb +"hover"].style.visibility ="\x68i\x64\x64\x65n"; document.images[sPb +"hover"].style.display ="n\x6fne"; document.images[sPb +"hover"].style.width ="\x30px"; } if(Pia !="toggle") { document.images[sPb +"toggle"].style.visibility ="\x68\x69dden"; document.images[sPb +"toggle"].style.display ="n\x6fne"; document.images[sPb +"toggle"].style.width ="\x30\x70x"; } if(Pia !="mask") { document.images[sPb +"mask"].style.visibility ="\x68idden"; document.images[sPb +"mask"].style.display ="n\x6fne"; document.images[sPb +"mask"].style.width ="\x30px"; } if(Qia) { if(Pia !="toggleOn") { document.images[sPb +"toggleOn"].style.visibility ="\x68idden"; document.images[sPb +"toggleOn"].style.display ="n\x6fne"; document.images[sPb +"toggleOn"].style.width ="\x30px"; } if(Pia !="mask") { document.images[sPb +"maskOn"].style.visibility ="\x68idden"; document.images[sPb +"maskOn"].style.display ="n\x6fne"; document.images[sPb +"maskOn"].style.width ="\x30px"; } }}var Sia;function $rw_barInit(){ var xja = false; if(typeof(BYPASS_BROWSER_CHECK) !="\x75ndefin\x65d"&& BYPASS_BROWSER_CHECK =="\x79") { xja = true; } if(typeof(eba_bypass_dom_check) =="boolean"&& eba_bypass_dom_check) { xja = true; Eda = true; } if(!xja) { xja = zja(); } if(!xja) { return; } Jka(); if(typeof(pktTitleId) !="\x75ndef\x69ned") { Oka(); } if(typeof(eba_annotate_storage_url) =="string"|| typeof(eba_annotate_highlight_editor_id) =="string"|| typeof(eba_annotate_note_editor_id) =="string") { Nka(); } if(Vca == SPANISH) { Nca ="\x53c\x61nSoft\x20Paulin\x61_Full_\x322k\x48z"; } if(typeof(dtdType) !="undefined") { ega = dtdType; if(dtdType =="xtran") { fga = true; } else if(dtdType =="loose") { gga = true; } } var Uia; try { Uia = window.location.search; } catch(err) { var ARb = err.message; Uia =""; } if(typeof(eba_autocache_generate) =="boolean"&& eba_autocache_generate) { pda = true; Fca = Fca | generatecache_icon; Fca = Fca | checkcache_icon; } else { var jXb; var kXb; var Yia; jXb = Uia.indexOf("speechstreamautocache="); while(jXb > 0) { Yia = Uia.charAt(jXb - 1); if(Yia =="?"|| Yia =="&") { kXb = Uia.indexOf("&", jXb + 22); var cia; if(kXb == -1) { cia = Uia.substr(jXb + 22); } else { cia = Uia.substring(jXb + 22, kXb); } cia = cia.toLowerCase(); if(cia =="true") { pda = true; Fca = Fca | generatecache_icon; Fca = Fca | checkcache_icon; } jXb = -1; } else { jXb = Uia.indexOf("speechstreamautocache=", jXb + 1); } } } if(typeof(eba_autocache_check) =="boolean"&& eba_autocache_check) { qda = true; Fca = Fca | generatecache_icon; Fca = Fca | checkcache_icon; } else { jXb = Uia.indexOf("speechstreamautocachecheck="); while(jXb > 0) { Yia = Uia.charAt(jXb - 1); if(Yia =="?"|| Yia =="&") { kXb = Uia.indexOf("&", jXb + 27); var cia; if(kXb == -1) { cia = Uia.substr(jXb + 27); } else { cia = Uia.substring(jXb + 27, kXb); } cia = cia.toLowerCase(); if(cia =="true") { qda = true; Fca = Fca | generatecache_icon; Fca = Fca | checkcache_icon; } jXb = -1; } else { jXb = Uia.indexOf("speechstreamautocachecheck=", jXb + 1); } } } jXb = Uia.indexOf("speechstreamautocachecallback="); while(jXb > 0) { Yia = Uia.charAt(jXb - 1); if(Yia =="?"|| Yia =="&") { kXb = Uia.indexOf("&", jXb + 30); if(kXb == -1) { var cia = Uia.substr(jXb + 30); cia = decodeURIComponent(cia); rda = cia; } else { var cia = Uia.substring(jXb + 30, kXb); cia = decodeURIComponent(cia); rda = cia; } jXb = -1; } else { jXb = Uia.indexOf("speechstreamautocachecallback=", jXb + 1); } } Sca = parseInt(Pca); if(Sca >= 200 && Sca < 300) { Qda = true; if(Tca == null) { Tca ="s\x63holast\x69c"; Uca ="s\x63ho\x6castic"; } Qca ="none"; var dia = document.getElementsByTagName("meta"); var tZb = dia.length; var i; for(i=0; i<tZb; i++ ) { var fia = dia[i]; if(fia.name != null) { if(fia.name.toLowerCase() =="assetid"&& fia.content != null && fia.content.length > 0) { Rca = fia.content; } else if(fia.name.toLowerCase() =="pcode"&& fia.content != null && fia.content.length > 0) { Qca = fia.content; } } } jXb = Uia.indexOf("id="); while(jXb > 0) { Yia = Uia.charAt(jXb - 1); if(Yia =="?"|| Yia =="&") { kXb = Uia.indexOf("&", jXb + 3); if(kXb == -1) { Rca = Uia.substr(jXb + 3); } else { Rca = Uia.substring(jXb + 3, kXb); } jXb = -1; } else { jXb = Uia.indexOf("id=", jXb + 1); } } jXb = Uia.indexOf("product_id="); while(jXb > 0) { Yia = Uia.charAt(jXb - 1); if(Yia =="?"|| Yia =="&") { kXb = Uia.indexOf("&", jXb + 11); if(kXb == -1) { Qca = Uia.substr(jXb + 11); } else { Qca = Uia.substring(jXb + 11, kXb); } jXb = -1; } else { jXb = Uia.indexOf("product_id=", jXb + 1); } } } if(Sca == 300) { Qca ="index"; Rca ="1"; var gia = document.location; if(gia != null) { var vZb = gia.pathname; if(vZb.length > 0) { var iia = vZb.lastIndexOf("/"); if(iia > -1) { vZb = vZb.substr(iia + 1); var jia = vZb.indexOf(".html"); if(jia > -1) { vZb = vZb.substring(0, jia); Qca = vZb; } } } } } if(Sca >= 500 && Sca < 600) { Rda = true; } if(Sca >= 810 && Sca <820) { Fda = true; } if(Sca >= 1220 && Sca <1229) { Ida = true; } var kia = KLb(false) + Gca +"/"; var lia = KLb(true) + Hca +"/"; var mia; if(Ica != null) { mia = KLb(true) + Ica +"/"; } else { mia = null; } if(hga && !Eda) { var rra = Xka(); if(!rra) { Sda = true; if(dca) { } else { ILb("The embedded speech toolbar cannot be added due to invalid html tag markup in this page .\n"+"Try using FireFox or Safari to view this page or contact the page author to notify them of this error."); return; } } } var oia; if(Lca == null) { Lca =""; } while(Lca.length > 0 && Lca.charAt(0) =='/') { Lca = Lca.substr(1); } while(Lca.length > 0 && Lca.charAt(Lca.length - 1) =='/') { Lca = Lca.substr(0, Lca.length - 1); } if(Lca =="") { Lca ="latest"; } if(Cca.length > 0) { if(Cca =="latest") { oia = Lca +"/"+ Cca; } else { oia = Lca +"/v"+ Cca; } } else { oia = Lca; } if(oia.length > 0) { $g_strFileLoc = kia + oia +"/"; } else { $g_strFileLoc = kia; } rga = Mca; try { var pia = new String(document.location); if(pia.substring(0,4) =="file") { $g_strFileLoc =""; rga =""; } } catch(ignore) { pJb(ignore); } if(Eca == 0) { Kga = false; } if(Kga && !Qda) { Gja(); } var qia; var Rja = Sja(); if(Lga > 0) { if(zba) { qia = oBb("div", ["rwTHComp","1","style","position:relative;visibility:hidden;display:none"],"rwDrag"); } else { qia = oBb("div", ["rwTHComp","1","style","visibility:hidden;display:none"],"rwDrag"); } var Hja = Jja(); if(!uba) { Hja.appendChild(Oja()); } Hja.appendChild(Rja); qia.appendChild(Hja); } else { qia = oBb("div", ["rwTHComp","1","visibility","hidden"],"rwDrag"); var Hja = oBb("div", ["rwTHComp","1","visibility","hidden"],"rwDrag"); qia.appendChild(Hja); } Sia = document.getElementById("speechStreamPlaceholder"); if((zba || hga) && Sia == null) { document.write("<span id=\"speechStreamPlaceholder\"></span>"); Sia = document.getElementById("speechStreamPlaceholder"); } else { if(Sia == null) { Sia = document.body; } } Sia.appendChild(qia); if(hga) { fja(kia, lia, mia); } else { Vja(kia, lia, mia); } Fma(window,'scroll', Jma); Fma(window,'resize', Jma); Fma(window,'scroll', Nma); Fma(window,'resize', Nma); Fma(window,'load', Loa); Fma(window,'beforeunload', foa); Fma(document,'click', dna); Fma(document,'mouseout', Boa); Fma(document,'mouseup', zna); Fma(document,'mousemove', sna); Fma(document,'mouseover', gna); Fma(document,'mousedown', Zna); Fma(document,'dragstart', ana); Fma(document,'keyup', Yna); if((Eca & calculator_icon) == calculator_icon) { $rw_barCalInit(); } if((Eca & generatecache_icon) == generatecache_icon) { $rw_barCacheInit(); } if((Eca & dictionary_icon) == dictionary_icon || (Eca & factfinder_icon) == factfinder_icon || (Eca & translation_icon) == translation_icon) { if(hga) { document.writeln("<script type=\"text/javascript\" src=\""+ $g_strFileLoc +"texthelpSearch.js\" ></script>"); } else { var uia = oBb("script", ["type","text/javascript","src", $g_strFileLoc +"texthelpSearch.js"]); Sia.appendChild(uia); } } if((Eca & highlightcyan_icon) == highlightcyan_icon || (Eca & highlightgreen_icon) == highlightgreen_icon || (Eca & highlightmagenta_icon) == highlightmagenta_icon || (Eca & highlightyellow_icon) == highlightyellow_icon || (Eca & collect_icon) == collect_icon || sca) { if(hga) { document.writeln("<script type=\"text/javascript\" src=\""+ $g_strFileLoc +"texthelpSS.js\" ></script>"); } else { var via = oBb("script", ["type","text/javascript","src", $g_strFileLoc +"texthelpSS.js"]); Sia.appendChild(via); } } if((Eca & sticky_icon) == sticky_icon || sca) { if(hga) { document.writeln("<script type=\"text/javascript\" src=\""+ $g_strFileLoc +"texthelpSticky.js\" ></script>"); } else { var wia = oBb("script", ["type","text/javascript","src", $g_strFileLoc +"texthelpSticky.js"]); Sia.appendChild(wia); } } if((Eca & pronCreate_icon) == pronCreate_icon || (Eca & pronEdit_icon) == pronEdit_icon) { if(hga) { document.writeln("<script type=\"text/javascript\" src=\""+ $g_strFileLoc +"texthelpPron.js\" ></script>"); } else { var xia = oBb("script", ["type","text/javascript","src", $g_strFileLoc +"texthelpPron.js"]); Sia.appendChild(xia); } } if((Eca & generatecache_icon) == generatecache_icon || (Eca & checkcache_icon) == checkcache_icon) { if(hga) { document.writeln("<script type=\"text/javascript\" src=\""+ $g_strFileLoc +"jquery.js\" ></script>"); document.writeln("<script type=\"text/javascript\" src=\""+ $g_strFileLoc +"jquery.progressbar.min.js\" ></script>"); document.writeln("<script type=\"text/javascript\" src=\""+ $g_strFileLoc +"jquery.blockUI.js\" ></script>"); } else { var yia = oBb("script", ["type","text/javascript","src", $g_strFileLoc +"jquery.js"]); Sia.appendChild(yia); yia = oBb("script", ["type","text/javascript","src", $g_strFileLoc +"jquery.progressbar.min.js"]); Sia.appendChild(yia); yia = oBb("script", ["type","text/javascript","src", $g_strFileLoc +"jquery.blockUI.js"]); Sia.appendChild(yia); } } if(!hga) { var zia = document.getElementsByTagName('input'); for (var i = 0; i < zia.length; i++) { var Aja = zia.item(i); var yMb = Aja.getAttribute("t\x79pe"); if(yMb != null && yMb =="t\x65xt") { Fma(Aja,"\x6douseup", Ema); } } } if(Wda) { if(!Eda) { var boa = document.createElement("\x64iv"); boa.id = kja; boa.style.zIndex ="998"; boa.style.position ="\x61\x62so\x6cut\x65"; boa.style.display ="n\x6fne"; if(hga) { boa.style.cursor ="hand"; } else { boa.style.cursor ="pointer"; } Fma(boa,'click', sja); var coa = document.createElement("img"); coa.setAttribute("src", $g_strFileLoc +"rwimgs/start_speak_popup.gif"); boa.appendChild(coa); Sia.appendChild(boa); var doa = document.createElement("\x64iv"); doa.id = lja; doa.style.zIndex ="999"; doa.style.position ="\x61\x62solute"; doa.style.display ="n\x6fne"; if(hga) { doa.style.cursor ="hand"; } else { doa.style.cursor ="pointer"; } Fma(doa,'click', tja); var eoa = document.createElement("img"); eoa.setAttribute("src", $g_strFileLoc +"rwimgs/stop_speak_popup.gif"); doa.appendChild(eoa); Sia.appendChild(doa); } } if(typeof(eba_initial_speech_on) =="boolean") { if(eba_initial_speech_on) { $g_bMouseSpeech = true; jma(true); } }}function Gja(){ if(Rda) { eCb(document.body,"<link href=\""+ $g_strFileLoc +"rwMain500Bar.css\" type=\"text/css\" rel=\"stylesheet\" />", false); } else { if(Oca == title_rw) { eCb(document.body,"<link href=\""+ $g_strFileLoc +"rwMainRWBar.css\" type=\"text/css\" rel=\"stylesheet\" />", false); } if(Oca == title_ba) { eCb(document.body,"<link href=\""+ $g_strFileLoc +"rwMainBABar.css\" type=\"text/css\" rel=\"stylesheet\" />", false); } if(Oca == title_ebooks) { eCb(document.body,"<link href=\""+ $g_strFileLoc +"rwMainEbooksBar.css\" type=\"text/css\" rel=\"stylesheet\" />", false); } if(Oca == title_th) { eCb(document.body,"<link href=\""+ $g_strFileLoc +"rwMainTHBar.css\" type=\"text/css\" rel=\"stylesheet\" />", false); } if(Oca == title_portal) { eCb(document.body,"<link href=\""+ $g_strFileLoc +"rwMainPortalBar.css\" type=\"text/css\" rel=\"stylesheet\" />", false); } }}function Jja(){ var Hja; var ECb ="width:"+ Lga +"px;"+"visibility:hidden;"; if(bca || uba) { ECb +="display:none;"; } var bja = {}; bja["style"] = ECb; if(!uba) { Hja = uBb("div", bja,"rwMainOutline","rwToolbarOutline"); } else { Hja = uBb("div", bja,"rwMainOutline", null); } return Hja;}function Oja(){ var Lja; if(Oca == title_th) { var kqa; var RHb; if(eba_logo_url == null) { if(Rda || rca) { kqa =""; RHb = null; } else { kqa ="Click here to go to www.texthelp.com"; RHb ="www.texthelp.com"; } } else if(eba_logo_url =="none") { kqa =""; RHb = null; } else { kqa ="Click here to go to "+ eba_logo_url; RHb = eba_logo_url; if(RHb.substr(0, 7) =="http://") { RHb = RHb.substr(7); } else if (RHb.substr(0, 8) =="https://") { RHb = RHb.substr(8); } } Lja = oBb("div", null,"rwDragMe","rwToolbarCaption"); var Pja; if(RHb == null) { bja = {}; bja["border"] ="0"; bja["ignore"] ="1"; bja["align"] ="right"; if(Rda) { bja["src"] = $g_strFileLoc +"rwimgs500/logo500.gif"; bja["style"] ="margin: 5px; cursor:default;"; } else { bja["src"] = $g_strFileLoc +"rwimgs/logo.gif"; bja["style"] ="cursor:default"; } bja["title"] =""; bja["alt"] =""; Pja = uBb("img", bja); Lja.appendChild(Pja); } else { bja = {}; bja["border"] ="0"; bja["ignore"] ="1"; bja["align"] ="right"; if(Rda) { bja["src"] = $g_strFileLoc +"rwimgs500/logo500.gif"; bja["style"] ="margin: 5px;"; } else { bja["src"] = $g_strFileLoc +"rwimgs/logo.gif"; } bja["title"] = kqa; bja["alt"] = kqa; Pja = uBb("img", bja); var Qja; bja = {}; bja["href"] = KLb(false) + RHb; bja["target"] ="new"; if(!oga) { bja["style"] ="cursor:hand"; } Qja = uBb("a", bja); Qja.appendChild(Pja); Lja.appendChild(Qja); } } else { Lja = oBb("div", null,"rwDragMe","rwToolbarCaption"); } return Lja;}function Sja(){ var Rja = oBb("div", null, null,"rwToolbarBar"); $rw_setIconsToLoad(Eca); var Tja = false; for (var i = 0; i < yfa; i++) { Tja = true; Rja.appendChild(wha(i)); } for (var i = 0; i < xfa; i++) { Tja = true; Rja.appendChild(dha(i)); } if((Eca & selectSpeed_icon) == selectSpeed_icon) { Tja = true; Rja.appendChild(Eia()); } if(Tja && Lga< 110) { Lga = 110; } else if(!Tja) { Lga = 0; } return Rja;}function Vja(gja, hja, ija){ var eja; if(Tca != null && Uca != null) { eja ='&userName='+ Tca +'&userPassword='+ Uca; } else { eja =""; } if(rca) { eja +="&customerName=pkt"; } var jja ='lessonServerLoc='+ gja +'&speechServerLoc='+ hja +'&speedValue='+ Zca + eja; if(Jca != null) { jja +='&translateServerLoc='+ Jca; } if(Kca != null) { jja +='&dictionaryServerLoc='+ Kca; } if(dca || eca ) { jja +='&cacheMode=true'; if(ija != null) { jja +='&cacheLiveFallover=true'; } } if(ija != null) { jja +='&speechServerBackupLoc='+ ija; } if(Pca != null && Qca != null && Rca != null) { jja +='&custID='+ Pca; jja +='&bookID='+ Qca; jja +='&pageID='+ Rca; } if(mca > -1) { jja +='&cacheCount='+ mca; } if(nca > -1) { jja +='&cacheTimeDelay='+ nca; } jja +='&locale='+ Yca; jja +='&speechName='+ Nca; if(Cda != null && Dda != null) { jja +='&searchString='+ Cda; jja +='&replaceString='+ Dda; } if(rga == null || rga =="") { rga = KLb(false) + Gca +"/"; } else if(rga.charAt(0) =='.') { if(rga.charAt(rga.length -1) !='/') { rga = Gca +"/"; } } else { if(rga.charAt(0) !='/') { rga ="/"+ Gca; } if(rga.charAt(rga.length -1) !='/') { rga = Gca +"/"; } rga = KLb(false) + Gca + rga; } if(Zda) { jja +='&SSLSpeech=true'; jja +='&SSLToolbar=true'; } else { if(ada) { jja +='&SSLSpeech=true'; } if(bda) { jja +='&SSLToolbar=true'; } } Eca = Eca | Fca; if( (Eca & pronCreate_icon) == pronCreate_icon || (Eca & pronEdit_icon) == pronEdit_icon || oca) { jja +='&cacheBuster=true'; } if(hga && (Zda||ada)) { jja +='&IESSL=true'; } var aja = rga +'WebToSpeech'+ Dca +'.swf'; var bja = {}; bja["classid"] ="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"; bja["width"] ="1"; bja["height"] ="1"; bja["id"] ="WebToSpeech"; var cja = uBb("object", bja); bja = {}; bja["name"] ="allowScriptAccess"; bja["value"] ="always"; cja.appendChild(uBb("param", bja)); bja = {}; bja["name"] ="movie"; bja["value"] = aja; cja.appendChild(uBb("param", bja)); bja = {}; bja["name"] ="quality"; bja["value"] ="high"; cja.appendChild(uBb("param", bja)); bja = {}; bja["name"] ="bgcolor"; bja["value"] ="#ffffff"; cja.appendChild(uBb("param", bja)); bja = {}; bja["name"] ="flashVars"; bja["value"] = jja; cja.appendChild(uBb("param", bja)); if(!hga) { bja = {}; bja["src"] = aja; bja["width"] ="1"; bja["height"] ="1"; bja["quality"] ="high"; bja["bgcolor"] ="#ffffff"; bja["name"] ="WebToSpeech"; bja["allowScriptAccess"] ="always"; bja["align"] ="middle"; bja["type"] ="application/x-shockwave-flash"; bja["flashVars"] = jja; var dja = uBb("embed", bja); cja.appendChild(dja); } Sia.appendChild(cja); }function fja(gja, hja, ija){ var eja; if(Tca != null && Uca != null) { eja ='&userName='+ Tca +'&userPassword='+ Uca; } else { eja =""; } if(rca) { eja +="&customerName=pkt"; } var jja ='lessonServerLoc='+ gja +'&speechServerLoc='+ hja +'&speedValue='+ Zca + eja; if(Jca != null) { jja +='&translateServerLoc='+ Jca; } if(Kca != null) { jja +='&dictionaryServerLoc='+ Kca; } if(dca || eca ) { jja +='&cacheMode=true'; if(ija != null) { jja +='&cacheLiveFallover=true'; } } if(ija != null) { jja +='&speechServerBackupLoc='+ ija; } if(Pca != null && Qca != null && Rca != null) { jja +='&custID='+ Pca; jja +='&bookID='+ Qca; jja +='&pageID='+ Rca; } if(mca > -1) { jja +='&cacheCount='+ mca; } if(nca > -1) { jja +='&cacheTimeDelay='+ nca; } jja +='&locale='+ Yca; jja +='&speechName='+ Nca; if(Cda != null && Dda != null) { jja +='&searchString='+ Cda; jja +='&replaceString='+ Dda; } if(rga == null || rga =="") { rga = KLb(false) + Gca +"/"; } else if(rga.charAt(0) =='.') { if(rga.charAt(rga.length -1) !='/') { rga = Gca +"/"; } } else { if(rga.charAt(0) !='/') { rga ="/"+ Gca; } if(rga.charAt(rga.length -1) !='/') { rga = Gca +"/"; } rga = KLb(false) + Gca + rga; } if(Zda) { jja +='&SSLSpeech=true'; jja +='&SSLToolbar=true'; } else { if(ada) { jja +='&SSLSpeech=true'; } if(bda) { jja +='&SSLToolbar=true'; } } if(hga && (Zda||ada)) { jja +='&IESSL=true'; } Eca = Eca | Fca; if( (Eca & pronCreate_icon) == pronCreate_icon || (Eca & pronEdit_icon) == pronEdit_icon || oca) { jja +='&cacheBuster=true'; } strHtml ='<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" '; strHtml +='width="1" height="1" id="WebToSpeech" align="middle">'; strHtml +='  <param name="allowScriptAccess" value="always" />'; strHtml +='  <param name="movie" value="'+ rga +'WebToSpeech'+ Dca +'.swf" />'; strHtml +='  <param name="quality" value="high" />'; strHtml +='  <param name="bgcolor" value="#ffffff" />'; strHtml +='  <param name="flashVars" value="'+ jja +'"/>'; strHtml +='  <embed src="'+ rga +'WebToSpeech'+ Dca +'.swf" quality="high" bgcolor="#ffffff" width="1" height="1"'; strHtml +='   name="WebToSpeech" align="middle" allowScriptAccess="always"'; strHtml +='   type="application/x-shockwave-flash" '; strHtml +='   flashVars="'+ jja +'">'; strHtml +='  </embed>'; strHtml +='</object>'; document.writeln(strHtml);}var kja ="startbubble";var lja ="stopbubble";var mja = null;var nja;var oja;function pja(x, y, Msa){ if(Wda && baa) { x = x - 32; if(x<0) { x = 0; } y = y - 18; if(y<0) { y = 0; } var scrollLeft = rw_getScreenOffsetLeft(); var scrollTop = rw_getScreenOffsetTop(); nja = x + scrollLeft; oja = y + scrollTop; document.getElementById(kja).style.display="inline"; document.getElementById(kja).style.left = nja +'px'; document.getElementById(kja).style.top = oja +'px'; mja = Msa; }}function sja(){ if(mja != null) { $rw_event_stop(); uja(nja, oja); if(!mja.isRange()) { var rja = Tda; Tda = false; rw_speakHoverTarget(mja); Tda = rja; } else { rw_speakHoverTarget(mja); } }}function tja(){ $rw_event_stop();}function uja(x, y){ if(Wda && baa) { document.getElementById(lja).style.display="inline"; document.getElementById(lja).style.left = x +'px'; document.getElementById(lja).style.top = y +'px'; }}function vja(){ if(document.getElementById(kja)) { document.getElementById(kja).style.display="none"; }}function wja(){ if(document.getElementById(lja)) { try { document.getElementById(lja).style.display="none"; } catch(e) { pJb(e); } }}function zja(){ var xja = false; var yja = navigator.userAgent; if(yja.indexOf("MSIE 6") > -1) { xja = true; } else if(yja.indexOf("MSIE 7") > -1) { xja = true; } else if(yja.indexOf("MSIE 8") > -1) { xja = true; } else if(yja.indexOf("Safari") > -1) { xja = true; var Kra = navigator.appVersion; var Lra = Kra.lastIndexOf("/"); Kra = Kra.substring(Lra + 1); try { var Mra = parseFloat(Kra); if(Mra < 300 ) { ILb("You are using an older version of Safari that is not "+"support by the embedded bar in this page.  "+"The bar may not work at all or work erratically, "+"it is recommended that you upgrade to the latest version of Safari."); } } catch(err) { pJb(err); } } else if(yja.indexOf("Firefox") > -1) { xja = true; var Nla = yja.indexOf("Firefox") + 8; if(Nla < yja.length) { var aqa = yja.substr(Nla); var Poa = aqa.substr(0, aqa.indexOf(".")); try { var Gka = parseInt(Poa); if(Gka < 2) { if(Gka == 1) { aqa = aqa.substr(Poa.length + 1); var Qoa = aqa.substr(0, aqa.indexOf(".")); Gka = parseInt(Qoa); } else { Gka = 0; } if(Gka < 5) { ILb("You are using an older version of Firefox that is not "+"support by the embedded bar in this page.  "+"The bar may not work at all or work erratically, "+"it is recommended that you upgrade to the latest version of Firefox."); } } } catch(err) { pJb(err); } } } else { var Ika = navigator.platform; if(Ika.indexOf("mac") > -1) { ILb("The browser you are using is not supported by the embedded bar that should be displayed in this page.  "+"To view this page with the bar displayed please use Firefox (version 2.0.0.1 or later)."); } else { ILb("The browser you are using is not supported by the embedded bar that should be displayed in this page.  "+"To view this page with the bar displayed please use either Firefox (version 2.0.0.1 or later) "+"or Internet Explorer (version 6 or 7)."); } } return xja;}function Jka(){ if(typeof(eba_use_container) =="boolean") { zba = eba_use_container; } if(typeof(eba_allow_alerts_flag) =="boolean") { Aca = eba_allow_alerts_flag; } if(typeof(eba_alerts) =="boolean") { Aca = eba_alerts; } if(typeof(eba_no_title) =="boolean") { uba = eba_no_title; Oca = 0; } if(typeof(eba_noTitleFlag) =="boolean") { uba = eba_noTitleFlag; Oca = 0; } if(typeof(eba_hidden_bar) =="boolean") { bca = eba_hidden_bar; } if(typeof(eba_continuous_reading) =="boolean") { Tda = eba_continuous_reading; if(!Tda) { eda = false; } } if(typeof(eba_ignore_buttons) =="boolean") { cca = eba_ignore_buttons; } if(typeof(eba_speak_selection_by_sentence) =="boolean") { if(Tda) { eda = eba_speak_selection_by_sentence; } else { eda = false; } } if(typeof(eba_page_complete_after_selection) =="boolean") { fda = eba_page_complete_after_selection; } if(typeof(eba_speechCacheGenerateFlag) =="boolean") { dca = eba_speechCacheGenerateFlag; if(dca) { SpeechStream.cacheMode.mode = SpeechStream.cacheMode.CACHE_BUILDING_MODE; } } if(typeof(eba_cache_building_mode) =="boolean") { dca = eba_cache_building_mode; if(dca) { SpeechStream.cacheMode.mode = SpeechStream.cacheMode.CACHE_BUILDING_MODE; } } var Kka = false; if(typeof(eba_speechCacheFlag) =="boolean") { eca = eba_speechCacheFlag; Kka = true; } if(typeof(eba_speech_cache_flag) =="boolean") { eca = eba_speech_cache_flag; Kka = true; } if(typeof(eba_cache_mode) =="boolean") { eca = eba_cache_mode; Kka = true; } if(Kka && eca) { SpeechStream.cacheMode.mode = SpeechStream.cacheMode.CACHE_ONLY; } if(typeof(eba_cache_live_generation) =="boolean") { fca = eba_cache_live_generation; if(fca) { SpeechStream.cacheMode.mode = SpeechStream.cacheMode.CACHE_WITH_LIVE_SERVER; } } if(typeof(eba_split_cache_path) =="boolean") { gca = eba_split_cache_path; } if(typeof(eba_autoCachePage) =="boolean") { hca = eba_autoCachePage; } if(typeof(eba_voice_from_lang_flag) =="boolean") { Wca = eba_voice_from_lang_flag; } if(typeof(eba_bubble_mode) =="boolean") { Wda = eba_bubble_mode; } if(typeof(eba_bubble_freeze_on_shift_flag) =="boolean") { Xda = eba_bubble_freeze_on_shift_flag; } if(typeof(eba_hover_flag) =="boolean") { qba = !eba_hover_flag; } if(typeof(eba_store_pref) =="boolean") { pca = eba_store_pref; } if(typeof(eba_ssl_flag) =="boolean") { Zda = eba_ssl_flag; } if(typeof(eba_ssl_speech) =="boolean") { ada = eba_ssl_speech; } if(typeof(eba_ssl_toolbar) =="boolean") { bda = eba_ssl_toolbar; } if(typeof(eba_clientside_pronunciation) =="boolean") { if(eba_clientside_pronunciation) { if(typeof(eba_check_pronunciation_before_cache) =="boolean") { if(eba_check_pronunciation_before_cache) { SpeechStream.pronunciation.mode = SpeechStream.pronunciation.CLIENT_PRONUNCIATION_FOR_LIVE_SERVER; } else { SpeechStream.pronunciation.mode = SpeechStream.pronunciation.CLIENT_PRONUNCIATION_FOR_OFFLINE_CACHE; } } else { SpeechStream.pronunciation.mode = SpeechStream.pronunciation.CLIENT_PRONUNCIATION_FOR_OFFLINE_CACHE; } } else { SpeechStream.pronunciation.mode = SpeechStream.pronunciation.SERVER_PRONUNCIATION; } } else { if(typeof(eba_check_pronunciation_before_cache) =="boolean") { if(eba_check_pronunciation_before_cache) { SpeechStream.pronunciation.mode = SpeechStream.pronunciation.CLIENT_PRONUNCIATION_FOR_LIVE_SERVER; } else { SpeechStream.pronunciation.mode = SpeechStream.pronunciation.CLIENT_PRONUNCIATION_FOR_OFFLINE_CACHE; } } } if(typeof(eba_alter_browser_for_consistency) =="boolean") { dda = eba_alter_browser_for_consistency; } if(typeof(eba_cache_selection) =="boolean") { kca = eba_cache_selection; } if(typeof(eba_cache_user_text) =="boolean") { lca= eba_cache_user_text; } if(typeof(eba_skip_on_error) =="boolean") { if(eba_skip_on_error) { SpeechStream.actionOnError.action = SpeechStream.actionOnError.SKIP; } } if(typeof(eba_cache_buster) =="boolean") { if(eba_cache_buster) { oca = true; } } if(typeof(eba_handle_radio_checkbox_click) =="boolean") { if(eba_handle_radio_checkbox_click) { hda = true; } } if(typeof(eba_inline_img) =="boolean") { Vda = eba_inline_img; } if(typeof(eba_autocache_allspeeds) =="boolean") { oda = eba_autocache_allspeeds; } if(typeof(eba_ignore_hidden) =="boolean") { Cea = eba_ignore_hidden; } if(typeof(eba_limit_cookies) =="boolean") { Jda = eba_limit_cookies; } if(typeof(eba_icons) =="number") { Eca = eba_icons; } if(typeof(eba_no_display_icons) =="number") { Fca = eba_no_display_icons; } if(typeof(eba_title) =="number") { Oca = eba_title; } if(typeof(eba_language) =="number") { Vca = eba_language; if(Vca == 3) { Vca = 2; } else if(Vca > 3 || Vca < 0) { Vca = 0; } if(Wca) { if(eba_language >= 0 && eba_language < Hba.length) { Nca = Hba[eba_language]; } } } if(typeof(eba_speedValue) =="number") { Zca = eba_speedValue; } if(typeof(eba_speed_value) =="number") { Zca = eba_speed_value; } if(typeof(eba_reading_age) =="number") { $rw_setReadingAge(eba_reading_age); } if(typeof(eba_speed_offset) =="number") { Zca += eba_speed_offset; } if(typeof(eba_cache_retry) =="number") { mca = eba_cache_retry; } if(typeof(eba_cache_retry_timeout) =="number") { nca = eba_cache_retry_timeout; } if(typeof(eba_mp3_limit) =="number") { if(eba_mp3_limit < 1000) { Hda = Hda * 1024; } else { Hda = eba_mp3_limit; } } if(typeof(eba_max_word_count =="number")) { uta = eba_max_word_count; } if(typeof(eba_server_version) =="string") { Cca = eba_server_version; } if(typeof(eba_serverVersion) =="string") { Cca = eba_serverVersion; } if(typeof(eba_client_version) =="string") { if(eba_client_version !="latest") { Dca = eba_client_version; } } if(typeof(eba_clientVersion) =="string") { if(eba_clientVersion !="latest") { Dca = eba_clientVersion; } } if(typeof(eba_server) =="string") { Gca = eba_server; if(Gca.length > 6 && Gca.substring(0, 7) =="http://") { Gca = Gca.substring(7); } else if(Gca.length > 7 && Gca.substring(0, 8) =="https://") { Gca = Gca.substring(8); } } if(typeof(eba_speech_server) =="string") { Hca = eba_speech_server; } if(typeof(eba_speechServer) =="string") { Hca = eba_speechServer; } if(typeof(eba_speech_server_backup) =="string") { Ica = eba_speech_server_backup; } if(typeof(eba_speechServerBackup) =="string") { Ica = eba_speechServerBackup; } if(typeof(eba_translate_server) =="string") { Jca = eba_translate_server; } if(typeof(eba_dictionary_server) =="string") { Kca = eba_dictionary_server; } var Lka = false; var Mka = null; if(Hca != null && Hca =="speechus.texthelp.com") { Lka = true; Mka = Hca; } else if(Ica != null && Ica =="speechus.texthelp.com") { Lka = true; Mka = Ica; } if(Lka) { if (Cca !=null && Cca !="latest") { if(parseInt(Cca) > 181 && Jca == null) { Jca = Mka; } if(parseInt(Cca) > 181 && Kca == null) { Kca = Mka; } } else if(Cca =="latest") { if(Jca == null) { Jca = Mka; } if( Kca == null) { Kca = Mka; } } } if(typeof(eba_folder) =="string") { Lca = eba_folder; } if(typeof(eba_client_folder) =="string") { Mca = eba_client_folder; } if(typeof(eba_clientFolder) =="string") { Mca = eba_clientFolder; } if(typeof(eba_voice) =="string") { Nca = eba_voice; if(Nca =="ScanSoft Daniel_Full_22kHz") { Hba[ENG_UK] = Nca; } else if(Nca =="ScanSoft Tom_Full_22kHz") { Hba[ENG_US] = Nca; } else if(Nca =="ScanSoft Jill_Full_22kHz") { Hba[ENG_US] = Nca; } } if(typeof(eba_custId) =="string") { Pca = eba_custId; } if(typeof(eba_cust_id) =="string") { Pca = eba_cust_id; } if(typeof(eba_bookId) =="string") { Qca = eba_bookId; } if(typeof(eba_book_id) =="string") { Qca = eba_book_id; } if(typeof(eba_pageId) =="string") { Rca = eba_pageId; } if(typeof(eba_page_id) =="string") { Rca = eba_page_id; } if(Pca == null || Pca.length == 0 || Qca == null || Qca.length == 0 || Rca == null || Rca.length == 0) { SpeechStream.pronunciation.mode = SpeechStream.pronunciation.NONE; SpeechStream.cacheMode.mode = SpeechStream.cacheMode.NONE; } if(typeof(eba_loginName) =="string") { Tca = eba_loginName; } if(typeof(eba_login_name) =="string") { Tca = eba_login_name; } if((typeof(eba_loginPassword) =="string") || (typeof(eba_login_password) =="string")) { if(typeof(eba_loginPassword) =="string") { Uca = eba_loginPassword; } if(typeof(eba_login_password) =="string") { Uca = eba_login_password; } } else { Uca = Tca; } if(typeof(eba_locale) =="string") { Yca = eba_locale; } if(typeof(eba_speech_range_colors) =="string") { vba = eba_speech_range_colors; } if(typeof(eba_speech_range_colours) =="string") { vba = eba_speech_range_colours; } if(typeof(eba_speech_word_colors) =="string") { wba = eba_speech_word_colors; } if(typeof(eba_speech_word_colours) =="string") { wba = eba_speech_word_colours; } if(typeof(eba_mp3_id) =="string") { Gda = eba_mp3_id; } if(typeof(eba_search_speech_server) =="string") { Cda = eba_search_speech_server; } if(typeof(eba_replace_speech_server) =="string") { Dda = eba_replace_speech_server; } if(typeof(eba_play_start_point) =="string") { xba = eba_play_start_point; } if(typeof(eba_autocache_callback) =="string") { rda = eba_autocache_callback; }}function Nka(){ if(Qca == null) { ILb("Persistent annotations is enabled but no book id was provided, "+"this feature will not work in this page."); return; } if(Rca == null) { ILb("Persistent annotations is enabled but no page id was provided, "+"this feature will not work in this page."); return; } sca = true; if(typeof(eba_annotate_note_editor_id) =="string") { tca = eba_annotate_note_editor_id; } if(typeof(eba_annotate_highlight_editor_id) =="string") { uca = eba_annotate_highlight_editor_id; } if(typeof(eba_annotate_note_reader_id) =="string") { vca = eba_annotate_note_reader_id; } if(typeof(eba_annotate_highlight_reader_id) =="string") { wca = eba_annotate_highlight_reader_id; } if(typeof(eba_annotate_persist_notes) =="boolean"&& tca !="*") { xca = eba_annotate_persist_notes; } if(typeof(eba_annotate_persist_highlights) =="boolean"&& uca !="*") { yca = eba_annotate_persist_highlights; } if(typeof(eba_annotate_storage_url) =="string") { zca = eba_annotate_storage_url; if(typeof(eba_server) =="undefined") { Gca = zca; } } else { if(eca) { if(Ica != null) { zca = Ica; } else { zca = Gca; } } else { zca = Hca; } } if(typeof(eba_annotate_confirm_delete_note) =='boolean') { Bda = eba_annotate_confirm_delete_note; } if(xca) { if((Eca & sticky_icon) != sticky_icon ) { Eca += sticky_icon; } }}function Oka(){ rca = true; sca = true; if(typeof(pktIsTeacher) =="boolean") { xca = pktIsTeacher; } if(typeof(pktTitleId) =="string") { Qca = pktTitleId; } if(typeof(pktPageId) =="string") { Rca = pktPageId; } if(typeof(pktStudentId) =="string") { if(!xca) { yca = true; } uca = pktStudentId; vca = pktStudentId; } if(typeof(pktTeacherId) =="string") { tca = pktTeacherId; wca = pktTeacherId; } if(typeof(pktStorageUrl) =="string") { zca = pktStorageUrl; if(typeof(eba_server) =="undefined") { Gca = zca; } } else { zca = Gca; } if(typeof(pktSpeechServerUrl) =="string") { Hca = pktSpeechServerUrl; } if(typeof(pktVoice) =="string") { Nca = pktVoice; } if(typeof(pktCustCode) =='string') { Ada = pktCustCode; } if(typeof(pktConfirmOnDelete) =='boolean') { Bda = pktConfirmOnDelete; } if(xca) { if((Eca & sticky_icon) != sticky_icon ) { Eca += sticky_icon; } }}function Xka(){ if (top.frames.length > 0) { var i = 0; var tZb = top.frames.length; for (i = 0; i < tZb; i++) { var yLb = top.frames[i]; try { var qka = yLb.document; var b = Zka(qka.body); if(!b) { return false; } } catch(e) { pJb(e); } } } if(document.body != null) { return Zka(document.body); } else { return true; }}function Zka(eJb){ if(eJb.firstChild != null) { var iEb = eJb.firstChild; var sYb = iEb.ownerDocument.body; try { while(iEb != null && iEb != sYb) { iEb = sva(iEb); } } catch(er) { return false; } } return true;}var Uka = 0;var Vka = false;var Wka = null;function cka(){ if(Wka != null) { return Wka; } else { var flash = null; try { if(oga) { flash = window.document.WebToSpeech; } else { if (window.document.WebToSpeech) { flash = window.document.WebToSpeech; } else {flash = window.WebToSpeech; } } if(flash != null) { flash.getVersion(); Wka = flash; } } catch(err) { flash = null; Wka = null; } if(flash == null) { var dka = document.getElementById("WebToSpeech"); if(dka != null) { flash = dka; try { flash.getVersion(); Wka = flash; } catch(e) { flash = null; Wka = null; } if(flash == null && !hga) { var tZb = dka.childNodes.length; var i; for(i=0; i<tZb; i++) { var BWb = dka.childNodes[i]; if(BWb.tagName.toLowerCase() =="embed") { flash = BWb; try { flash.getVersion(); Wka = flash; } catch(e) { flash = null; Wka = null; } } } } } } return flash; }}function $rw_versionCheck(){ try { if(typeof(eba_no_flash) =="boolean"&& eba_no_flash == true) { vfa = true; } else { var flash = cka(); var lka = flash.getVersion(); var ika = parseFloat(lka); if(ika < 1.05 || ika == NaN) { vfa = false; } else { vfa = true; } } } catch(err) { vfa = false; Uka++; if(Uka < 50) { setTimeout("$rw_versionCheck();", 100); } else { if(Wka == null && !Vka) { if(dca) { } else { ILb("A necessary flash component failed to load.  This page will not work as intended.\n"+"Could not load file from: "+ rga +'WebToSpeech'+ Dca +'.swf'); } Vka = true; } } }}var jka = -1;function $rw_getFlashVersion(){ if(jka < 0) { try { var flash = cka(); var lka = flash.getVersion(); jka = parseInt(lka); } catch(err) { jka = parseInt(Dca); pJb(err); } } return jka;}function mka(nka, pka){ if(nka == null || pka == null) { return false; } if(nka = pka) { return true; } if(nka.frames.length > 0) { var i; for(i=0; i<nka.frames.length; i++) { if(pka == nka.frames[i]) { return true; } else { if(nka.frames[i].length > 0) { if(mka(nka.frames[i], pka)) { return true; } } } } return false; } else { return false; }}function $rw_addEventsToFrame(p_frame){ try { var qka = p_frame.document; Fma(qka,'mouseout', Boa); Fma(qka,'mouseup', zna); Fma(qka,'click', dna); Fma(qka,'mousemove', sna); Fma(qka,'mouseover', gna); Fma(qka,'mousedown', Zna); Fma(qka,'dragstart', ana); Fma(qka,'keyup', Yna); } catch(er) { } if(p_frame.frames.length > 0) { var i = 0; for(i=0;i<p_frame.frames.length; i++) { $rw_addEventsToFrame(p_frame.frames[i]); } }}function $rw_pageSetup(){ $rw_tagSentencesWithFrames(window); if(window.frames.length > 0) { var i = 0; try { var tZb = top.frames.length; for (i = 0; i < tZb; i++) { $rw_addEventsToFrame(window.frames[i]); } } catch(e) { pJb(e); } } yga = document.getElementById('SWA1'); if(yga != null) { Fma(yga,'mouseup', Hma); } if(yga != null) { qma(wga); } Nna = document.getElementById('rwDrag').style; Nna.display ="inline"; Uka = 0; $rw_versionCheck(); rw_initialPronunciationLoad();}function rw_initialPronunciationLoad(){ if(!vfa) { if(Uka < 50) { setTimeout("rw_initialPronunciationLoad();", 109); } return; } Eha = false; var tka = false; if(vfa && typeof(vRb) =="function") { if(SpeechStream.pronunciation.fetchData()) { tka = true; } } if(tka) { if(Pca != null && Pca.length > 0 && Qca != null && Qca.length > 0 && Rca != null && Rca.length > 0) { Fha = true; pQb.deleteAll(); vRb(); } }}function $rw_tagSentencesWithFrames(p_frame){ if(typeof(p_frame) =="undefined") { p_frame = window; } if(p_frame.document && p_frame.document.body) { $rw_tagSentences(p_frame.document.body); } if (p_frame.frames.length > 0) { var i = 0; var tZb = p_frame.frames.length; for (i = 0; i < tZb; i++) { try { var yLb = p_frame.frames[i]; if(yLb.frames.length > 0) { $rw_tagSentencesWithFrames(yLb.frames); } else { if(yLb.document && yLb.document.body) { $rw_tagSentences(yLb.document.body); } } } catch(err) { } } }}var wka ="[\\x21\\x2E\\x3F\\x3A]";var xka = /[\n\r\t ]{2,}/g;function $rw_tagSentences(eJb){ if(typeof(eJb) =='undefinded'|| eJb == null) { eJb = document.body; } try { jaa = true; var yka = false; var zka = false; if(Sca >= 200 && Sca < 300) { zka = true; } Qda = zka; var SOb = eJb; while(SOb != null) { if(SOb.nodeType == 3) { var QLb = SOb.parentNode.tagName.toLowerCase(); if(QLb =="textarea") { SOb = Dva(SOb, false, null); continue; } var cYb = SOb.nodeValue; var Dla = cYb.trimSpaceTH(); var gla = Dla.length > 0; if(Fda && QLb =="a") { gla = false; } if(!gla) { if(sca || eca && (Qda || rca || dda) ) { if(yka) { if(!Fda) { SOb.nodeValue =" "; } yka = false; SOb = Dva(SOb, false, null); } else { var ARb = SOb; SOb = Dva(SOb, false, null); if(!Fda) { ARb.parentNode.removeChild(ARb); } } } else { SOb = Dva(SOb, false, null); } } else { if(!Fda) { if(sca || eca && (Qda || rca || dda) ) { if(Dla.length < cYb.length) { var nSb = false; Dla = cYb.trimSpaceStartTH(); if((cYb.length - Dla.length) > 0) { if(yka) { cYb =" "+ Dla; } else { cYb = Dla; } nSb = true; } Dla = cYb.trimSpaceEndTH(); if((cYb.length - Dla.length) > 1) { cYb = Dla +" "; yka = false; nSb = true; } Dla = cYb.replace(xka," "); if(Dla.length < cYb.length) { cYb = Dla; nSb = true; } if(nSb) { SOb.nodeValue = cYb; } } } } var Qab; Qab = cYb.search(wka); var Ila = (SOb.parentNode.getAttribute("texthelpSkip") != null); var Jla = SOb; if(Qab > -1 && Qab < (cYb.length - 1)) { var Kla = true; while(true) { var zsa = qla(cYb, Qab, SOb); if(zsa) { break; } else { var Mla = cYb.substring(Qab + 1); var Nla = Mla.search(wka); if(Nla > -1) { Qab = Qab + 1 + Nla; } else { Kla =false; break; } } } if(Kla) { var uya = cYb.substring(0, Qab + 1); var vya = cYb.substring(Qab + 1); var span = document.createElement("span"); span.setAttribute(gaa,"1"); var yya = document.createTextNode(uya); var zya = document.createTextNode(vya); var Zla = SOb.parentNode; Zla.insertBefore(zya, SOb); Zla.insertBefore(span, zya); span.appendChild(yya); Zla.removeChild(SOb); SOb = zya; Jla = yya; } else { if(SOb.previousSibling != null || SOb.nextSibling != null || Ila) { var span = document.createElement("span"); span.setAttribute(gaa,"1"); var yya = document.createTextNode(cYb); var Zla = SOb.parentNode; Zla.insertBefore(span, SOb); span.appendChild(yya); Zla.removeChild(SOb); SOb = yya; } Jla = SOb; SOb = Dva(SOb, false, null); } } else { if(SOb.previousSibling != null || SOb.nextSibling != null || Ila) { var span = document.createElement("span"); span.setAttribute(gaa,"1"); var yya = document.createTextNode(cYb); var Zla = SOb.parentNode; Zla.insertBefore(span, SOb); span.appendChild(yya); Zla.removeChild(SOb); SOb = yya; } Jla = SOb; SOb = Dva(SOb, false, null); } if(sca || eca && (Qda || rca || dda) ) { var ala = Jla.nodeValue; var bla = Jla.nodeValue.length; if(bla > 0 && ala.charCodeAt(bla - 1) == 32) { yka = false; } else { yka = true; } } } } else if(SOb.nodeType == 1) { if(sca) { if(!Cza(SOb)) { if(Lza(SOb)) { yka = false; } } else if(SOb.tagName.toLowerCase() =="img") { yka = true; } } if(zka) { if(SOb.tagName.toLowerCase() =="img") { var bza = SOb.getAttribute("title"); SOb.setAttribute("msg", bza); } } else if(Vda) { if(SOb.tagName.toLowerCase() =="img") { var bza = SOb.getAttribute("title"); if(bza != null && bza.length > 0) { SOb.setAttribute("msg", bza); } else { bza = SOb.getAttribute("alt"); SOb.setAttribute("msg", bza); } } } var kla = SOb.getAttribute(eaa); var lla = SOb.getAttribute(daa); if(SOb.tagName.toLowerCase() =="pre"|| (kla != null && kla.length > 0) || (lla != null && lla.length > 0)) { SOb = Yva(SOb, false, null); } else { SOb = Dva(SOb, false, null); } } else { SOb = Dva(SOb, false, null); } } if(sca) { SOb = eJb; while(SOb != null) { if(SOb.nodeType==3) { var gla = SOb.nodeValue.trimTH().length > 0; if(gla) { var hla = SOb.parentNode; var ila = hla.getAttribute("id"); if(ila == null || ila.length == 0) { hla.id ="rwTHnoteMarker"+ Cha; ++Cha; } } SOb = Dva(SOb, false, null); } else if(SOb.nodeType == 1) { if(nYb(SOb)) { var jla = SOb.getAttribute("id"); if(jla == null || jla.length == 0) { SOb.id ="rwTHnoteMarker"+ Cha; ++Cha; } } var kla = SOb.getAttribute(eaa); var lla = SOb.getAttribute(daa); if( SOb.tagName.toLowerCase() =="pre"|| (kla != null && kla.length > 0) || (lla != null && lla.length > 0)) { SOb = Yva(SOb, false, null); } else { SOb = Dva(SOb, false, null); } } else { SOb = Dva(SOb, false, null); } } } } catch(exception) { oJb(exception); } jaa = false; Pda = true;}function qla(LKb, zTb, oYb){ var mla = true; var tZb = LKb.length; if(tZb > zTb + 1) { var CRb = LKb.charCodeAt(zTb + 1); if(EKb(CRb)) { mla = false; } } if(mla) { if(zTb > 1) { var cRb = LKb.substring(zTb - 2, zTb); if( (cRb.charAt(0) ==' '|| cRb.charAt(0) =='\n'|| cRb.charAt(0) =='\r'|| cRb.charAt(0) =='\t') && cRb.charCodeAt(1) > 63 && cRb.charCodeAt(1) < 91) { mla = false; } else if(cRb.charAt(0) =='.'&& EKb(cRb.charCodeAt(1))) { mla = false; } else { if(cRb =="Dr"|| cRb =="Mr"|| cRb =="Ms"|| cRb =="Av"|| cRb =="St"|| cRb =="eg") { mla = false; } else if(zTb > 2) { var dRb = LKb.substring(zTb - 3, zTb); if(dRb =="Mrs"|| dRb =="etc"|| dRb =="i.e"|| dRb =="P.O"|| dRb =="PhD") { mla = false; } else if(zTb > 3) { var wla = LKb.substring(zTb - 4, zTb); if(wla =="Ph.D") { mla = false; } } } } } else { try { if(oYb != null && zTb == 0) { if(Ida) { var jua = null; if(oYb.previousSibling != null && oYb.previousSibling.nodeType == 1) { jua = oYb.previousSibling; } else if(oYb.parentNode.previousSibling != null && oYb.parentNode.previousSibling.nodeType == 1) { jua = oYb.parentNode.previousSibling; } else { var SOb = oYb.parentNode; while(SOb != null && SOb.parentNode.tagName.toLowerCase() =="span") { if(SOb.parentNode.previousSibling != null && SOb.parentNode.previousSibling.nodeType == 1) { jua = SOb.parentNode.previousSibling; break; } SOb = SOb.parentNode; } } if(jua != null) { if(jua.nodeType == 1 && jua.tagName.toLowerCase() =="span") { bza = jua.getAttribute(("class")); fua = jua.getAttribute(("className")); var hua = false; hua = (bza != null && (bza.toLowerCase() =="x2"|| bza.toLowerCase() =="x3")) || (fua != null && (fua.toLowerCase() =="x2"|| fua.toLowerCase() =="x3")); if(hua) { if(jua.lastChild.nodeType == 1) { while(jua != null && jua.lastChild != null && jua.lastChild.nodeType != 3) { jua = jua.lastChild; } } if(jua != null && jua.lastChild.nodeType == 3) { return qla(jua.lastChild.nodeValue + LKb, jua.lastChild.nodeValue.length, null); } else { } } } } } else { var BWb = Zwa(oYb, true, null); if(BWb != null && BWb.nodeType ==3) { if(!qla(BWb.nodeValue + LKb, BWb.nodeValue.length, null)) { return false; } } } } } catch(err) { } } } if(mla && typeof(allowedAbbr) =="object"&& typeof(allowedAbbr.length) =="number") { var Bma = allowedAbbr.length; var i; var Cma; for(i=0; i< Bma; i++) { Cma = allowedAbbr[i]; if(typeof(Cma) =="string") { if(zTb - Cma.length > -1) { if(LKb.substring(zTb - Cma.length, zTb) == Cma) { mla = false; break; } } } } } return mla;}var Dma = null;function Ema(event){ Dma = event.currentTarget;}function Fma(kRb, eventType, func){ if (kRb.addEventListener) { kRb.addEventListener(eventType, func, false); return true; } else if (kRb.attachEvent) { return kRb.attachEvent("on"+ eventType, func); } else { return false; }}function Hma(){ if(!wga) { var flash = IGb(uga); flash.gotFocus(); qma(true); } xga = true;}function Jma(){ if(lba) { var i=0; var nW = ((window.innerWidth)?window.innerWidth:document.documentElement.offsetWidth) - 50; var Ima = nW+"px"; for(i=1; i<11; i++) { var pab = document.getElementById("placeholderSWA"+ i); if(pab != null) { pab.style.width = Ima; } } } var Nna; Nna = document.getElementById('rwDrag').style; if (Nna == null) { return; } if(!zba) { var x; var y; if(typeof(eba_override_x) !='undefined'&& typeof(eba_override_y) !='undefined') { x = eba_override_x; y = eba_override_y; } else { var wd = rw_getDisplayWidth(); var ht = rw_getDisplayHeight(); if(uba) { Iga = 1; Jga = 0; Ega = 0; } x = wd * Iga; y = ht * Jga; if ((x + Lga + Ega) > rw_getDisplayWidthAdjusted()) { x = rw_getDisplayWidthAdjusted() - Lga - Ega; } if (x < Ega) { x = Ega; } if ((y + Mga + Ega) > rw_getDisplayHeightAdjusted()) { y = rw_getDisplayHeightAdjusted() - Mga - Ega; } if (y < Ega) { y = Ega; } x = rw_getScreenOffsetLeft() + x; y = rw_getScreenOffsetTop() + y; if(uba) { y = 0; } } Nna.left = x +'px'; Nna.top = y +'px'; } if(bca) { return; } Nna.visibility ='visible'; Nna.display ="inline"; var ARb = document.getElementById("rwMainOutline"); if(ARb != null) { ARb.style.visibility ='visible'; ARb.style.display ="block"; } ARb = document.getElementById("rwMainNoOutline"); if(ARb != null) { ARb.style.visibility ='visible'; ARb.style.display ="block"; }}function Nma(){ Rma(0); Rma(1); Rma(2); Rma(3); Rma(4); Rma(5); Rma(6); Rma(7); Rma(8); Rma(9); Rma(10); Rma(11);}function Rma(Ina){ var Oma; var Nna; var pYb; switch(Ina) { case 0: pYb ="rwDisplay"; break; case 1: pYb ="rwTrans"; break; case 2: pYb ="rwFF"; break; case 3: pYb ="rwDict"; break; case 4: pYb ="rwCollect"; break; case 5: pYb ="rwSticky"; break; case 6: pYb ="rwPronCreate"; break; case 7: pYb ="rwPronEdit"; break; case 8: pYb ="rwCal"; break; case 9: pYb ="rwGenerateCache"; break; case 10: pYb ="rwCheckCache"; break; case 11: pYb ="rwPictureDictionary"; break; default: pYb ="rwDisplay"; } Oma = document.getElementById(pYb); if(typeof(Oma) =='undefined'|| Oma == null) { return; } Nna = Oma.style; if (Nna == null) { return; } if(Rga[Ina]) { Nna.display ="block"; if(Nna.visibility =='visible') { var jIb = Ona(pYb); if(jIb != null) { var Uma = parseInt(jIb.offsetHeight); if(!isNaN(Uma)) { Qga[Ina] = Uma - 4; } } } var width = rw_getDocumentDisplayWidth(); var height = rw_getDocumentDisplayHeight(); var x = width * Nga[Ina]; var y = height * Oga[Ina]; if ((x + Pga[Ina] + Ega) > rw_getDocumentDisplayWidthAdjusted()) { x = rw_getDocumentDisplayWidthAdjusted() - Pga[Ina] - Ega; } if (x < Ega) { x = Ega; } if ((y + Qga[Ina] + Ega) > rw_getDocumentDisplayHeightAdjusted()) { y = rw_getDocumentDisplayHeightAdjusted() - Qga[Ina] - Ega; } if (y < Ega) { y = Ega; } x = rw_getScreenOffsetLeft() + x; y = rw_getScreenOffsetTop() + y; Nna.left = x +'px'; Nna.top = y +'px'; Nna.visibility ='visible'; } else { if(pga) { Nna.display ="none"; } Nna.visibility ='hidden'; }}function Vma(x, y){ Iga = x / rw_getDocumentDisplayWidth(); Jga = y / rw_getDocumentDisplayHeight();}function Wma(Ina, x, y){ Nga[Ina] = x / rw_getDocumentDisplayWidth(); Oga[Ina] = y / rw_getDocumentDisplayHeight();}function Yma(ev){ if (ev.pageX) { if(fga) { return {x:(ev.pageX - document.documentElement.scrollLeft), y:(ev.pageY - document.documentElement.scrollTop)}; } else if(gga) { return {x:(ev.pageX - document.body.parentNode.scrollLeft), y:(ev.pageY - document.body.parentNode.scrollTop)}; } else { return {x:(ev.pageX - document.body.scrollLeft), y:(ev.pageY - document.body.scrollTop)}; } } else { return {x:ev.clientX, y:ev.clientY}; }}function ama(bma){ var left = 0; var top = 0; if(bma.nodeType == 3) { bma = bma.parentNode; } while (bma.offsetParent) { left += bma.offsetLeft + (bma.currentStyle ? (parseInt(bma.currentStyle.borderLeftWidth)).NaN0():0); top += bma.offsetTop + (bma.currentStyle ? (parseInt(bma.currentStyle.borderTopWidth)).NaN0():0); bma = bma.offsetParent; } left += bma.offsetLeft + (bma.currentStyle ? (parseInt(bma.currentStyle.borderLeftWidth)).NaN0():0); top += bma.offsetTop + (bma.currentStyle ? (parseInt(bma.currentStyle.borderTopWidth)).NaN0():0); left -= rw_getScreenOffsetLeft(); top -= rw_getScreenOffsetTop(); return {x:left, y:top};}var cma = false; var dma = false; var ema = false; function $rw_isSpeaking(){ return cma;}var fma ="funplay play cyan magenta yellow green clear collect trans ffinder dict picturedictionary";var gma ="cyan magenta yellow green clear collect";var hma ="spell homophone pred";function jma(rma){ if($g_bMouseSpeech) { rma = true; } if(dma == rma) { return; } try { for (var i = 0; i < xfa; i++) { var pYb = g_icons[i][0]; if (fma.indexOf(pYb) > -1) { if (rma) { if(oga) { document.images[g_icons[i][0]].src = g_icons[i][5].src; } else { Nia(g_icons[i][0],"mask", false); } } else { if(oga) { document.images[g_icons[i][0]].src = g_icons[i][1].src; } else { Nia(g_icons[i][0],"flat", false); } } } } dma = rma; } catch(err) { pJb(err); }}function lma(rma){ if(ida != null) { if(ema == rma) { return; } try { if (rma) { Kia("speaker"+ida,"on"); } else { Kia("speaker"+ida,"off"); ida = null; } ema = rma; } catch(err) { pJb(err); } }}function nma(rma){ cma = rma;}function qma(rma){ wga = rma; try { for (var i = 0; i < xfa; i++) { var pYb = g_icons[i][0]; if (gma.indexOf(pYb) > -1) { if (rma) { if(oga) { document.images[g_icons[i][0]].src = g_icons[i][5].src; } else { Nia(g_icons[i][0],"mask", false); } } else { if(oga) { document.images[g_icons[i][0]].src = g_icons[i][1].src; } else { Nia(g_icons[i][0],"flat", false); } } } } for (var i = 0; i < yfa; i++) { var pYb = wfa[i][0]; if (hma.indexOf(pYb) > -1) { if(rma) { var flash = IGb(uga); if(flash != null) { var Vna = flash.getSpelling(); var Wna = flash.getHomophone(); var Xna = flash.getPrediction(); if(pYb =="spell") { wfa[i][8] = Vna; if(Vna) { if(oga) { document.images[wfa[i][0]].src = wfa[i][Sha].src; } else { Nia(wfa[i][0],"toggleOn", true); } } else { if(oga) { document.images[wfa[i][0]].src = wfa[i][Oha].src; } else { Nia(wfa[i][0],"flat", true); } } } else if(pYb =="homophone") { wfa[i][8] = Wna; if(Wna) { if(oga) { document.images[wfa[i][0]].src = wfa[i][Sha].src; } else { Nia(wfa[i][0],"toggleOn", true); } } else { if(oga) { document.images[wfa[i][0]].src = wfa[i][Oha].src; } else { Nia(wfa[i][0],"flat", true); } } } else if(pYb =="pred") { wfa[i][8] = Xna; if(Xna) { if(oga) { document.images[wfa[i][0]].src = wfa[i][Sha].src; } else { Nia(wfa[i][0],"toggleOn", true); } } else { if(oga) { document.images[wfa[i][0]].src = wfa[i][Oha].src; } else { Nia(wfa[i][0],"flat", true); } } } else { if(oga) { document.images[wfa[i][0]].src = wfa[i][Oha].src; } else { Nia(wfa[i][0],"flat", true); } } } else { if(oga) { document.images[wfa[i][0]].src = wfa[i][Oha].src; } else { Nia(wfa[i][0],"flat", true); } } } else { if(oga) { document.images[wfa[i][0]].src = wfa[i][Rha].src; } else { Nia(wfa[i][0],"mask", true); } } } } } catch(err) { pJb(err); }}function $rw_divOver(Ina){ var pYb; switch(Ina) { case Sga: pYb ="displayImg"; break; case Tga: pYb ="transImg"; break; case Uga: pYb ="FFImg"; break; case Vga: pYb ="dictImg"; break; case Wga: pYb ="collectImg"; break; case Yga: pYb ="pronCreateImg"; break; case Zga: pYb ="pronEditImg"; break; case aga: pYb ="calImg"; break; case bga: pYb ="generateCacheImg"; break; case cga: pYb ="checkCacheImg"; break; case dga: pYb ="pictureDictionaryImg"; break; default: pYb ="displayImg"; } if (document.images[pYb] != null) { document.images[pYb].src = $g_strFileLoc +"rwimgs/thepressedx.bmp"; }}function $rw_divOut(Ina){ var pYb; switch(Ina) { case Sga: pYb ="displayImg"; break; case Tga: pYb ="transImg"; break; case Uga: pYb ="FFImg"; break; case Vga: pYb ="dictImg"; break; case Wga: pYb ="collectImg"; break; case Yga: pYb ="pronCreateImg"; break; case Zga: pYb ="pronEditImg"; break; case aga: pYb ="calImg"; break; case bga: pYb ="generateCacheImg"; break; case cga: pYb ="checkCacheImg"; break; case dga: pYb ="pictureDictionaryImg"; break; default: pYb ="displayImg"; } if (document.images[pYb] != null) { document.images[pYb].src = $g_strFileLoc +"rwimgs/thex.bmp"; }}function $rw_divPress(Ina){ $rw_event_stop(); Gna(false, Ina);}function Bna(Ina, RXb){ var Nna; var pYb; switch(Ina) { case Sga: pYb ="rwpopupdisplay"; break; case Tga: pYb ="rwpopuptrans"; break; case Uga: pYb ="rwpopupff"; break; case Vga: pYb ="rwpopupdict"; break; case Wga: pYb ="rwpopupcollect"; break; case Yga: pYb ="rwpopupproncreate"; break; case Zga: pYb ="rwpopuppronedit"; break; case aga: pYb ="rwpopupcal"; break; case bga: pYb ="rwpopupgeneratecache"; break; case cga: pYb ="rwpopupcheckcache"; break; case dga: pYb ="rwpopuppicturedictionary"; break; default: pYb ="rwpopupdisplay"; } Nna = document.getElementById(pYb); if (Nna == null) { return; } Nna.innerHTML = RXb;}function Gna(Hna, Ina){ var Nna; Rga[Ina] = Hna; var pYb; switch(Ina) { case Sga: pYb ="rwDisplay"; break; case Tga: pYb ="rwTrans"; break; case Uga: pYb ="rwFF"; break; case Vga: pYb ="rwDict"; break; case Wga: pYb ="rwCollect"; break; case Xga: pYb ="rwSticky"; break; case Yga: pYb ="rwPronCreate"; break; case Zga: pYb ="rwPronEdit"; break; case aga: pYb ="rwCal"; break; case bga: pYb ="rwGenerateCache"; break; case cga: pYb ="rwCache"; break; case dga: pYb ="rwPictureDictionary"; break; default: pYb ="rwDisplay"; } var jIb = Ona(pYb); if(jIb != null) { Nna = jIb.style; if (Nna == null) { return; } if(Hna) { Lna(); Nna.visibility ='visible'; Nna.display ='block'; Nna.zIndex = 501; } else { Nna.visibility ='hidden'; if(pga) { Nna.display ="none"; } Bna(Ina,""); } } Nma();}function Lna(){ var pYb; pYb ="rwDisplay"; var jIb = Ona(pYb); var Nna; if(jIb != null && jIb.style) { Nna = jIb.style; Nna.zIndex = 500; } pYb ="rwTrans"; jIb = Ona(pYb); if(jIb != null && jIb.style) { Nna = jIb.style; Nna.zIndex = 500; } pYb ="rwFF"; jIb = Ona(pYb); if(jIb != null && jIb.style) { Nna = jIb.style; Nna.zIndex = 500; } pYb ="rwDict"; jIb = Ona(pYb); if(jIb != null && jIb.style) { Nna = jIb.style; Nna.zIndex = 500; } pYb ="rwCollect"; jIb = Ona(pYb); if(jIb != null && jIb.style) { Nna = jIb.style; Nna.zIndex = 500; } pYb ="rwSticky"; jIb = Ona(pYb); if(jIb != null && jIb.style) { Nna = jIb.style; Nna.zIndex = 500; } pYb ="rwCal"; jIb = Ona(pYb); if(jIb != null && jIb.style) { Nna = jIb.style; Nna.zIndex = 500; } pYb ="rwGenerateCache"; jIb = Ona(pYb); if(jIb != null && jIb.style) { Nna = jIb.style; Nna.zIndex = 500; } pYb ="rwCheckCache"; jIb = Ona(pYb); if(jIb != null && jIb.style) { Nna = jIb.style; Nna.zIndex = 500; } pYb ="rwPictureDictionary"; jIb = Ona(pYb); if(jIb != null && jIb.style) { Nna = jIb.style; Nna.zIndex = 500; }}function Ona(sPb){ return document.getElementById(sPb);}function $speechFinishedInFlash(){ jma(false); lma(false); nma(false);}function $flashHasFocus(p_bHasFocus, OEb){ if(1==1) {return;} uga = parseInt(OEb); if(p_bHasFocus) { var flash = IGb(uga); if(flash != null) { var Vna = flash.getSpelling(); var Wna = flash.getHomophone(); var Xna = flash.getPrediction(); wfa[Mda][8] = Vna; if(Vna) { if(oga) { document.images[wfa[Mda][0]].src = wfa[i][Sha].src; } else { Nia(wfa[Mda][0],"toggleOn", true); } } else { if(oga) { document.images[wfa[Mda][0]].src = wfa[i][Oha].src; } else { Nia(wfa[Mda][0],"flat", true); } } wfa[Nda][8] = Wna; if(Wna) { if(oga) { document.images[wfa[Nda][0]].src = wfa[i][Sha].src; } else { Nia(wfa[Nda][0],"toggleOn", true); } } else { if(oga) { document.images[wfa[Nda][0]].src = wfa[i][Oha].src; } else { Nia(wfa[Nda][0],"flat", true); } } wfa[Oda][8] = Xna; if(Xna) { if(oga) { document.images[wfa[Oda][0]].src = wfa[i][Sha].src; } else { Nia(wfa[Oda][0],"toggleOn", true); } } else { if(oga) { document.images[wfa[Oda][0]].src = wfa[i][Oha].src; } else { Nia(wfa[Oda][0],"flat", true); } } } } else { var flash = IGb(uga); if(flash != null) { var Vna = flash.getSpelling(); var Wna = flash.getHomophone(); var Xna = flash.getPrediction(); wfa[Mda][8] = Vna; wfa[Nda][8] = Wna; wfa[Oda][8] = Xna; } }}Number.prototype.NaN0 = function(){ return isNaN(this)?0:this;};function $setToolbarX(p_fBarX){ if(p_fBarX<0) { Iga = 0; } else if(p_fBarX > 1) { Iga = 1; } else { Iga = p_fBarX; } Jma();}function $setToolbarY(p_fBarY){ if(p_fBarY<0) { Jga = 0; } else if(p_fBarY > 1) { Jga = 1; } else { Jga = p_fBarY; } Jma();}function $getToolbarX(){ return Iga;}function $getToolbarY(){ return Jga;}function Yna(event){}function Zna(event){ if(!baa) { return; } var target = event.target || event.srcElement; if(target.id =='rwDragMe'|| target.id =='rwDragMeDisplay'|| target.id =='rwDragMeTrans'|| target.id =='rwDragMeFF'|| target.id =='rwDragMeDict'|| target.id =='rwDragMeCollect'|| target.id =='rwDragMeStickyNoteTop'|| target.id =='rwDragMeStickyNoteBot'|| target.id =='rwDragMePronCreate'|| target.id =='rwDragMePronEdit'|| target.id =='rwDragMeCal'|| target.id =='rwDragMePictureDictionary') { Cga = target; Dga = true; if (Cga.setCapture) {Cga.setCapture(true); } Bga = ama(Cga); if(target.id =='rwDragMeStickyNoteBot') { Bga.y -= target.offsetTop; } Aga = Yma(event); return false; }}function ana(event){ if(!baa) { return; } var target = event.target || event.srcElement; if (target.tagName =="IMG"&& target.className =="rwIcon") { Coa(event); return false; }}var bna = 0;function dna(event){ if(!baa) { return; } var gOb = (new Date).getTime(); if((gOb - bna) < Iea ) { return; } bna = gOb; if(vga > 0) { --vga; } if (event != null) { if (!Dga) { if($g_bMouseSpeech && qba) { hra(event); } if(Dha) { OYb(event); } } }}function gna(event){ if(!baa) { return; } if (event != null) { if (!Dga) { if(oga) { if($g_bMouseSpeech && !qba) { hra(event); } else if(Wda) { Rra(event); } else if(((Eca & calculator_icon) == calculator_icon) && MPb()) { if(wna(event)) { hra(event, true); } } } } }}var ena = -1;var fna = -1;function sna(event){ if(!baa) { return; } if (event == null) { return true; } if(hga) { var hna = event.clientX; var ina = event.clientY; if(ena == hna && fna == ina) { return; } ena = hna; fna = ina; } if(Cga == null) { if($g_bMouseSpeech && (pga || hga) && !qba) { hra(event); } else if(Wda) { Rra(event); } else if(((Eca & calculator_icon) == calculator_icon) && MPb() && (pga || hga)) { if(wna(event)) { hra(event, true); } } Dga = false; return true; } var eEb = Yma(event); if (eEb.x < 0 || eEb.y < 0 || eEb.x > rw_getDocumentDisplayWidth() || eEb.y > rw_getDocumentDisplayHeight()) { Coa(event); return false; } var kna; var lna; var mna = false; var nna = 1.0; if(hga && !fga && mga) { var a1 = document.body.offsetWidth; var a2 = document.documentElement.offsetWidth; nna = (a1 / a2); if(nna > 1.05 || nna < 99.5) { mna = true; } } if(mna) { var qna = (nna * Aga.x) - (Bga.x); var rna = (nna * Aga.y) - (Bga.y); kna = (((nna * eEb.x) - qna)) / nna; lna = (((nna * eEb.y) - rna)) / nna; } else { var qna = Aga.x - (Bga.x); var rna = Aga.y - (Bga.y); kna = (eEb.x - qna); lna = (eEb.y - rna); } if(Cga.id =='rwDragMe') { Vma(kna, lna); if ((kna + Lga + Ega) > rw_getDocumentDisplayWidthAdjusted()) { kna = rw_getDocumentDisplayWidthAdjusted() - Lga - Ega; Iga = 1.0; } if (kna < Ega) { kna = Ega; Iga = 0.0; } if ((lna + Mga + Ega) > rw_getDocumentDisplayHeightAdjusted()) { lna = rw_getDisplayHeightAdjusted() - Mga - Ega; Jga = 1.0; } if (lna < Ega) { lna = Ega; Jga = 0.0; } Jma(); Coa(event); } else if(Cga.id =='rwDragMeTrans'|| Cga.id =='rwDragMeFF'|| Cga.id =='rwDragMeDict'|| Cga.id =='rwDragMeDisplay'|| Cga.id =='rwDragMeCollect'|| Cga.id =='rwDragMeStickyNoteTop'|| Cga.id =='rwDragMeStickyNoteBot'|| Cga.id =='rwDragMePronCreate'|| Cga.id =='rwDragMePronEdit'|| Cga.id =='rwDragMeCal'|| Cga.id =='rwDragMeGencache'|| Cga.id =='rwDragMeCheckcache'|| Cga.id =='rwDragMePictureDictionary') { var tna; if(Cga.id =='rwDragMeDisplay') { tna = Sga; } else if(Cga.id =='rwDragMeTrans') { tna = Tga; } else if(Cga.id =='rwDragMeFF') { tna = Uga; } else if(Cga.id =='rwDragMeDict') { tna = Vga; } else if(Cga.id =='rwDragMeStickyNoteTop') { tna = Xga; } else if(Cga.id =='rwDragMeStickyNoteBot') { tna = Xga; } else if(Cga.id =='rwDragMePronCreate') { tna = Yga; } else if(Cga.id =='rwDragMePronEdit') { tna = Zga; } else if(Cga.id =='rwDragMeCal') { tna = aga; } else if(Cga.id =='rwDragMeGencache') { tna = bga; } else if(Cga.id =='rwDragMeCache') { tna = cga; } else if(Cga.id =='rwDragMePictureDictionary') { tna = dga; } else { tna = Wga; } Wma(tna, kna, lna); if ((kna + Pga[tna] + Ega) > rw_getDocumentDisplayWidthAdjusted()) { kna = rw_getDocumentDisplayWidthAdjusted() - Pga[tna] - Ega; Nga[tna] = 1.0; } if (kna < Ega) { kna = Ega; Nga[tna] = 0.0; } if ((lna + Qga[tna] + Ega) > rw_getDocumentDisplayHeightAdjusted()) { lna = rw_getDocumentDisplayHeightAdjusted() - Qga[tna] - Ega; Oga[tna] = 1.0; } if (lna < Ega) { lna = Ega; Oga[tna] = 0.0; } Rma(tna); Coa(event); } return false;}function wna(event){ var target; if(pga) { target = event.explicitOriginalTarget; } else if(hga) { target = event.srcElement; } else { target = event.target; } if(target != null && target.nodeType == 1) { var una = target.ownerDocument.body; if(target != una) { var Sra = target.parentNode; if(typeof(Sra.tagName)=="string") { while(Sra != null && Sra != una) { var QLb = Sra.tagName.toLowerCase(); if(QLb =="form") { if(Sra.id =="rw_CalForm") { return true; } } Sra = Sra.parentNode; } } } } return false;}function zna(event){ if(!baa) { return; } if(yga != null) { if(xga) { xga = false; return; } else { if(wga) { var flash = IGb(uga); if(typeof(flash) !="undefined"&& flash != null) { try { flash.lostFocus(); } catch(err) { pJb(err); } } qma(false); } } } if (!Dga) { return true; } if (Cga.releaseCapture) {Cga.releaseCapture(); } Cga = null; Dga = false; Coa(event); return false;}function Boa(event){ if(!baa) { return; } if (Dga) { if (!hga && !oga) { var eEb = Yma(event); if (eEb.x < 5 || eEb.y < 5 || eEb.x > (rw_getDocumentDisplayWidth() - 5) || eEb.y > (rw_getDocumentDisplayHeight() - 5)) { zna(event); Coa(event); return; } } sna(event); Coa(event); } else { if(!qba) { Dra = null; } }}function Coa(event){ if (event == null) { return; } if (event.cancelBubble) { event.cancelBubble = true; } else if (event.stopPropagation) { event.stopPropagation(); } if (event.returnValue) { event.returnValue = false; } else if (event.preventDefault) { event.preventDefault(true); }}function Doa(sPb){ if(Gga > 0) { --Gga; return; } if (Dga) { return; } if($rw_blockClick(sPb)) { return; } for (var i = 0; i < xfa; i++) { if (sPb == g_icons[i][0]) { if(oga) { document.images[g_icons[i][0]].src = g_icons[i][2].src; } else { Nia(g_icons[i][0],"hover", false); } } } for (var i = 0; i < yfa; i++) { if (sPb == wfa[i][0]) { if(oga) { document.images[wfa[i][0]].src = wfa[i][2].src; } else { Nia(wfa[i][0],"hover", true); } } }}function Foa(sPb){ if(Gga > 0) { --Gga; return; } if(Dga) { return; } if($rw_blockClick(sPb)) { return; } for (var i = 0; i < xfa; i++) { if (sPb == g_icons[i][0]) { if(oga) { document.images[g_icons[i][0]].src = g_icons[i][1].src; } else { Nia(g_icons[i][0],"flat", false); } } } for (var i = 0; i < yfa; i++) { if (sPb == wfa[i][0]) { if(oga) { document.images[wfa[i][0]].src = wfa[i][1].src; } else { Nia(wfa[i][0],"flat", true); } } }}function Hoa(sPb){ if(Gga > 0) { --Gga; return; } if (Dga) { return; } if($rw_blockClick(sPb)) { return; } for (var i = 0; i < xfa; i++) { if (sPb == g_icons[i][0]) { if(oga) { document.images[g_icons[i][0]].src = g_icons[i][3].src; } else { Nia(g_icons[i][0],"toggle", false); } } } for (var i = 0; i < yfa; i++) { if (sPb == wfa[i][0]) { if(oga) { document.images[wfa[i][0]].src = wfa[i][3].src; } else { Nia(wfa[i][0],"toggle", true); } } }}function $rw_blockClick(sPb){ if (dma && fma.indexOf(sPb) > -1) { return true; } if(wga && gma.indexOf(sPb) > -1) { return true; } if(!wga && hma.indexOf(sPb) > -1) { return true; } return false;}var Joa ="rw_speechenablingdata";function Loa(event){ if(Kga && !(Jda && (iga || jga)) ) { var Koa = RIb("rwebooks-x"); var Moa = RIb("rwebooks-y"); if ((Koa != null) && (Moa != null)) { Iga = parseFloat(Koa); Jga = parseFloat(Moa); } } var Noa = false; var tZb = Nga.length; var Poa; var Qoa; if(Kga && !(Jda && (iga || jga)) ) { for(var i=0; i<tZb; i++) { Poa = RIb("rwebooks-div"+ i +"x"); if(Poa != null) { Nga[i] = parseFloat(Poa); } Qoa = RIb("rwebooks-div"+ i +"y"); if(Qoa != null) { Oga[i] = parseFloat(Qoa); } if(i == Xga) { if(Poa == null && Qoa == null) { Noa = true; } } } } else { Noa= true; } if(Noa) { Nga[Xga] = 0.45; Oga[Xga] = 0.35; } Jma(); Nma(); $rw_pageSetup(); if(sca) { if(uca !="*"&& typeof(mWb) !="undefined") { mWb(); } else { if(tca !="*"&& typeof(Aab) !="undefined") { Aab(); } } } if(hga) { var Roa = document.createTextNode(" "); var Soa = document.body.appendChild(Roa); } if(dca && hca) { $rw_cachePage(null, null); } try { if(typeof(g_icons) !="undefined"&& typeof(g_icons[0]) !="undefined"&& typeof(g_icons[0][0]) !="undefined"&& g_icons[0][0] != null) { var Toa = document.images[g_icons[0][0] +"flat"].style; Toa.visibility ="\x68\x69dden"; Toa.visibility ="\x76\x69sible"; } } catch(err) { pJb(err); } if(pca) { var Uoa = RIb(Joa); if(Uoa != null && Uoa.length > 0) { var n1 = Uoa.indexOf("~"); var n2 = Uoa.indexOf("~", n1 + 1); var n3 = Uoa.indexOf("~", n2 + 1); var n4 = Uoa.indexOf("~", n3 + 1); var n5 = Uoa.indexOf("~", n4 + 1); var n6 = Uoa.indexOf("~", n5 + 1); var n7 = Uoa.indexOf("~", n6 + 1); var n8 = Uoa.indexOf("~", n7 + 1); var n9 = Uoa.indexOf("~", n8 + 1); var ata = Uoa.substring(n1 + 1, n2); var Woa = Uoa.substring(n3 + 1, n4); var Xoa = Uoa.substring(n5 + 1, n6); var Yoa = Uoa.substring(n7 + 1, n8); var hoa = Uoa.substring(n9 + 1); $rw_setVoice(ata); try { $rw_setSpeedValue(parseInt(Woa)); } catch(e){} $rw_setSpeechRangeColours(Xoa); $rw_setSpeechWordColours(Yoa); try { $rw_setPlayMode(parseInt(hoa)); } catch(e){} try { var aoa = $rw_getPlayMode(); if(aoa == CLICK_SPEAK || aoa == HOVER_SPEAK || aoa == BUBBLE_SPEAK) { if(typeof(closeAndDisable) =="function") { if(document.getElementById("speechMenu").style == null || !(document.getElementById("speechMenu").style.display =='block')) { closeAndDisable('speechMenu'); } } } } catch(e) { } } } if(Wda) { if(Eda) { var boa = document.createElement("\x64\x69v"); boa.id = kja; boa.style.zIndex ="998"; boa.style.position ="\x61bsol\x75t\x65"; boa.style.display ="n\x6fne"; if(hga) { boa.style.cursor ="hand"; } else { boa.style.cursor ="pointer"; } Fma(boa,'click', sja); var coa = document.createElement("img"); coa.setAttribute("src", $g_strFileLoc +"rwimgs/start_speak_popup.gif"); boa.appendChild(coa); document.body.appendChild(boa); var doa = document.createElement("\x64\x69v"); doa.id = lja; doa.style.zIndex ="999"; doa.style.position ="\x61bso\x6cut\x65"; doa.style.display ="n\x6fne"; if(hga) { doa.style.cursor ="hand"; } else { doa.style.cursor ="pointer"; } Fma(doa,'click', tja); var eoa = document.createElement("img"); eoa.setAttribute("src", $g_strFileLoc +"rwimgs/stop_speak_popup.gif"); doa.appendChild(eoa); document.body.appendChild(doa); } if(Yda) { Wda = false; } } if(pda) { setTimeout ('$rw_event_generate_cache()',1000); } if(qda) { setTimeout ('$rw_event_check_cache()',1000); } baa = true;}function foa(event){ window.onunload=null; if(typeof(VZb) !='undefined'&& sca && typeof(LYb) !='undefined'&& LYb > -1) { CZb(LYb); } if(!Fga && lba && !ls_teacherFlag) { event.returnValue ="Your data will be lost if you click OK!"; } if(Kga && !(Jda && (iga || jga)) ) { XIb("rwebooks-x", Iga, 20,"/", window.location.host); XIb("rwebooks-y", Jga, 20,"/", window.location.host); var tZb = Nga.length; for(var i=0; i<tZb; i++) { XIb("rwebooks-div"+ i +"x", Nga[i], 20,"/", window.location.host); XIb("rwebooks-div"+ i +"y", Oga[i], 20,"/", window.location.host); } } if(pca) { var hoa =""+ $rw_getPlayMode(); var ioa ="voice~"+ Nca +"~speed~"+ Zca +"~colourrange~"+ vba +"~colourword~"+ wba +"~mode~"+ hoa; XIb(Joa, ioa, 20,"/", window.location.host); } if(!Fga && lba && !ls_teacherFlag) { return"Your data will be lost if you click OK!"; } else { }} var joa = -10;function THCaret(oYb, NWb, MWb){ this.node = oYb; this.offset = NWb; this.forwardBias = MWb; if(fta(this.node)) { this.offset = joa; }};THCaret.prototype.isSpecialCase = function(){ return (this.offset == joa);};THCaret.prototype.cia = function(){ var zsa = true; with (this) { if(node == null || node.parentNode == null) { zsa = false; } else { if( node.nodeType != 3) { if(node.nodeType == 1 && this.offset == joa) { } else { zsa = false; } } else if(this.offset < 0 || this.offset >node.nodeValue.length) { zsa = false; } } } return zsa;};THCaret.prototype.toString = function(){ var cYb ="THCaret "; if(this.node != null) { if(this.node.nodeType == 3) { cYb += this.node.nodeValue +" "+ this.node.parentNode.tagName +" "; } else if(this.node.nodeType == 1) { cYb += this.node.tagName +" "; } } cYb += this.offset; return cYb;};THCaret.prototype.equals = function(GWb){ if(GWb == null) { return false; } return this.node == GWb.node && this.offset == GWb.offset && this.forwardBias == GWb.forwardBias;};function qoa(Lua, Mua){ this.zVb = Lua; this.AWb = Mua;};qoa.prototype.equals = function(tFb){ if(tFb == null) { return false; } return this.zVb.equals(tFb.zVb) && this.AWb.equals(tFb.AWb);};qoa.prototype.toString = function(){ return rw_getTextOverCaretRange(this);};function THDomRefPt(FBb, NWb){ this.path = FBb; this.offset = NWb;};THDomRefPt.prototype.isSpecialCase = function(){ return (this.offset == joa);};THDomRefPt.prototype.toString = function(){ return"THDomRefPt "+ this.path +" "+ this.offset;};var xoa = -1;var yoa = 0;var zoa = 1;var Apa = 2;var Bpa = 3;var Cpa = 4;var Dpa = 5;var Epa = 6;var Fpa = 7;var Gpa = 8;function Hpa(ENb, Opa, GNb, Ppa){ this.body = ENb.ownerDocument.body; this.gWb = new THCaret(ENb, Opa, true); this.hWb = new THCaret(GNb, Ppa, false); this.rVb = npa(ENb, Opa); this.sVb = npa(GNb, Ppa);};Hpa.prototype.refresh = function(){ with (this) { if(gWb.cia() == false || hWb.cia() == false) { var fWb = UBb(this.body, this.rVb.path, this.rVb.offset, this.sVb.path, this.sVb.offset); var gWb = fWb.zVb; var hWb = fWb.AWb; if(gWb == null && hWb == null) { gWb = new THCaret(document.body, 0, true); hWb = new THCaret(document.body, 0, false); } else if(gWb == null || hWb == null) { if(gWb == null) { gWb = new THCaret(hWb.node, hWb.offset, true); } else { hWb = new THCaret(gWb.node, gWb.offset, false); } } } }};Hpa.prototype.toString = function(){ this.refresh(); var range = dJb(this.body); range.setStart(this.gWb.node, this.gWb.offset); range.setEnd(this.hWb.node, this.hWb.offset); return range.toString();};Hpa.prototype.getStartAsRange = function(){ var range = dJb(this.body); range.setStart(this.gWb.node, this.gWb.offset); range.setEnd(this.gWb.node, this.gWb.offset); return range;};Hpa.prototype.getEndAsRange = function(){ var range = dJb(this.body); range.setStart(this.hWb.node, this.hWb.offset); range.setEnd(this.hWb.node, this.hWb.offset); return range;};Hpa.prototype.equals = function(YGb){ return (this.rVb.path == YGb.rVb.path && this.rVb.offset == YGb.rVb.offset && this.sVb.path == YGb.sVb.path && this.sVb.offset == YGb.sVb.offset);};Hpa.prototype.compareRange = function(YGb){ if(this.equals(YGb)) { return yoa; } this.refresh(); YGb.refresh(); var Tpa = this.getStartAsRange(); var Upa = this.getEndAsRange(); var Vpa = YGb.getStartAsRange(); var Wpa = YGb.getEndAsRange(); var Xpa = Tpa.compareBoundaryPoints("START_TO_START", Vpa); var Ypa = Tpa.compareBoundaryPoints("START_TO_START", Wpa); var Zpa = Upa.compareBoundaryPoints("START_TO_START", Vpa); var apa = Upa.compareBoundaryPoints("START_TO_START", Wpa); var cUb = xoa; if(Ypa > -1) { cUb = zoa; } else if(Zpa < 1) { cUb = Apa; } else if(Xpa == -1) { if(apa == -1) { cUb = Epa; } else { cUb = Bpa; } } else if(Xpa == 0) { if(apa == -1) { cUb = Fpa; } else if(apa == 0) { cUb = yoa; } else { cUb = Bpa; } } else { if(apa == -1) { cUb = Cpa; } else if(apa == 0) { cUb = Gpa; } else { cUb = Dpa; } } return cUb;};function cpa(eJb, epa, fpa){ this.body = eJb; this.rVb = epa; this.sVb = fpa;};cpa.prototype.equals = function(YGb){ return (this.rVb.path == YGb.rVb.path && this.rVb.offset == YGb.rVb.offset && this.sVb.path == YGb.sVb.path && this.sVb.offset == YGb.sVb.offset);};cpa.prototype.toString = function(){ with (this) { if(hga) { var range = getAsRange(); if(range != null) { return getAsRange().text; } else { return""; } } else { var range = getAsRange(); if(range != null) { return getAsRange().toString(); } else { return""; } } }};cpa.prototype.getAsRange = function(){ with (this) { var range = null; if(hga) { range = rw_getAsTextRange(this.body, this.rVb.path, this.rVb.offset, this.sVb.path, this.sVb.offset); } else { range = dJb(this.body); var fWb = UBb(this.body, this.rVb.path, this.rVb.offset, this.sVb.path, this.sVb.offset); var gWb = fWb.zVb; var hWb = fWb.AWb; if(gWb != null && hWb != null) { range.setStart(gWb.node, gWb.offset); range.setEnd(hWb.node, hWb.offset); } else { range = null; oJb("Failed to get the start or end caret."); } } return range; }};function npa(oYb, NWb){ try { if(oYb == null) { return null; } if(oYb.nodeType == 1) { var kZb = sta(oYb); if(kZb != null) { return new THDomRefPt(XAb(kZb), NWb); } var Kab = 0; var LZb = oYb; var yMb = LZb.getAttribute("rwstate"); var wpa = LZb.getAttribute(faa); while(LZb.tagName.toLowerCase() =="font"|| (yMb != null && yMb.length > 0) || wpa!= null ) { Kab += Cqa(LZb); LZb = LZb.parentNode; yMb = LZb.getAttribute("rwstate"); wpa = LZb.getAttribute(faa); } if(NWb == -1) { Kab = -1; } return new THDomRefPt(XAb(LZb), Kab + NWb); } else if(oYb.nodeType == 3) { var kZb = sta(oYb); if(kZb != null) { return new THDomRefPt(XAb(kZb), NWb); } if(oYb.nodeValue.trimTH().length == 0) { NWb = 0; } var Kab = Cqa(oYb); var LZb = oYb.parentNode; var yMb = LZb.getAttribute("rwstate"); var wpa = LZb.getAttribute(faa); while(LZb.tagName.toLowerCase() =="font"|| (yMb != null && yMb.length > 0) || wpa!= null ) { Kab += Cqa(LZb); LZb = LZb.parentNode; yMb = LZb.getAttribute("rwstate"); wpa = LZb.getAttribute(faa); } if(NWb == -1) { Kab = -1; } return new THDomRefPt(XAb(LZb), Kab + NWb); } else { return null; } } catch(ignore) { return null; }};function Cqa(oYb){ if(oYb == null) { return 0; } var Kab = 0; var xKb = oYb.previousSibling; if(xKb != null) { Kab = Eqa(xKb); } return Kab;};function Eqa(oYb){ var Kab = 0; var xKb = oYb; var FJb; while(xKb != null) { if(xKb.nodeType ==3) { FJb = xKb.nodeValue; Kab += FJb.length; } else if(xKb.nodeType == 1) { if(!Gza(xKb)) { if(fta(xKb)) { Kab += 1; } else if(xKb.tagName.toLowerCase() !="textarea") { Kab += Eqa(xKb.lastChild); } else { Kab += 1; } } } xKb = xKb.previousSibling; } return Kab;};function THHoverTarget(eJb, FBb, Lqa){ this.body = eJb; this.path = FBb; this.range = Lqa; this.hRb = null; this.blockCache = false; this.textToSpeak = null; this.textToSpeakNoChanges = null; this.allowContinuous = true; this.isRange = function() { return this.range != null; }; this.getCaretRange = function() { var fWb; if(this.isRange()) { fWb = UBb(this.range.body, this.range.rVb.path, this.range.rVb.offset, this.range.sVb.path, this.range.sVb.offset); } else { var caret = ABb(this.body, this.path, -1, true); fWb = new qoa(caret, caret); } return fWb; };this.getTextPreparedForSpeech = function() { var cYb; if(this.isRange()) { this.hRb = new Array(); var Vqa = Lta(this.range.body, this.range.rVb, this.range.sVb, this.hRb); eOb(Vqa.voice); if(Vqa.fWb != null) { var Wqa = Vqa.fWb; this.range = qFb(Wqa); } cYb = Vqa.cYb; } else { var caret = ABb(this.body, this.path, -1, true); if(caret != null && caret.node != null) { var Qqa = cqa(caret.node); if(Qqa.trimTH().length == 0) { return""; } else { if(Wca) { eOb(KOb(caret.node)); } var bsa = Qqa; if(SpeechStream.pronunciation.checkPronunciation()) { bsa = fRb(bsa); } cYb = zqa +"0"+ Cra + bsa + zqa +"1"+ Cra; } } else { cYb =""; } } if(Wca && cYb.length > 0) { var aqa; if(Xca!= null) { aqa = Xca; } else { Xca = Nca; } if(Xca =="\x53canSoft\x20\x45mily_\x46ul\x6c_\x32\x32kHz"|| Xca =="\x53canS\x6fft\x20D\x61niel_\x46ull_2\x32kHz"|| Xca =="\x53\x63\x61nSoft\x20Jill_F\x75ll_22\x6bHz"|| Xca =="\x53canSoft\x20Tom_Fu\x6cl_2\x32\x6b\x48z"|| Xca =="\x56\x57\x20Kate"|| Xca =="\x56\x57\x20Paul") { cYb ="<volume level=\"75\"/>"+ cYb; } } return cYb; };this.prepareTextForSpeech = function() { var cYb; var cta; if(this.isRange()) { this.hRb = new Array(); var Vqa = Lta(this.range.body, this.range.rVb, this.range.sVb, this.hRb); eOb(Vqa.voice); if(Vqa.fWb != null) { var Wqa = Vqa.fWb; this.range = qFb(Wqa); } cYb = Vqa.cYb; cta = Vqa.cta; } else { var caret = ABb(this.body, this.path, -1, true); if(caret != null && caret.node != null) { var Yqa = cqa(caret.node); if(Yqa.trimTH().length == 0) { cYb =""; cta =""; } else { if(Wca) { eOb(KOb(caret.node)); } var bsa; if(SpeechStream.pronunciation.checkPronunciation()) { bsa = fRb(Yqa); } else { bsa = Yqa; } cYb = zqa +"0"+ Cra + bsa + zqa +"1"+ Cra; cta = zqa +"0"+ Cra + Yqa + zqa +"1"+ Cra; } } else { cYb =""; cta =""; } } if(Wca && cYb.length > 0) { var aqa; if(Xca!= null) { aqa = Xca; } else { Xca = Nca; } if(Xca =="\x53canSoft\x20Emily_\x46\x75l\x6c_22\x6bHz"|| Xca =="\x53\x63an\x53o\x66t\x20Daniel_\x46ull_2\x32kH\x7a"|| Xca =="\x53canSoft\x20Jill_F\x75ll_2\x32k\x48z"|| Xca =="\x53canSoft\x20Tom_Fu\x6cl_\x322kHz"|| Xca =="\x56W\x20Kate"|| Xca =="\x56\x57\x20Paul") { cYb ="<volume level=\"75\"/>"+ cYb; } } this.textToSpeak = cYb; this.textToSpeakNoChanges = cta; }; function cqa(oYb) { var cYb =""; try { if(oYb.nodeType == 1) { if(oYb.getAttribute("ignore") == null) { var tagName = oYb.tagName.toLowerCase(); if(tagName =="input") { var TLb = oYb.getAttribute("type"); if(TLb != null) { TLb = TLb.toLowerCase(); if(TLb.length == 0 || TLb =="text") { cYb = oYb.value; } else if(TLb =="password") { cYb =""; } else if(TLb =="image") { var Tra = oYb.getAttribute("alt"); if(Tra != null && Tra.length > 0) { cYb = Tra; } else { cYb =""; } } else if(TLb =="button"|| TLb =="submit"|| TLb =="reset") { if(oYb.className =="rwcalbutton"|| oYb.className =="rwcalEqbutton") { cYb = oYb.getAttribute("name"); } else { cYb = oYb.getAttribute("value"); } } } else { cYb = oYb.value; } } else if(tagName =="select") { var WLb = oYb.selectedIndex; var XLb =""; var tZb = oYb.options.length; for( var HVb = 0; HVb < tZb; HVb++) { XLb += oYb.options[HVb].text +" "; } if(tZb > 0) { if(WLb > -1) { cYb = oYb.options[WLb].text +" selected from the list "+ XLb; } else { cYb ="No selection from list "+ XLb; } } } else if(tagName =="textarea"|| tagName =="option") { cYb = oYb.value; } else if(tagName =="img") { var kqa = oYb.getAttribute("title"); if(kqa != null && kqa.length > 0) { cYb = kqa; } else { var Tra = oYb.getAttribute("alt"); if(Tra != null && Tra.length > 0) { cYb = Tra; } else { var Ura = oYb.getAttribute("msg"); if(Ura != null && Ura.length > 0) { cYb = Ura; } } } } else if(tagName =="math") { var dCb = aCb(oYb); if(dCb.length > 0) { cYb = Tra; } } else { var Tra = oYb.getAttribute("alt"); if(Tra != null && Tra.length > 0) { cYb = Tra; } else { var Ura = oYb.getAttribute("msg"); if(Ura != null && Ura.length > 0) { cYb = Ura; } } } } } } catch(ignore) { cYb =""; } return cYb; }; this.highlightRange = function() { try { if(this.range != null) { var fWb = UBb(this.range.body, this.range.rVb.path, this.range.rVb.offset, this.range.sVb.path, this.range.sVb.offset); var zVb = fWb.zVb; var AWb = fWb.AWb; if(zVb != null && AWb != null) { rw_setSpeechRangeImpl(zVb.node, zVb.offset, AWb.node, AWb.offset,"sp"); } else { } } } catch(err) { oJb("err THHoverTargetClass:highlightRange: "+ err.message); } }; this.unhighlightRange = function() { try { if(this.range != null) { var fWb = UBb(this.range.body, this.range.rVb.path, this.range.rVb.offset, this.range.sVb.path, this.range.sVb.offset); var zVb = fWb.zVb; var AWb = fWb.AWb; if(zVb != null && AWb != null) { rw_removeSpeechHighlight(MMb(zVb, AWb), false); } else { } } } catch(err) { oJb("failed to do unhighlightRange:"+err.message); } }; this.equals = function(Msa) { if(Msa == null) { return false; } if(this.isRange() != Msa.isRange()) { return false; } if(this.isRange()) { return this.range.equals(Msa.range); } else { return this.path.equalsTH(Msa.path); } }; this.toString = function() { var cYb ="THHoverTarget "; if(this.path != null) { cYb+="path="+ this.path; } else if(this.range != null) { cYb+= this.range.toString(); } return cYb; };};function Ara(oYb){ if(eca || dca) { var sYb = kJb(oYb); var BWb = oYb; if(BWb.nodeType == 3) { BWb = BWb.parentNode; } while(BWb != null && BWb != sYb) { if(BWb.getAttribute(eaa) != null) { return true; } BWb = BWb.parentNode; } } return false;}var zqa ='<bookmark mark="';var Cra ='"/>';var Dra = null; var Era = null; var Fra = 0;var Gra = 0;var Hra = false;var Ira = false;var Jra = false;if(oga){ var Kra = navigator.appVersion; var Lra = Kra.lastIndexOf("/"); Kra = Kra.substring(Lra + 1); try { var Mra = parseFloat(Kra); if(Mra < 300 || (Mra > 400 && Mra < 416)) { Hra = true; } else if(Mra > 500) { Jra = true; } else { Ira = true; } } catch(err) { Jra = true; }}function Rra(evt){ if(Xda && evt.shiftKey || !baa) { return; } var Nra = false; var gra = nra(evt, false); if(gra != null && gra.node != document.body) { if(gra.node.nodeType == 1) { var aYb = gra.node; var pYb = aYb.tagName.toLowerCase(); if(pYb =="img") { var Sra = aYb.parentNode; if(Sra.tagName.toLowerCase() =="div") { if(aYb.id == kja || aYb.id == lja) { return; } } var Tra = aYb.getAttribute("alt"); if(Tra == null || Tra.length == 0) { var Ura = aYb.getAttribute("msg"); if(Ura == null || Ura.length == 0) { return; } } Nra = true; } else { return; } } var xra = Dsa(gra); if(xra != null) { if(Nra) { var cra = ama(gra.node); pja(cra.x, cra.y, xra); } else { var lOb = xra.getCaretRange(); if(DLb(lOb)) { var start = lOb.zVb.node; if(xra.isRange()) { var end = lOb.AWb.node; start = dya(start); end = iya(end); var rVb = npa(start, 0); var sVb; if(end.nodeType == 1) { sVb = npa(end, 0); } else { sVb = npa(end, end.nodeValue.length); } xra.range = new cpa(document.body, rVb, sVb); } var cra = ama(start); pja(cra.x, cra.y, xra); } else { } } } }}var dra = 0;var era = 0;function hra(evt, Nsa){ try { var d = new Date(); var wab = d.getTime(); if(wab < (era + 800) || !baa) { return; } var gra = nra(evt, qba); if(gra != null) { if(hda) { if(gra.node.nodeType == 1 && gra.node.tagName.toLowerCase() =="input") { var TZb = gra.node.getAttribute("type"); if(TZb != null) { TZb = TZb.toLowerCase(); if((TZb =="radio"|| TZb =="checkbox")) { gra.node = Jxa(gra.node, true, null); gra.offset = 0; } } } } var xra = Dsa(gra); if(xra != null) { try { if(xra.equals(Dra)) { return; } if(xra.equals(Era)) { if((wab - dra) < 1000) { return; } dra = wab; } Dra = xra; if(typeof(Nsa) =="boolean"&& Nsa) { Lsa(Dra, true); } else { Lsa(Dra, false); } }catch(err){pJb(err);} } else { Dra = null; } } } catch(err) { oJb("mousehover error:"+ err.message); }};function nra(ora, aEb){ var QAb = null; var RAb = 0; if(hga) { QAb = ora.srcElement; if(QAb.nodeType == 1 && QAb.tagName.toLowerCase() =="textarea") { } else { var Lab = rw_getTargetNodeAsCaretIE(ora, aEb); if(Lab != null) { QAb = Lab.node; RAb = Lab.offset; } else { var rra = false; if(QAb.tagName.toLowerCase() =="li"|| QAb.tagName.toLowerCase() =="a") { rra = true; } else if(QAb.parentNode != null && QAb.parentNode.tagName != null && QAb.parentNode.tagName.toLowerCase() =="li") { rra =true; } if(rra) { var BWb = QAb.firstChild; if(BWb == null) { return null; } if(BWb.nodeType != 3) { BWb = Jxa(BWb, false, QAb); if(BWb == null) { return null; } } QAb = BWb; RAb = 0; } } } } else if(oga) { QAb = ora.target; if(QAb != null) { if(Jra) { if(QAb.firstChild != null && QAb.firstChild.nodeType == 3 && QAb.tagName.toLowerCase() !="textarea") { var UAb = QAb.firstChild.nodeValue; if(UAb.trimTH().length > 0) { QAb = QAb.firstChild; } } } else if(Ira) { if(ora.fromElement != null) { if(QAb.nodeType == 1 && QAb.tagName.toLowerCase() !="textarea") { if(ora.fromElement.nodeType == 3) { QAb = ora.fromElement; } } } else { if(QAb.firstChild != null && QAb.firstChild.nodeType == 3 && QAb.tagName.toLowerCase() !="textarea") { var UAb = QAb.firstChild.nodeValue; if(UAb.trimTH().length > 0) { QAb = QAb.firstChild; } } } } } } else { if(ora.explicitOriginalTarget.nodeValue != null) { if(ora.target.tagName.toLowerCase() =="textarea") { QAb = ora.target; } else { QAb = ora.explicitOriginalTarget; } } else { QAb = ora.target; } } if(QAb == null) { return null; } return new THCaret(QAb, RAb, true);}function Dsa(Esa){ var vra = false; var QAb = Esa.node; var xra = null; if(Ara(QAb)) { if(Ica == null) { return xra; } else { vra = true; } } if(QAb != null && QAb.parentNode != null && QAb.parentNode.getAttribute) { var QLb; var zra; var Asa; var Bsa; var Csa; if(QAb.nodeType == 1) { QLb = QAb.tagName; if(cca && QLb.toUpperCase() =="INPUT") { var TZb = QAb.getAttribute("type"); var Gsa = QAb.className; if(TZb != null && TZb =="button"&& Gsa !="rwcalbutton"&& Gsa !="rwcalEqbutton") { return xra; } } zra = QAb.getAttribute("started"); Asa = QAb.getAttribute("ignore"); Bsa = QAb.getAttribute("sp"); Csa = QAb.getAttribute("csp"); if(Csa != null || Asa != null || Bsa != null || zra != null) { return xra; } } var Hsa = QAb.parentNode; zra = Hsa.getAttribute("started"); Asa = Hsa.getAttribute("ignore"); Bsa = Hsa.getAttribute("sp"); Csa = Hsa.getAttribute("csp"); if(Csa != null || Asa != null || Bsa != null || zra != null) { xra = null; } else { var zVb; var AWb; if(QAb.nodeType == 3) { var Lab = Esa; try { if(!hga && Lab.node.nodeValue.length > 0) { Lab.offset = 0; zVb = wva(Lab); Lab.offset = Lab.node.nodeValue.length - 1; AWb = Kwa(Lab); } else { zVb = wva(Lab); AWb = Kwa(Lab); } if(zVb != null && AWb != null) { var range = new cpa(kJb(Hsa), npa(zVb.node, zVb.offset), npa(AWb.node, AWb.offset)); xra = new THHoverTarget(null, null, range); xra.blockCache = vra; } } catch(err){pJb(err);} } else if(QAb.nodeType == 1) { if(QAb.tagName.toLowerCase() =="img"&& QAb.getAttribute("msg") != null) { zVb = wva(Esa); AWb = Kwa(Esa); if(zVb != null && AWb != null) { var range = new cpa(kJb(Hsa), npa(zVb.node, zVb.offset), npa(AWb.node, AWb.offset)); xra = new THHoverTarget(null, null, range); } else { xra = new THHoverTarget(kJb(QAb), XAb(QAb), null); } xra.blockCache = vra; } else { xra = new THHoverTarget(kJb(QAb), XAb(QAb), null); xra.blockCache = vra; xra.allowContinuous = false; } } else { xra = null; } } } return xra;}function Lsa(Msa, Nsa){ if(qba && !Nsa) { $rw_event_stop_limited(); Fra = setTimeout("rw_doHoverStep2()", 500); } else { Fra = setTimeout("rw_doHoverStep1()", 500); }};function rw_doHoverStep1(){ if($g_bMouseSpeech || ((Eca & calculator_icon) == calculator_icon)) { Fra = 0; if (Dra != null) { var cYb; if(Dra instanceof String) { cYb = Dra.toString(); } else { if(Dra.isRange()) { if(DLb(Dra.getCaretRange())) { cYb =" "; } else { cYb = null; } } else { cYb = Dra.getTextPreparedForSpeech(); } } if(cYb == null || cYb.length == 0) { return; } } if(Fra > 0) { clearTimeout(Fra); Fra = 0; } if(Gra > 0) { clearTimeout(Gra); Gra = 0; } $rw_event_stop_limited(); Gra = setTimeout("rw_doHoverStep2()", 500); }};var Qsa = false;function rw_doHoverStep2(){ try { Qsa = true; Fra = 0; if (Dra != null) { if(Era!= null) { Gra = setTimeout("rw_doHoverStep2()", 500); } else { var d = new Date(); era = d.getTime(); if(Dra.range != null) { Bea = Dra; } rw_speakHoverTarget(Dra); Dra = null; } } } catch(ignore) { pJb(ignore); } Qsa = false;};var Ssa = new Array();var Tsa = (new Date).getTime();var Usa = 0;var Vsa = 500;function Wsa(){ if((new Date).getTime() - Tsa < Vsa) { return true; } return false;}function rw_targetQueueTimer(){ if(Wsa()) { Usa = setTimeout("rw_targetQueueTimer();", 100); } else { Usa = 0; if(Ssa.length > 1) { var TLb = Ssa[Ssa.length - 2]; var target = Ssa[Ssa.length - 1]; Ssa.length = 0; if(TLb =="rw_speakHoverTarget") { rw_speakHoverTarget(target); } else if(TLb =="rw_speechHighlightOnly") { rw_speechHighlightOnly(target); } else { rsa(target, TLb); } } }}function rw_speakHoverTarget(YGb){ try { if(YGb == null) { return; } if(Wsa()) { Ssa.push("rw_speakHoverTarget"); Ssa.push(YGb); if(Usa == 0) { Usa = setTimeout("rw_targetQueueTimer();", 100); } return; } Tsa = (new Date).getTime(); if(Era != null) { Era.unhighlightRange(); } if(YGb instanceof String) { Era = null; var bsa = YGb.toString(); var dGb = bsa; if(SpeechStream.pronunciation.checkPronunciation()) { bsa = fRb(bsa); } fGb(bsa, false, dGb); } else { if(YGb.range && YGb.range instanceof cpa) { var kOb = CGb(YGb.range); if(kOb != null && Ara(kOb.zVb.node)) { if(Ica == null) { return; } else { YGb.blockCache = true; } } } Era = YGb; YGb.prepareTextForSpeech(); var cYb = YGb.textToSpeak; if(cYb != null && cYb.length > 0) { $rw_setSentenceFromSelection(); YGb.highlightRange(); var cta = YGb.textToSpeakNoChanges; fGb(cYb, YGb.blockCache, cta); if(Tda && YGb.allowContinuous) { if(YGb.equals(gda)) { gda = null; if(fda) { jHb.push("rw_pageCompleteCallBack()"); } } else { ksa(YGb, YGb.blockCache); } } } } } catch(err) { oJb("rw_speakHoverTarget error:"+err.message); }}function ksa(YGb){ var eSb = YGb.range; var fWb; var sYb; if(eSb != null) { sYb = eSb.body; fWb = UBb(sYb, eSb.rVb.path, eSb.rVb.offset, eSb.sVb.path, eSb.sVb.offset); } else if(YGb.body != null && YGb.path != null) { sYb = YGb.body; var jsa = new THCaret(iAb(sYb, YGb.path), 0, true); fWb = new qoa(jsa, jsa); } else { jHb.push("rw_pageCompleteCallBack()"); return; } var nsa = zxa(fWb); if(nsa == null) { yba = true; jHb.push("rw_pageCompleteCallBack()"); return; } while(!DLb(nsa)) { nsa = zxa(nsa); if(nsa == null) { yba = true; jHb.push("rw_pageCompleteCallBack()"); return; } } if(Bta(fWb.zVb.node, nsa.AWb.node)) { yba = true; jHb.push("rw_pageCompleteCallBack()"); return; } yba = false; if(Wda) { var ARb = dya(nsa.zVb.node); nsa.zVb.node = ARb; nsa.AWb.node = iya(nsa.AWb.node); nsa.zVb.offset = 0; if(nsa.AWb.node.nodeType == 1) { nsa.AWb.offset = 0; } else { nsa.AWb.offset = nsa.AWb.node.length; } } var psa = new cpa(sYb, npa(nsa.zVb.node, nsa.zVb.offset), npa(nsa.AWb.node, nsa.AWb.offset)); Uda= new THHoverTarget(null, null, psa); var cYb = Uda.getTextPreparedForSpeech(); if(cYb == null || cYb.length == 0) { yba = true; jHb.push("rw_pageCompleteCallBack()"); return; } jHb.push("setTimeout(\"$rw_readNextTarget();\", 50);");}function rsa(YGb, EHb){ if(YGb == null || EHb == null) { return; } if(Wsa()) { Ssa.push(EHb); Ssa.push(YGb); if(Usa == 0) { Usa = setTimeout("rw_targetQueueTimer();", 100); } return; } Tsa = (new Date).getTime(); if(Era != null) { Era.unhighlightRange(); } if(YGb instanceof String) { Era = null; try { var flash = cka(); if(flash != null) { jma(true); flash.startSpeechFromFile(YGb, EHb); oIb(); } } catch(err) { pJb(err); } } else { Era = YGb; var cYb = YGb.getTextPreparedForSpeech(); if(cYb != null && cYb.length > 0) { YGb.highlightRange(); BHb(cYb, EHb); } }}function rw_speechHighlightOnly(YGb){ if(YGb == null) { return; } if(Wsa()) { Ssa.push("rw_speechHighlightOnly"); Ssa.push(YGb); if(Usa == 0) { Usa = setTimeout("rw_targetQueueTimer();", 100); } return; } Tsa = (new Date).getTime(); if(Era != null) { Era.unhighlightRange(); } if(YGb instanceof String) { Era = null; } else { Era = YGb; var cYb = YGb.getTextPreparedForSpeech(); if(cYb != null && cYb.length > 0) { YGb.highlightRange(); GHb(cYb); } }}function $rw_readNextTarget(){ if(Uda != null) { Dra = Uda; Bea = Uda; Uda = null; rw_doHoverStep2(); }}function Bta(ENb, GNb){ if(ENb == null || GNb == null || ENb == GNb) { return false; } var zsa; var yKb=ENb; while(yKb != null && yKb != GNb) { if(yKb.nodeType == 1) { if(yKb.getAttribute("texthelpStopContinuous") != null) { return true; } } zsa = !Gza(yKb); if (yKb.firstChild != null && zsa) { yKb = yKb.firstChild; } else if(yKb.nextSibling != null) { yKb = yKb.nextSibling; } else { while (yKb != null && yKb.nextSibling == null) { yKb = yKb.parentNode; if(yKb != null && yKb.nodeType == 1) { if(yKb.getAttribute("texthelpStopContinuous") != null) { return true; } } if(GNb == yKb) { return false; } } if (yKb != null && GNb != yKb) { yKb = yKb.nextSibling; } } } return false;}function Fta(HTb, uKb){ this.range = HTb; this.word = uKb; };function Lta(eJb, eza, fza, Nua){ try { if(eza == null || fza == null) { return new JOb(); } var fWb = UBb(eJb, eza.path, eza.offset, fza.path, fza.offset); return Yta(fWb, Nua); } catch(err) { oJb("err rw_getTextOverRangeToSpeak:"+"|"+ err.message); return new JOb(); }};function Yta(ELb, Nua){ var Qta = new JOb(); try { if(ELb == null) { return Qta; } var zVb = ELb.zVb; var AWb = ELb.AWb; if(zVb == null) { return Qta; } if(AWb == null) { return Qta; } if(zVb.node != null) { var kZb = sta(zVb.node); if(kZb != null) { zVb.node = kZb; zVb.offset = 0; } } if(AWb.node != null && AWb.node.nodeType == 3) { var kZb = sta(AWb.node); if(kZb != null) { if(AWb.node.nodeType == 3) { AWb.offset = AWb.node.nodeValue.length; } AWb.node = kZb; } } var Vta = false; if(!Wca) { var BWb = zVb.node; var lZb; while(BWb != null) { if(BWb.nodeType == 1) { lZb = BWb.getAttribute("id"); if(lZb != null && lZb.length > 0) { if(lZb =="rwpopuptrans") { Vta = true; break; } else { if(lZb.indexOf("rwMeaning")!=0 && lZb.indexOf("rwHeadWord")!= 0) { break; } } } } BWb = BWb.parentNode; } } if(Wca || Vta) { var ata = KOb(zVb.node); if(ata != null) { Qta.voice = ata; } var bta = VOb(zVb.node, AWb.node, ata); if(bta != null) { Qta.fWb = new qoa(ELb.zVb, bta); AWb = bta; } } rw_getTextOverRangeToSpeakImpl(zVb, AWb, Nua); var cta =""; var tZb = Nua.length; if(tZb > 0) { var i = 0; for(i=0; i<tZb; i++) { cta += zqa + i + Cra + Aua(Nua[i].word); } cta += zqa + tZb + Cra; } Qta.cta = cta; if(SpeechStream.pronunciation.checkPronunciation()) { if(TRb(Nua)) { var cYb =""; tZb = Nua.length; if(tZb > 0) { i = 0; for(i=0; i<tZb; i++) { cYb += zqa + i + Cra + Aua(Nua[i].word); } cYb += zqa + tZb + Cra; } Qta.cYb = cYb; } else { Qta.cYb = cta; } } else { Qta.cYb = cta; } return Qta; } catch(err) { oJb("err rw_getTextOverRangeToSpeak:"+"|"+ err.message); return Qta; }};function fta(oYb){ if(oYb == null) { return false; } if(oYb.nodeType == 1) { var tagName = oYb.tagName.toLowerCase(); if(tagName =="span") { var yMb = oYb.getAttribute("pron"); if(yMb != null) { return true; } yMb = oYb.getAttribute("chunk"); if(yMb != null) { return true; } } else if(tagName =="acronym"|| tagName =="abbr") { var yMb = oYb.getAttribute("title"); if(yMb != null) { return true; } } else if(tagName =="chunk") { return true; } else if(tagName =="img") { var yMb = oYb.getAttribute("msg"); if(yMb != null) { return true; } } else if(tagName =="math") { var dCb = aCb(oYb); if(dCb.length > 0) { return true; } } if(oYb.getAttribute("ignore") != null) { return true; } } return false;};function lta(oYb){ if(oYb.nodeType == 1) { var tagName = oYb.tagName.toLowerCase(); if(tagName =="span") { var yMb = oYb.getAttribute("pron"); if(yMb != null) { return true; } } else if(tagName =="acronym"|| tagName =="abbr") { var yMb = oYb.getAttribute("title"); if(yMb != null) { return true; } } else if(tagName =="math") { var dCb = aCb(oYb); if(dCb.length > 0) { return true; } } } return false;};function sta(oYb){ if(oYb != null) { var sYb = kJb(oYb); var BWb = oYb; while(BWb != null && BWb != sYb) { if(fta(BWb)) { return BWb; } BWb = BWb.parentNode; } if(BWb == sYb) { if(BWb.getAttribute("ignore") != null) { return BWb; } } } return null;};var uta = 500;function wta(xta){ var Qua = xta.length; if(Qua > 1 && xta.substr(Qua - 2, 2) ==". ") { return xta; } else if(Qua > 0 && xta.substr(Qua - 1, 1) ==".") { return xta +" "; } else { var cYb = xta.trimEndTH(); var c = cYb.charCodeAt(cYb.length - 1); if(AKb(c) || c > 127) { return xta +". "; } else { return xta; } }}function Aua(uKb){ var Zab =""; if(uKb.indexOf("<math") > -1) { Zab = uKb; return Zab; } else { var tZb = uKb.length; var i = 0; var sKb; for(i = 0; i < tZb; i++) { sKb = uKb.charCodeAt(i); if(sKb > 127) { Zab += uKb.charAt(i); } else { switch(sKb) { case 35: case 40: case 41: case 91: case 93: case 95: case 123: case 124: case 125: Zab +=" "; break; case 96: Zab +="'"; break; case 38: Zab +="&amp;"; break; case 34: Zab +="&quot;"; break; case 60: Zab +="&lt;"; break; case 62: Zab +="&gt;"; break; default: Zab += uKb.charAt(i); } } } return Zab; }}function rw_getTextOverRangeToSpeakImpl(Lua, Mua, Nua){ try { var xKb = Lua.node; var yKb = Mua.node; var sYb = kJb(xKb); var Ewa = Lua.offset; var Owa = Mua.offset; var Jua =""; var SOb = xKb; var Pua = null; var Qua = 0; var zKb = true; var HVb = 0; var BFb = npa(SOb, Ewa); var CFb = null; while(SOb != null) { if(HVb > uta && uta > 0) { if(dca) { throw"Full selection will not be spoken due to its length."; } else { ILb("Full selection will not be spoken due to its length."); } return; } if(fta(SOb)) { if(Jua.length > 0) { if(tKb(Jua)) { Nua[HVb++] = new Fta(new cpa(sYb, BFb, CFb), Jua); } Jua =""; } var aua = Wza(SOb); if(aua.length > 0 && tKb(aua)) { if(lta(SOb)) { var Wua = eva(SOb, false); var UOb = iva(SOb, false); var Yua =""; var Zua =""; if(Wua.nodeType == 1) { Yua = Wua.tagName.toLowerCase(); } if(UOb.nodeType == 1) { Zua = UOb.tagName.toLowerCase(); } if(Wua != null && Wua.nodeType == 3 && UOb != null && UOb.nodeType ==3) { BFb = npa(Wua, 0); CFb = npa(UOb, UOb.nodeValue.length); } if(Wua != null && Wua.nodeType == 1 && Yua =="math"&& UOb != null && UOb.nodeType ==1 && Zua =="math") { BFb = npa(Wua, 0); CFb = npa(UOb, aua.length); } Nua[HVb++] = new Fta(new cpa(sYb, BFb, CFb), aua); } else { BFb = npa(SOb, -1); Nua[HVb++] = new Fta(new cpa(sYb, BFb, BFb), aua); } Jua =""; } BFb = null; CFb = null; SOb = Yva(SOb, false, yKb); } else if(SOb.nodeType == 1) { if(zKb) { Pua = Kva(SOb, true, yKb); } else { Pua = Dva(SOb, true, yKb); } if(Pua == null) { if(Jua.length > 0) { if(tKb(Jua)) { Nua[HVb++] = new Fta(new cpa(sYb, BFb, CFb), wta(Jua)); } Jua =""; BFb = null; CFb = null; } if(zKb) { SOb = Kva(SOb, false, yKb); } else { SOb = Dva(SOb, false, yKb); } } else { SOb = Pua; } } else if(SOb.nodeType == 3) { var aua = Wza(SOb); if(aua == null) { aua =""; } var Kab = 0; if(yKb == SOb && Owa > -1) { aua = aua.substring(0, Owa); } if(xKb == SOb && Ewa > 0) { aua = aua.substring(Ewa); Kab = Ewa; } if(aua.length == 0 && Jua.length == 0) { BFb = null; } else { if(BFb == null || Jua.length == 0) { BFb = npa(SOb, Kab); } var Qab = pua(aua); while(Qab > -1) { if(Qab == 0) { if(Jua.length > 0) { if(tKb(Jua)) { if(CFb == null) { CFb = npa(SOb, Kab); } var eSb = new cpa(sYb, BFb, CFb); if(!Ida) { Jua = Jua + aua.substr(0, 1); } else { var bza = null; var fua = null; var jua = SOb.parentNode; if(jua != null && jua.nodeType == 1) { bza = jua.getAttribute("class"); fua = jua.getAttribute("className"); } var hua = false; hua = (bza != null && (bza.toLowerCase() =="x2"|| bza.toLowerCase() =="x3")) || (fua != null && (fua.toLowerCase() =="x2"|| fua.toLowerCase() =="x3")); var iua = false; while(hua) { if(jua.previousSibling != null && jua.previousSibling.nodeType == 1) { bza = jua.previousSibling.getAttribute("class"); fua = jua.previousSibling.getAttribute("className"); if(bza != null && bza.length > 3) { bza = bza.substr(bza.length - 4).toLowerCase(); if(bza =="text") { iua = true; break; } } if(fua != null && fua.length > 3) { fua = fua.substr(fua.length - 4).toLowerCase(); if(fua =="text") { iua = true; break; } } break; } jua = jua.parentNode; if(jua != null && jua.nodeType == 1 && jua.tagName.toLowerCase() =="span") { } else { break; } } if(hua) { if(!iua) { Jua = Jua + aua.substr(0, 1); } } else { if(SOb.previousSibling != null) { bza = SOb.previousSibling.getAttribute("class"); fua = SOb.previousSibling.getAttribute("className"); if( (bza != null && (bza.toLowerCase() =="x2"|| bza.toLowerCase() =="x3")) || (fua != null && (fua.toLowerCase() =="x2"|| fua.toLowerCase() =="x3")) ) { Jua = Jua + aua.substr(0, 1); } } else { var jua = SOb; var vAb = false; while(jua.previousSibling == null && jua.parentNode.tagName.toLowerCase() =="span") { jua = jua.parentNode; if(jua.previousSibling != null) { vAb = true; } } if(vAb && jua.previousSibling != null) { bza = jua.previousSibling.getAttribute("class"); fua = jua.previousSibling.getAttribute("className"); if( (bza != null && (bza.toLowerCase() =="x2"|| bza.toLowerCase() =="x3")) || (fua != null && (fua.toLowerCase() =="x2"|| fua.toLowerCase() =="x3")) ) { Jua = Jua + aua.substr(0, 1); } } } } } Nua[HVb++] = new Fta(eSb, Jua); } Jua =""; ++Kab; aua = aua.substr(1); } else { aua = aua.substr(1); ++Kab; } } else { var lua = Jua + aua.substring(0, Qab + 1); if(lua.trimTH() =="*") { lua =""; } if(tKb(lua)) { CFb = npa(SOb, Qab + Kab); var eSb = new cpa(sYb, BFb, CFb); Nua[HVb++] = new Fta(eSb, lua); if(HVb > uta && uta > 0) { if(dca) { throw"Full selection will not be spoken due to its length."; } else { ILb("Full selection will not be spoken due to its length."); } return ; } } Jua =""; Kab += Qab + 1; aua= aua.substring(Qab + 1); } BFb = npa(SOb, Kab); CFb = null; Qab = pua(aua); } if(aua.length > 0) { Jua += aua; CFb = npa(SOb, aua.length + Kab); if(CFb == null) { Jua =""; } } if(SOb == yKb) { if(Jua.length > 0) { var eSb = new cpa(sYb, BFb, CFb); if(tKb(Jua)) { Nua[HVb++] = new Fta(eSb, Jua); } } return ; } } Pua = Dva(SOb, true, yKb); if(Pua == null) { if(Jua.length > 0) { if(tKb(Jua)) { Nua[HVb++] = new Fta(new cpa(sYb, BFb, CFb), wta(Jua)); } Jua =""; BFb = null; CFb = null; } SOb = Dva(SOb, false, yKb); } else { SOb = Pua; } } else { Pua = Dva(SOb, true, yKb); if(Pua == null) { if(Jua.length > 0) { if(tKb(Jua)) { Nua[HVb++] = new Fta(new cpa(sYb, BFb, CFb), wta(Jua)); } Jua =""; BFb = null; CFb = null; } SOb = Dva(SOb, false, yKb); } else { SOb = Pua; } } zKb = false; } } catch(err) { oJb("err rw_getTextOverRangeToSpeakImpl:"+ err.message); }};function pua(LKb){ if(LKb == null || LKb.length == 0) { return -1; } var Qab = LKb.search("\\s"); return Qab;};function tua(oYb){ if(oYb == null) { return false; } var sYb = oYb.ownerDocument.body; var BWb = oYb; while(BWb != null && BWb != sYb) { if(Gza(BWb)) { return true; } BWb = BWb.parentNode; } return false;}function wua(oYb, Xxa, GNb){ if(oYb == null || oYb == GNb) { return null; } var xKb = oYb; if (xKb.previousSibling != null) { xKb = xKb.previousSibling; if(Xxa) { if(!Cza(xKb)) { return null; } } if(xKb != null && Gza(xKb)) { if(GNb == xKb) { return null; } xKb = wua(xKb, Xxa, GNb); } else { while(xKb != null && xKb.lastChild != null) { if(xKb.nodeType == 1 && xKb.tagName.toLowerCase() =="math") { break; } xKb = xKb.lastChild; if(Xxa) { if(!Cza(xKb)) { xKb = null; } } if(xKb != null && Gza(xKb)) { if(GNb == xKb) { return null; } xKb = wua(xKb, Xxa, GNb); break; } } } } else { xKb = xKb.parentNode; if(Xxa) { if(!Cza(xKb)) { xKb = null; } } } return xKb;};function Dva(oYb, Xxa, GNb){ if(oYb == null || oYb == GNb) { return null; } var nva = Gza(oYb); if(oYb.nodeType == 1) { if(oYb.tagName.toLowerCase() =="math") { nva = true; } } var yKb = oYb; if (yKb.firstChild != null && !nva) { yKb = yKb.firstChild; } else if(yKb.nextSibling != null) { yKb = yKb.nextSibling; } else { while (yKb != null && yKb.nextSibling == null) { yKb = yKb.parentNode; if(Xxa) { if(!Cza(yKb)) { yKb = null; } } if(GNb == yKb) { break; } } if (yKb != null && GNb != yKb) { yKb = yKb.nextSibling; } } if(yKb != null) { if(Xxa) { if(!Cza(yKb)) { yKb = null; } } } if(yKb != null && Gza(yKb)) { if(yKb != GNb) { yKb = Dva(yKb, Xxa, GNb); } else { yKb = null; } } return yKb;};function Kva(oYb, Xxa, GNb){ if(oYb == null) { return null; } var nva = Gza(oYb); var yKb = oYb; if (yKb.firstChild != null && !nva) { yKb = yKb.firstChild; } else if(yKb.nextSibling != null) { if(oYb == GNb) { yKb = null; } else { yKb = yKb.nextSibling; } } else { if(oYb == GNb) { yKb = null; } else { while (yKb != null && yKb.nextSibling == null) { yKb = yKb.parentNode; if(Xxa) { if(Cza(yKb) == false) { yKb = null; } } if(GNb == yKb) { break; } } if (yKb != null && GNb != yKb) { yKb = yKb.nextSibling; } } } if(yKb != null) { if(Xxa) { if(Cza(yKb) == false) { yKb = null; } } } if(yKb != null && Gza(yKb)) { if(yKb != GNb) { yKb = Dva(yKb, Xxa, GNb); } else { yKb = null; } } return yKb;};function Rva(oYb, Xxa, GNb){ if(oYb == null || oYb == GNb) { return null; } var xKb = oYb; if (xKb.previousSibling != null) { xKb = xKb.previousSibling; if(Xxa) { if(!Cza(xKb)) { xKb = null; } } if(xKb != null && Gza(xKb)) { if(GNb == xKb) { xKb = null; } else { xKb = Rva(xKb, Xxa, GNb); } } } else { xKb = xKb.parentNode; if(Xxa) { if(!Cza(xKb)) { xKb = null; } } } return xKb;};function Yva(oYb, Xxa, GNb){ if(oYb == null || oYb == GNb) { return null; } var yKb = oYb; if(yKb.nextSibling != null) { yKb = yKb.nextSibling; } else { while (yKb != null && yKb.nextSibling == null) { yKb = yKb.parentNode; if(Xxa) { if(Cza(yKb) == false) { yKb = null; } } if(GNb == yKb) { break; } } if (yKb != null && yKb != GNb) { yKb = yKb.nextSibling; } } if(yKb != null) { if(Xxa) { if(Cza(yKb) == false) { yKb = null; } } } if(yKb != null && Gza(yKb)) { if(yKb == GNb) { yKb = null; } else { yKb = Yva(yKb, Xxa, GNb); } } return yKb;};function eva(oYb, kva){ if(oYb == null) { return null; } if(oYb.firstChild == null || Gza(oYb)) { return oYb; } if(oYb.nodeType == 1 && oYb.tagName.toLowerCase() =="textarea") { return oYb; } if(oYb.nodeType == 1 && oYb.tagName.toLowerCase() =="math") { return oYb; } var BWb = oYb.firstChild; if(BWb.nodeType == 3) { return BWb; } else if(BWb.nodeType == 1 && kva && BWb.tagName.toLowerCase() =="img"&& BWb.getAttribute("msg") != null && BWb.getAttribute("msg").length > 0) { return BWb; } else { if(kva) { return Axa(BWb, false, oYb); } else { return Qxa(BWb, false, oYb, true); } }}function iva(oYb, kva){ if(oYb == null) { return null; } if(oYb.lastChild == null || Gza(oYb)) { return oYb; } if(oYb.nodeType == 1 && oYb.tagName.toLowerCase() =="textarea") { return oYb; } if(oYb.nodeType == 1 && oYb.tagName.toLowerCase() =="math") { return oYb; } var BWb = oYb.lastChild; while(BWb != null) { if(BWb.nodeType == 3) { return BWb; } else if(BWb.nodeType == 1 && kva && BWb.tagName.toLowerCase() =="img"&& BWb.getAttribute("msg") != null && BWb.getAttribute("msg").length > 0) { return BWb; } else if(Gza(BWb) || BWb.lastChild == null) { var mYb; if(kva) { mYb = Zwa(BWb, false, oYb); } else { mYb = pwa(BWb, false, oYb, true); } return mYb; } else { BWb = BWb.lastChild; } } return oYb;}function sva(iEb){ var nva = Gza(iEb); var yKb = iEb; if (yKb.firstChild != null && !nva) { yKb = yKb.firstChild; } else if(yKb.nextSibling != null) { var SOb = yKb; yKb = yKb.nextSibling; var BWb = yKb; var sYb = BWb.ownerDocument.body; while(BWb != null && BWb != sYb) { if(BWb == SOb) { throw"DOM Error"; } BWb = BWb.parentNode; } } else { while (yKb != null && yKb.nextSibling == null) { yKb = yKb.parentNode; } if (yKb != null) { var SOb = yKb; yKb = yKb.nextSibling; var BWb = yKb; var sYb = BWb.ownerDocument.body; while(BWb != null && BWb != sYb) { if(BWb == SOb) { throw"DOM Error"; } BWb = BWb.parentNode; } } } if(yKb != null && Gza(yKb)) { yKb = sva(yKb); } return yKb;};function wva(RYb, GNb){ if(typeof(GNb) =="undefined") { GNb = null; } if(RYb == null || RYb.node == null) { return null; } var node = RYb.node; var Kab = RYb.offset; if(RYb.node.nodeType == 1 && RYb.node.tagName.toLowerCase() =="math") { return RYb; } if(RYb.forwardBias) { if(node.nodeType == 3 && Kab == node.nodeValue.length) { node = Axa(node, true, GNb); Kab = 0; if(node == null) { node = RYb.node; Kab = RYb.offset; } } } else { if(Kab > 0) { --Kab; } else { node = Zwa(node, true, GNb); if(node == null) { return RYb; } if(node.nodeType == 3) { Kab = node.nodeValue.length - 1; } else { Kab = 0; if(node.tagName.toLowerCase() =="math") { return RYb; } } } } if(node.nodeType == 3) { var Awa = node.nodeValue.charAt(Kab); if(Awa =='.'|| Awa =='!'|| Awa =='?'|| Awa ==':') { if(Kab > 0) { --Kab; } else { node = Zwa(node, true, GNb); if(node == null) { return RYb; } if(node.nodeType == 3) { Kab = node.nodeValue.length - 1; } else { Kab = 0; if(node.tagName.toLowerCase() =="math") { return RYb; } } } } } var Pwa = node; var Qwa = Kab; var xKb = node; var Ewa = Kab; var XEb = false; var Swa =' '; while(!XEb) { if(xKb.nodeType == 3) { var cYb = xKb.nodeValue; if(cYb.length > 0) { if(Ewa == -1) { Ewa = cYb.length; } cYb = cYb.replace(/[\x21\x3f\x3a]/g,"."); var Qab = cYb.lastIndexOf(".", Ewa); while(Qab > -1) { if(qla(cYb, Qab, xKb)) { if(Qab < cYb.length - 1) { Pwa = xKb; Qwa = Qab + 1; XEb = true; break; } else { if(!EKb(Swa)) { XEb = true; break; } } } if(Qab == 0) { Qab = -1; } else { Qab = cYb.lastIndexOf(".", Qab - 1); } } if(XEb) { break; } if(cYb.trimTH().length > 0) { Pwa = xKb; Qwa = 0; } Swa = cYb.charAt(0); } } else { if(fta(xKb) && xKb.getAttribute("ignore") == null) { if(xKb.tagName.toLowerCase() =="math") { XEb = true; break; } Pwa = xKb; Qwa = 0; } } xKb = wua(xKb, true, GNb); Ewa = -1; if(xKb == null) { XEb = true; break; } if(xKb.nodeType == 3 && sta(xKb) != null) { xKb = sta(xKb); xKb = wua(xKb, true, GNb); } } if(Pwa.nodeType == 3) { var cYb = Pwa.nodeValue; if(Qwa < cYb.length) { while(Qwa < cYb.length) { if(gKb(cYb.charAt(Qwa))) { if(Pwa == RYb.node && Qwa >= RYb.offset) { break; } else { ++Qwa; } } else { break; } } } } return new THCaret(Pwa, Qwa, true);}function Kwa(RYb, GNb){ if(typeof(GNb) =="undefined") { GNb = null; } if(RYb == null || RYb.node == null) { return null; } var yKb = RYb.node; var Owa = RYb.offset; var Pwa = yKb; var Qwa = Owa; var XEb = false; var Swa =' '; while(!XEb) { if(yKb.nodeType == 3) { var cYb = yKb.nodeValue; if(cYb.length > 0) { if(Swa =='.') { var Uwa = cYb.charAt(Owa); if(!EKb(Uwa)) { XEb = true; break; } } cYb = cYb.replace(/[\x21\x3f\x3a]/g,"."); var Qab = cYb.indexOf(".", Owa); while(Qab > -1) { if(qla(cYb, Qab, yKb)) { if(Qab < cYb.length - 1) { Pwa = yKb; Qwa = Qab + 1; XEb = true; } break; } Owa = Qab + 1; Qab = cYb.indexOf(".", Owa); } if(XEb) { break; } if(cYb.trimTH().length > 0) { Pwa = yKb; Qwa = cYb.length; } Swa = cYb.charAt(cYb.length -1); if(Swa =='.') { if(!qla(cYb, cYb.length -1, yKb)) { Swa =' '; } } } yKb = Dva(yKb, true, GNb); } else { if(fta(yKb) && yKb.getAttribute("ignore") == null) { if(yKb.tagName.toLowerCase() =="math") { XEb = true; break; } Pwa = yKb; Qwa = 0; yKb = Yva(yKb, true, GNb); } else { yKb = Dva(yKb, true, GNb); } } Owa = 0; if(yKb == null) { XEb = true; break; } } if(Pwa.nodeType == 3) { var cYb = Pwa.nodeValue; if(Qwa > 0 && Qwa <= cYb.length) { while(Qwa > 0) { if(gKb(cYb.charAt(Qwa - 1))) { if(Pwa == RYb.node && Qwa <= RYb.offset) { break; } else { --Qwa; } } else { break; } } } } return new THCaret(Pwa, Qwa, false);}function Zwa(oYb, Xxa, GNb){ var xKb = oYb; var vAb = false; while (xKb != null && xKb != GNb) { xKb = wua(xKb, Xxa, GNb); if(xKb != null) { if (xKb.nodeType == 3 && xKb.parentNode.tagName.toLowerCase() !="textarea") { vAb = true; } if (xKb.nodeType == 1 && xKb.tagName.toLowerCase() =="math") { vAb = true; } else if(xKb.nodeType == 1 && xKb.tagName.toLowerCase() =="img") { var bza = xKb.getAttribute("msg"); if (bza != null && bza.length > 0) { vAb = true; } } if(vAb) { return xKb; } } } return null;}function iwa(oYb, Xxa, GNb){ var xKb = oYb; while(xKb != null && xKb != GNb) { xKb = Zwa(xKb, Xxa, GNb); if(xKb != null) { var Ixa = (xKb.nodeType == 3)? xKb.nodeValue.trimTH() : xKb.getAttribute("msg").trimTH(); if(tKb(Ixa)) { return xKb; } } } return null;}function pwa(oYb, Xxa, GNb, Uxa){ var xKb = (Uxa)? Zwa(oYb, Xxa, GNb) : iwa(oYb, Xxa, GNb); while(xKb != null && xKb.nodeType != 3 && xKb != GNb) { if(xKb.tagName.toLowerCase() =="math") { break; } xKb = (Uxa)? Zwa(xKb, Xxa, GNb) : iwa(xKb, Xxa, GNb); } return xKb;}function Axa(oYb, Xxa, GNb){ var yKb = oYb; var vAb = false; while (yKb != null && yKb != GNb) { yKb = Dva(yKb, Xxa, GNb); if(yKb != null) { if (yKb.nodeType == 3 && yKb.parentNode.tagName.toLowerCase() !="textarea") { vAb = true; } if (yKb.nodeType == 1 && yKb.tagName.toLowerCase() =="math") { vAb = true; } else if(yKb.nodeType == 1 && yKb.tagName.toLowerCase() =="img") { var bza = yKb.getAttribute("msg"); if (bza != null && bza.length > 0) { vAb = true; } } if(vAb) { return yKb; } } } return null;}function Jxa(oYb, Xxa, GNb){ var yKb = oYb; while(yKb != null && yKb != GNb) { yKb = Axa(yKb, Xxa, GNb); if(yKb != null) { var Ixa; if(yKb.nodeType == 3) { Ixa = yKb.nodeValue.trimTH(); } else { if(yKb.tagName.toLowerCase() =="img") { Ixa = yKb.getAttribute("msg").trimTH(); } else if(yKb.tagName.toLowerCase() =="math") { Ixa = aCb(yKb); } } if(tKb(Ixa)) { return yKb; } } } return null;}function Qxa(oYb, Xxa, GNb, Uxa){ var yKb = (Uxa)? Axa(oYb, Xxa, GNb) : Jxa(oYb, Xxa, GNb); while(yKb != null && yKb.nodeType != 3 && yKb != GNb) { if(yKb.tagName.toLowerCase() =="math") { break; } yKb = (Uxa)? Axa(yKb, Xxa, GNb) : Jxa(yKb, Xxa, GNb); } return yKb;}function fxa(eJb){ var Hya = eva(eJb, true); var zVb = new THCaret(Hya, 0, true); var AWb = Kwa(zVb, eJb); zVb = wva(AWb, eJb); if(zVb == null || AWb == null) { return null; } var lOb = new qoa(zVb, AWb); var oxa = false; while(!oxa) { oxa = DLb(lOb) && Yya(lOb); if(!oxa) { var pxa = zxa(lOb, eJb); if(pxa == null || (AWb.node == pxa.AWb.node && AWb.offset == pxa.AWb.offset) || (zVb.node == pxa.zVb.node && zVb.offset == pxa.zVb.offset)) { break; } else { lOb = pxa; } } } return lOb;}function qxa(eJb){ var Hya = iva(eJb, true); var AWb; if(Hya.nodeType == 3) { AWb = new THCaret(Hya, Hya.nodeValue.length, false); } else { AWb = new THCaret(Hya, -1, false); } var zVb = wva(AWb, eJb); AWb = Kwa(zVb, eJb); if(zVb == null || AWb == null) { return null; } var lOb = new qoa(zVb, AWb); var oxa = false; while(!oxa) { oxa = DLb(lOb) && Yya(lOb); if(!oxa) { var pxa = Lya(lOb, eJb); if(pxa == null || (AWb.node == pxa.AWb.node && AWb.offset == pxa.AWb.offset) || (zVb.node == pxa.zVb.node && zVb.offset == pxa.zVb.offset)) { break; } else { lOb = pxa; } } } return lOb;}function xxa(RYb){ var AWb = Kwa(RYb); var zVb = wva(AWb); if(zVb == null || AWb == null) { return null; } return new qoa(zVb, AWb);}function zxa(tFb, GNb){ if(tFb == null) { return null; } if(typeof(GNb) =="undefined") { GNb = null; } var SOb = tFb.AWb.node; var Pya = tFb.AWb.offset; if(Pya == joa) { SOb = Yva(SOb, false, GNb); Pya = 0; } var AWb; var zVb; while(SOb != null) { if(SOb.nodeType == 3 && Pya < SOb.nodeValue.length) { AWb = Kwa( new THCaret(SOb, Pya, false), GNb); if(AWb == null) { return null; } if(AWb.node == SOb && AWb.offset == Pya) { var Hya = Jxa(SOb, false, GNb); if(Hya == null) { return null; } AWb = Kwa(new THCaret(Hya, 0, false), GNb); } } else { var Hya = Jxa(SOb, false, GNb); if(Hya == null) { return null; } AWb = Kwa(new THCaret(Hya, 0, false), GNb); } zVb = wva(AWb, null); if(zVb == null) { return null; } if(tFb.zVb.node != zVb.node || tFb.zVb.offset != zVb.offset) { var lOb = new qoa(zVb, AWb); if(Yya(lOb)) { return lOb ; } } SOb = AWb.node; if(SOb.nodeType == 3) { var FJb = SOb.nodeValue.replace(/[\x21\x3f\x3a]/g,"."); var Tya = FJb.indexOf(".", AWb.offset + 1); if(Tya == -1) { Pya = FJb.length; } else { Pya = Tya; } } } return null;}function Lya(tFb, GNb){ if(typeof(GNb) =="undefined") { GNb = null; } var SOb = tFb.zVb.node; var Pya = tFb.zVb.offset; var zVb; var AWb; while(SOb != null) { if(SOb.nodeType == 3) { var FJb = SOb.nodeValue.replace(/[\x21\x3f\x3a]/g,"."); var Tya; if(Pya > 0) { Tya = FJb.lastIndexOf(".", Pya); } else if(Pya == 0) { Tya = -1; } else { Tya = FJb.lastIndexOf("."); } while(Tya > -1) { Pya = Tya; AWb = Kwa(new THCaret(SOb, Pya, true), GNb); if(AWb == null) { return null; } if(AWb.node != tFb.AWb.node || AWb.offset != tFb.AWb.offset) { zVb = wva(AWb, GNb); if(zVb == null) { return null; } var lOb = new qoa(zVb, AWb); if(Yya(lOb)) { return lOb ; } } if(Tya == 0) { Tya = -1; } else { Tya = FJb.lastIndexOf(".", Tya - 1); } } } Pya = -1; BWb = pwa(SOb, true, GNb, false); if(BWb != null) { SOb = BWb; } else { SOb = iwa(SOb, false, GNb); if(SOb != null) { if(SOb.nodeType == 3) { AWb = Kwa(new THCaret(SOb, SOb.nodeValue.length, false), GNb); } else { AWb = Kwa(new THCaret(SOb, 0, false), GNb); } if(AWb == null) { return null; } if(AWb.node != tFb.AWb.node || AWb.offset != tFb.AWb.offset) { zVb = wva(AWb, GNb); if(zVb == null) { return null; } return new qoa(zVb, AWb); } } } } return null;}function Yya(tFb){ var uVb = tFb.zVb.node; var sYb = uVb.ownerDocument.body; while(uVb != null && uVb != sYb) { if(uVb.nodeType == 1 && uVb.getAttribute(eaa) != null) { return false; } uVb = uVb.parentNode; } var vVb = tFb.AWb.node; while(vVb != null && vVb != sYb) { if(vVb.nodeType == 1 && vVb.getAttribute(eaa) != null) { return false; } vVb = vVb.parentNode; } return true;}function dya(oYb){ var fya; var gya = oYb; var mYb = wua(oYb, true, null); while(mYb != null) { fya = false; if(mYb.nodeType == 1) { if(fta(mYb)) { if(mYb.getAttribute("ignore") != null) { fya = true; } } else { fya = true; } } else if(mYb.nodeType == 3) { if(mYb.nodeValue.trimTH().length == 0) { fya = true; } } if(!fya) { gya = mYb; } mYb = wua(mYb, true, null); } return gya;}function iya(oYb){ var fya; var gya = oYb; var kEb = Dva(oYb, true, null); while(kEb != null) { fya = false; if(kEb.nodeType == 1) { if(fta(kEb)) { if(kEb.getAttribute("ignore") != null) { fya = true; } } else { fya = true; } } else if(kEb.nodeType == 3) { if(kEb.nodeValue.trimTH().length == 0) { fya = true; } } if(!fya) { gya = kEb; } kEb = Dva(kEb, true, null); } return gya;}function nya(oYb, zTb){ if(oYb == null || oYb.nodeType != 3 || oYb.parentNode == null) { return oYb; } var kya = 0; var LZb = oYb.parentNode; var mya = LZb.parentNode; if(mya != null && LZb.tagName.toLowerCase() =="span"&& mya.tagName.toLowerCase() =="span"&& LZb.getAttribute(faa) != null && (mya.getAttribute(faa) != null || mya.getAttribute(gaa) != null)) { kya = 2; } else if(LZb.tagName.toLowerCase() =="span"&& (LZb.getAttribute(faa) != null || LZb.getAttribute(gaa) != null)) { kya = 1; } if(oYb.nodeValue.length == 0 || zTb <= 0 || zTb >= oYb.nodeValue.length) { if(kya == 0) { var span = document.createElement("span"); span.setAttribute(faa,"1"); var wya = document.createElement("span"); wya.setAttribute(faa,"1"); LZb.insertBefore(span, oYb); span.appendChild(wya); wya.appendChild(oYb); } else if(kya == 1) { var span = document.createElement("span"); span.setAttribute(faa,"1"); LZb.insertBefore(span, oYb); span.appendChild(oYb); } return oYb; } var cYb = oYb.nodeValue; var uya = cYb.substring(0, zTb); var vya = cYb.substring(zTb); var wya = document.createElement("span"); var xya = document.createElement("span"); var yya = document.createTextNode(uya); var zya = document.createTextNode(vya); wya.appendChild(yya); xya.appendChild(zya); wya.setAttribute(faa,"1"); xya.setAttribute(faa,"1"); if(kya == 2) { mya.insertBefore(xya, LZb); mya.insertBefore(wya, xya); mya.removeChild(LZb); } else if(kya == 1) { LZb.insertBefore(wya, oYb); LZb.insertBefore(xya, oYb); LZb.removeChild(oYb); } else { var span = document.createElement("span"); span.setAttribute(faa,"1"); span.appendChild(wya); span.appendChild(xya); LZb.insertBefore(span, oYb); LZb.removeChild(oYb); } return zya;}function Cza(oYb){ if(oYb.nodeType != 1) { return oYb.nodeType == 3; } var pYb = oYb.tagName.toLowerCase().trimTH(); if(pYb =="font") { var TZb = oYb.getAttribute("started"); if(TZb != null && TZb =="1") { return false; } } if(pYb =="span"&& oYb.getAttribute("texthelpSkip") != null) { return false; } if(pYb =="em"|| pYb =="strong"|| pYb =="b"|| pYb =="i"|| pYb =="u"|| pYb =="tt"|| pYb =="font"|| pYb =="kbd"|| pYb =="dfn"|| pYb =="cite"|| pYb =="sup"|| pYb =="sub"|| pYb =="a"|| pYb =="embed"|| pYb =="span"|| pYb =="small"|| pYb =="nobr"|| pYb =="wbr"|| pYb =="acronym"|| pYb =="abbr"|| pYb =="code"|| pYb =="s"|| pYb =="chunk"|| pYb =="th:pron"|| pYb =="img"|| pYb =="/th:pron"|| pYb =="w"|| pYb =="/w"|| pYb =="lic"|| pYb =="/lic") { return true; } return false;};function Gza(oYb){ if(oYb == null) { return true; } if(oYb.nodeType != 1) { return oYb.nodeType != 3; } var yMb; yMb = oYb.getAttribute("ignore"); if(yMb != null) { return true; } yMb = oYb.getAttribute(iaa); if(yMb != null && !jaa) { return true; } if(Cea) { var Iza = ICb(oYb); if(Iza != null) { if(Iza.visibility =="hidden"|| Iza.display =="none") { return true; } } } var pYb = oYb.tagName.toLowerCase(); return pYb =="link"|| pYb =="area"|| pYb =="script"|| pYb =="noscript"|| pYb =="annotation"|| pYb =="style"|| pYb =="!--"|| pYb =="title"|| pYb =="html:script"; };function Lza(iEb){ if(iEb.nodeType != 1) { return false; } var pYb = iEb.tagName.toLowerCase().trimTH(); if(pYb =="p"|| pYb =="br"|| pYb =="head"|| pYb =="body"|| pYb =="hr"|| pYb =="div"|| pYb =="h1"|| pYb =="h2"|| pYb =="h3"|| pYb =="h4"|| pYb =="h5"|| pYb =="h6"|| pYb =="blockquote"|| pYb =="table"|| pYb =="tbody"|| pYb =="tr"|| pYb =="td"|| pYb =="th") { return true; } return false;};function Nza(oYb){ var cYb =""; if(oYb.nodeType == 3) { if(Gza(oYb.parentNode) == false && oYb.parentNode.tagName.toLowerCase() !="textarea") { cYb = oYb.nodeValue; } } else if(oYb.nodeType == 1) { if(oYb.getAttribute("ignore") != null) { cYb =""; XEb = true; } else { var QLb = oYb.tagName.toLowerCase(); var XEb = false; if(QLb =="img") { var bza = oYb.getAttribute("msg"); if(bza != null && bza.trimTH().length > 0) { cYb =" "+ bza.trimTH() +" "; } XEb = true; } else if(QLb =="span") { var bza = oYb.getAttribute("pron"); if(bza != null && bza.trimTH().length > 0) { cYb = bza.trimTH(); XEb = true; } } else if(QLb =="acronym"|| QLb =="abbr") { var bza = oYb.getAttribute("pron"); if(bza != null && bza.trimTH().length > 0) { cYb = bza.trimTH(); } else { bza = oYb.getAttribute("title"); if(bza != null && bza.trimTH().length > 0) { cYb = bza.trimTH(); XEb = true; } } } else if(QLb =="math") { cYb = aCb(oYb); } } if(!XEb) { var OLb = oYb.firstChild; while(OLb != null) { cYb += Nza(OLb); OLb = OLb.nextSibling; } } } return cYb;}function Wza(oYb){ var cYb =""; if(oYb.nodeType == 3) { if(!Gza(oYb.parentNode) && oYb.parentNode.tagName.toLowerCase() !="textarea") { cYb = oYb.nodeValue; } } else if(oYb.nodeType == 1) { if(oYb.getAttribute("ignore") != null) { cYb =""; } else { var QLb = oYb.tagName.toLowerCase(); if(QLb =="img") { var bza = oYb.getAttribute("msg"); if(bza != null && bza.trimTH().length > 0) { cYb =" "+ bza.trimTH() +" "; } } else if(QLb =="span") { var bza = oYb.getAttribute("pron"); if(bza != null && bza.trimTH().length > 0) { cYb = bza.trimTH(); } } else if(QLb =="acronym"|| QLb =="abbr") { var bza = oYb.getAttribute("pron"); if(bza != null && bza.trimTH().length > 0) { cYb = bza.trimTH(); } else { bza = oYb.getAttribute("title"); if(bza != null && bza.trimTH().length > 0) { cYb = bza.trimTH(); } } } else if(QLb =="math") { cYb = aCb(oYb); } } } return cYb;}function rw_getTextOverRange(eJb, eza, fza){ try { if(eza == null || fza == null) { return""; } var fWb = UBb(eJb, eza.path, eza.offset, fza.path, fza.offset); return rw_getTextOverCaretRange(fWb); } catch(err) { oJb("err rw_getTextOverRange:"+"|"+ err.message); return""; }}function rw_getTextOverCaretRange(ELb){ try { if(ELb == null || ELb.zVb == null || ELb.AWb == null) { return""; } var zVb = ELb.zVb; var AWb = ELb.AWb; var xKb = zVb.node; var yKb = AWb.node; var zKb = true; var SOb = xKb; var cYb =""; while(SOb != null) { var ARb = Wza(SOb); if(ARb != null && ARb !="") { if(SOb == yKb && AWb.offset > -1) { ARb = ARb.substring(0, AWb.offset); } if(SOb == xKb && zVb.offset > -1) { ARb = ARb.substring(zVb.offset); } cYb += ARb; } if(zKb) { SOb = Kva(SOb, false, yKb); } else { SOb = Axa(SOb, false, yKb); } zKb = false; } return cYb.trimTH(); } catch(err) { oJb("err rw_getTextOverCaretRange:"+"|"+ err.message); return""; }}function rza(ELb){ try { if(ELb == null || ELb.zVb == null || ELb.AWb == null) { return""; } var zVb = ELb.zVb; var AWb = ELb.AWb; var xKb = zVb.node; var yKb = AWb.node; var ALb = false; var SOb = xKb; var cYb =""; while(SOb != null) { ALb = fta(SOb); if(ALb || SOb.nodeType == 3) { var ARb = Wza(SOb); if(ARb != null && ARb !="") { if(SOb == yKb && AWb.offset > -1) { ARb = ARb.substring(0, AWb.offset); } if(SOb == xKb && zVb.offset > -1) { ARb = ARb.substring(zVb.offset); } cYb += ARb; } } if(ALb) { SOb = Yva(SOb, false, yKb); } else { SOb = Dva(SOb, false, yKb); } } return cYb.trimTH(); } catch(err) { oJb("err rw_getTextOverCaretRange:"+"|"+ err.message); return""; }}function EAb(iEb){ var TSb = null; var QLb = iEb.tagName.toLowerCase(); var eZb = XAb(iEb); if(QLb =="input") { var TLb = iEb.getAttribute("type"); if(TLb != null) { TLb = TLb.toLowerCase(); } var QSb =""; if(TLb == null || TLb.equalsTH("") || TLb.equalsTH("text")) { QSb = iEb.value; } else if(TLb.equalsTH("password")) { QSb ="Masked password field"; } else if(TLb.equalsTH("image")) { QSb =""; } else if(TLb.equalsTH("button") || TLb.equalsTH("submit") || TLb.equalsTH("reset")) { QSb = iEb.getAttribute("value"); } if(QSb.equalsTH("") == false) { TSb ="form:"+ eZb +";"+ QSb; } } else if(QLb =="select") { var QSb =""; var WLb = iEb.selectedIndex; var XLb =""; for(var HVb = 0; HVb < iEb.options.length; HVb++) { XLb += iEb.options[HVb].text +" "; } if(XLb.equalsTH("") == false) { if(WLb > -1) { QSb = iEb.options[WLb].text; QSb +=" selected from the list "+ XLb; } else { QSb ="No selection from the list "+ XLb; } TSb ="form"+ eZb +";"+ QSb; } } else if(QLb =="textarea") { var QSb = iEb.value; TSb ="form"+ eZb +";"+ QSb; } else if(QLb =="option") { var QSb = iEb.value; TSb ="form"+ eZb +";"+ QSb; } return TSb;}function OAb(evt){ var QAb; if(hga) { QAb = evt.srcElement; } else if(oga) { QAb = evt.target; } else { QAb = evt.target; } return QAb;}function SAb(evt){ var Lab = null; var QAb; var RAb = 0; if(hga) { QAb = evt.srcElement; if(QAb.nodeType == 1 && QAb.tagName.toLowerCase() =="textarea") { } else { Lab = rw_getTargetNodeAsCaretIE(evt); if(Lab != null) { if(Lab.node == null || Lab.node.parentNode == null || Lab.node.parentNode != QAb) { Lab = null; return null; } } } } else if(oga) { QAb = evt.target; if(QAb != null) { if(Jra) { if(QAb.firstChild != null && QAb.firstChild.nodeType == 3 && QAb.tagName.toLowerCase() !="textarea") { var UAb = QAb.firstChild.nodeValue; if(UAb.trimTH().length > 0) { QAb = QAb.firstChild; } } } else if(Ira) { if(evt.fromElement != null && QAb.nodeType == 1 && QAb.tagName.toLowerCase() !="textarea") { if(evt.fromElement.nodeType == 3) { QAb = evt.fromElement; } } else { if(QAb.nodeType == 1 && QAb.firstChild != null && QAb.firstChild.nodeType == 3 && QAb.tagName.toLowerCase() !="textarea") { var UAb = QAb.firstChild.nodeValue; if(UAb.trimTH().length > 0) { QAb = QAb.firstChild; } } } } } } else { if(evt.explicitOriginalTarget.nodeValue != null) { if(evt.target.tagName.toLowerCase() =="textarea") { QAb = evt.target; } else { QAb = evt.explicitOriginalTarget; var UJb = window.getSelection(); if(UJb.anchorNode == null || UJb.anchorNode != QAb) { return null; } else { Lab = new THCaret(UJb.anchorNode, UJb.anchorOffset, true); } } } else { QAb = evt.target; } } if(Lab == null && QAb != null) { Lab = new THCaret(QAb, 0, true); } return Lab;}function XAb(YAb){ var eZb =""; var ZAb = 0; var aAb =""; if(YAb != null && YAb.ownerDocument != null) { var qAb = false; var pAb = false; var sYb = YAb.ownerDocument.body; while(YAb != null && YAb != sYb) { if(fta(YAb)) { eZb =""; } qAb = (YAb.nodeType == 3) || (YAb.nodeType == 1 && YAb.tagName =="FONT"); var iEb = YAb.previousSibling; while(iEb != null) { pAb = (iEb.nodeType == 3) || (iEb.nodeType == 1 && iEb.tagName =="FONT"); if(qAb && pAb) { } else { ++ZAb; } iEb = iEb.previousSibling; qAb = pAb; } eZb = eZb + ZAb +"~"; ZAb = 0; YAb = YAb.parentNode; if(YAb != null && YAb.getAttribute != null && YAb.tagName != null) { var fAb = YAb.getAttribute("chunk"); if(YAb.tagName.toLowerCase() =="span"&& fAb =="1") { var gAb = XAb(YAb); aAb ="#^th*"+ gAb +"#^th*"; } } } } return aAb + eZb;};function iAb(VBb, FBb){ var aYb = VBb; if(FBb.lastIndexOf("*") > -1) { var Qab = FBb.lastIndexOf("*"); FBb = FBb.substring(Qab + 1); } var mAb = FBb.split("~"); var tZb = mAb.length; var i; for(i = tZb - 2; i > -1; i--) { aYb = aYb.firstChild; if(aYb == null) { return null; } var sKb; if(mAb[i].length == 0) { sKb = 0; } else { sKb = parseInt(mAb[i]); } var pAb = false; var qAb = aYb.nodeType == 3 || (aYb.nodeType == 1 && aYb.tagName =="FONT"); while(sKb > 0) { aYb = aYb.nextSibling; if(aYb == null) { return null; } pAb = (aYb.nodeType == 3) || (aYb.nodeType == 1 && aYb.tagName =="FONT"); if(pAb && qAb) { } else { --sKb; qAb = pAb; } } } return aYb;}function ABb(VBb, FBb, zTb, MWb){ try { if(VBb == null) { return null; } var aYb = iAb(VBb, FBb); if(fta(aYb)) { if(lta(aYb)) { if(MWb) { var uVb = eva(aYb, false); if(uVb != null) { return new THCaret(uVb, 0, MWb); } else { return new THCaret(aYb, 0, MWb); } } else { var vVb = iva(aYb, false); if(vVb != null) { if(vVb.nodeType == 3) { return new THCaret(vVb, vVb.length, MWb); } else { return new THCaret(vVb, 0, MWb); } } else { return new THCaret(aYb, 0, MWb); } } } else { return new THCaret(aYb, 0, MWb); } } var Kab = 0; if(MWb == false) { ++Kab; } if(zTb > -1) { if(aYb == null) { return null; } var vAb = false; var vVb = aYb.parentNode; var xAb = aYb; var FJb; while(vAb == false) { if(aYb.nodeType == 3) { FJb = aYb.nodeValue; if(zTb < (Kab + FJb.length)) { vAb = true; break; } xAb = aYb; Kab += aYb.nodeValue.length; aYb = Dva(aYb, false, vVb); } else if(aYb.nodeType == 1) { if(fta(aYb)) { var zAb = zTb - Kab; if(zAb > 0) { Kab += 1; } else { vAb = true; break; } aYb = Yva(aYb, false, vVb); } else { aYb = Dva(aYb, false, vVb); } } if(aYb == null || aYb == vVb) { if(xAb != null) { aYb = xAb; if(aYb.nodeType == 3) { Kab = zTb - aYb.nodeValue.length; } else { Kab = 0; } if(!MWb) { ++Kab; } break; } else { return null; } } } if(MWb) { return new THCaret(aYb, zTb - Kab, MWb); } else { return new THCaret(aYb, zTb - (Kab - 1), MWb); } } else { return new THCaret(aYb, zTb, MWb); } } catch(err) { oJb("getCaretFromDomPosition error"); return null; }}function UBb(VBb, ZBb, aBb, bBb, cBb){ var zVb = ABb(VBb, ZBb, aBb, true); var AWb; if(ZBb == bBb && aBb >= cBb) { AWb = zVb; } else { AWb = ABb(VBb, bBb, cBb, false); } return new qoa(zVb, AWb);}function dBb(oYb){ if(oYb == null) { return""; } if(oYb.className) { return oYb.className; } else { return oYb.getAttribute("class"); }}function fBb(sPb, qBb, OEb, yBb, kBb){ if(hga) { return oBb("<"+ sPb +" name='"+ kBb +"'>", qBb, OEb, yBb); } else { var kRb = oBb(sPb, qBb, OEb, yBb); kRb.setAttribute("name",kBb); kRb.name = kBb; return kRb; }}function oBb(sPb, qBb, OEb, yBb){ var tBb = document.createElement(sPb); if(OEb != null) { tBb.id = OEb; } if(yBb != null) { tBb.className = yBb; } if(qBb != null) { var tZb = qBb.length; if(hga) { for(var i = 0; i < tZb; i += 2) { if(qBb[i] =="style") { ACb(tBb, qBb[i + 1]); } else { tBb.setAttribute(qBb[i], qBb[i + 1]); } } } else { for(var i = 0; i < tZb; i += 2) { tBb.setAttribute(qBb[i], qBb[i + 1]); } } } return tBb;}function uBb(sPb, wBb, OEb, yBb){ var tBb = document.createElement(sPb); if(OEb != null) { tBb.id = OEb; } if(yBb != null) { tBb.className = yBb; } if(wBb != null) { if(hga) { for(var i in wBb) { if(i =="style") { ACb(tBb, wBb[i]); } else { tBb.setAttribute(i, wBb[i]); } } } else { for(var i in wBb) { tBb.setAttribute(i, wBb[i]); } } } return tBb;}function ACb(p_theObj, CCb){ var zBb = CCb.indexOf(":"); var DCb = CCb.indexOf(";", zBb); var ECb; var QSb; var TSb = CCb; while(zBb > -1) { ECb = TSb.substring(0, zBb); if(DCb > -1) { QSb = TSb.substring(zBb + 1, DCb); TSb = TSb.substr(DCb + 1); zBb = TSb.indexOf(":"); DCb = TSb.indexOf(";", zBb); } else { QSb = TSb.substr(zBb + 1); zBb = -1; } eval("p_theObj.style."+ ECb +"=\""+ QSb +"\";"); }}function ICb(JCb){ if(hga) { return JCb.currentStyle; } else { return window.getComputedStyle(JCb, null); }}function OCb(VCb, WCb){ var element = document.createElement(WCb); element.innerHTML = VCb; document.body.appendChild(element);}function UCb(VCb, WCb, YCb){ var element = document.createElement(WCb); var tZb = YCb.length; for(i = 0; i < tZb; i += 2) { element.setAttribute(YCb[i], YCb[i + 1]); } element.innerHTML = VCb; document.body.appendChild(element);}function aCb(oYb){ if(oYb.previousSibling != null || oYb.nextSibling != null) { var ZCb = document.createElement("span"); oYb.parentNode.replaceChild(ZCb, oYb); ZCb.appendChild(oYb); } if(hga) { var dCb = oYb.outerHTML; if(dCb == null) { return""; } else { if(dCb.indexOf("<?import namespace") > -1) { var n = dCb.indexOf("/>"); if(n > -1) { dCb = dCb.substring(n + 2); dCb = dCb.replace(/m:/gi,""); } } return dCb; } } else { var dCb = oYb.parentNode.innerHTML; if(dCb != null && dCb.length > 0) { return dCb; } else { return""; } }}function eCb(o, p, q){ if(hga) { document.writeln(p); return; } function r(a) { var b; if(typeof DOMParser !="undefined") { b = (new DOMParser()).parseFromString(a,"application/xml"); } else { var c = ["MSXML2.DOMDocument","MSXML.DOMDocument","Microsoft.XMLDOM"]; for(var i = 0; i < c.length && !b; i++) { try { b = new ActiveXObject(c[i]); b.loadXML(a); } catch(e) { } } } return b; } function s(a, b, c) { a[b] = function() { return eval(c); }; } function t(b, c, d) { if(typeof d =="undefined") { d = 1; } if(d > 1) { if(c.nodeType == 1) { var e = document.createElement(c.nodeName); var f = {}; for(var a = 0,g = c.attributes.length; a < g; a++) { var h = c.attributes[a].name,k = c.attributes[a].value,l = (h.substr(0, 2) =="on"); if(l) { f[h] = k; } else { switch(h) { case"class":e.className = k;break;case"for":e.htmlFor = k;break;default:e.setAttribute(h, k); } } } b = b.appendChild(e); for(l in f) { s(b, l, f[l]); } } else if(c.nodeType == 3) { var m = (c.nodeValue ? c.nodeValue :""); var n = m.replace(/^\s*|\s*$/g,""); if(n.length < 7 || (n.indexOf("<!--") != 0 && n.indexOf("-->") != (n.length - 3))) { b.appendChild(document.createTextNode(m)); } } } for(var i = 0,j = c.childNodes.length; i < j; i++) { t(b, c.childNodes[i], d + 1); } } p ="<root>"+ p +"</root>"; var u = r(p); if(o && u) { if(q != false) { while(o.lastChild) { o.removeChild(o.lastChild); } } t(o, u.documentElement); }}function $rw_logMe(oUb){ oJb(oUb);}function $rw_alertMe(oUb){ alert(oUb);}function rw_getDisplayWidth(QEb){ if(typeof(QEb) =="undefined") { QEb = window; } var nW = (QEb.innerWidth) ? QEb.innerWidth : QEb.document.body.offsetWidth; return nW;}function rw_getDisplayWidthAdjusted(QEb){ if(typeof(QEb) =="undefined") { QEb = window; } var nW = ((QEb.innerWidth) ? QEb.innerWidth : QEb.document.body.offsetWidth) - rw_getScrollBarWidth(QEb); return nW;}function rw_getDocumentDisplayWidth(QEb){ if(typeof(QEb) =="undefined") { QEb = window; } var nW = (QEb.innerWidth) ? QEb.innerWidth : QEb.document.documentElement.offsetWidth; return nW;}function rw_getDocumentDisplayWidthAdjusted(QEb){ if(typeof(QEb) =="undefined") { QEb = window; } var nW = ((QEb.innerWidth) ? QEb.innerWidth : QEb.document.documentElement.offsetWidth) - rw_getScrollBarWidth(QEb); return nW;}function rw_getDisplayHeight(QEb){ if(typeof(QEb) =="undefined") { QEb = window; } if(fga) { return rw_getDocumentDisplayHeight(QEb); } else { var nH = (QEb.innerHeight) ? QEb.innerHeight : QEb.document.body.offsetHeight; return nH; }}function rw_getDisplayHeightAdjusted(QEb){ if(typeof(QEb) =="undefined") { QEb = window; } if(fga) { return rw_getDocumentDisplayHeightAdjusted(QEb); } else { var nH = ((QEb.innerHeight) ? QEb.innerHeight : QEb.document.body.offsetHeight ) - rw_getScrollBarHeight(QEb); return nH; }}function rw_getDocumentDisplayHeight(QEb){ if(typeof(QEb) =="undefined") { QEb = window; } var nH = (QEb.innerHeight) ? QEb.innerHeight : QEb.document.documentElement.offsetHeight; return nH;}function rw_getDocumentDisplayHeightAdjusted(QEb){ if(typeof(QEb) =="undefined") { QEb = window; } var nH = ((QEb.innerHeight) ? QEb.innerHeight : QEb.document.documentElement.offsetHeight) - rw_getScrollBarHeight(QEb); return nH;}function vCb(QEb){ if(typeof(QEb) =="undefined") { QEb = window; } if(QEb.document.compatMode =="CSS1Compat"&& QEb.document.body.parentNode && QEb.document.body.parentNode.scrollLeft) { return QEb.document.body.parentNode.scrollLeft; } var n = (QEb.pageXOffset) ? QEb.pageXOffset : (QEb.scrollX) ? QEb.scrollX : (QEb.document.body.scrollLeft) ? QEb.document.body.scrollLeft : (QEb.document.documentElement.scrollLeft)? QEb.document.documentElement.scrollLeft:0; return n;}function rw_getScreenOffsetLeft(QEb){ if(typeof(QEb) =="undefined") { QEb = window; } if(QEb.pageXOffset && QEb.pageXOffset > 0) { return QEb.pageXOffset; } else if(QEb.document.body.scrollLeft && QEb.document.body.scrollLeft > 0) { return QEb.document.body.scrollLeft; } else if(QEb.document.documentElement.scrollLeft && QEb.document.documentElement.scrollLeft > 0) { return QEb.document.documentElement.scrollLeft; } return 0;}function rw_getScreenOffsetTop(QEb){ if(typeof(QEb) =="undefined") { QEb = window; } if(QEb.pageYOffset && QEb.pageYOffset > 0) { return QEb.pageYOffset; } else if(QEb.document.body.scrollTop && QEb.document.body.scrollTop > 0) { return QEb.document.body.scrollTop; } else if(QEb.document.documentElement.scrollTop && QEb.document.documentElement.scrollTop > 0) { return QEb.document.documentElement.scrollTop; } return 0;}function rw_getScrollBarWidth(QEb){ if(hga) { if(fga) { return 20; } else { if(typeof(QEb) =="undefined") { QEb = window; } if(QEb.document.compatMode.equalsTH("CSS1Compat")) { return (QEb.document.documentElement.offsetWidth - QEb.document.documentElement.clientWidth); } else { return (QEb.document.body.offsetWidth - QEb.document.body.clientWidth); } } } else { if(window.scrollMaxY > 0 || oga) { return 18; } else { return 4; } }}function rw_getScrollBarHeight(QEb){ if(typeof(QEb) =="undefined") { QEb = window; } if(hga) { if(fga) { return 20; } else { if(QEb.document.compatMode.equalsTH("CSS1Compat")) { return (QEb.document.documentElement.offsetWidth - QEb.document.documentElement.clientWidth); } else { return (QEb.document.body.offsetWidth - QEb.document.body.clientWidth); } } } else { if(QEb.scrollMaxX > 0) { return 18; } else { return 4; } }}function HDb(){ var ZKb = null; var SJb = null; if(window.getSelection) {var UJb = window.getSelection(); var VJb = null; if(!UJb.isCollapsed) { ZKb = window; VJb = UJb; } else { if(Dma && Dma.selectionStart != Dma.selectionEnd) { return {frame:window, range:new String(zqa +"0"+ Cra + Dma.value.substring( Dma.selectionStart, Dma.selectionEnd) + zqa +"1"+ Cra)}; } if(top.frames.length>0) { var i=0; var tZb = top.frames.length; for(i = 0; i<tZb; i++) { try { var fHb = top.frames[i].getSelection(); if(fHb != null && !fHb.isCollapsed) { ZKb = top.frames[i]; VJb = fHb; break; } } catch(e) { pJb(e); } } } } if(VJb == null) { return null; } var MDb = null; if(VJb.getRangeAt) { MDb = VJb.getRangeAt(0); } else { var range = dJb(); if(range != null) { if( VJb.anchorNode == VJb.focusNode && VJb.anchorOffset == VJb.focusOffset) { range = BJb(VJb); } else { range.setStart(VJb.anchorNode, VJb.anchorOffset); range.setEnd(VJb.focusNode, VJb.focusOffset); if(range.toString().length == 0) { range.setStart(VJb.focusNode, VJb.focusOffset); range.setEnd(VJb.anchorNode, VJb.anchorOffset); } } MDb = range; } } if(MDb != null) { var NDb = MDb.startContainer; var ODb = MDb.startOffset; var PDb = MDb.endContainer; var QDb = MDb.endOffset; if(NDb.nodeType != 3) { if(NDb.nodeType != 1) { return null; } else { if(ODb > 0) { if(NDb.hasChildNodes() && NDb.childNodes.length > ODb) { NDb = NDb.childNodes[ODb]; if(NDb.nodeType == 3) { ODb = 0; } else { ODb = 0; if(NDb.toString() =="[object HTMLEmbedElement]") { return null; } } } } } } if(PDb.nodeType != 3) { if(PDb.nodeType != 1) { return null; } else { if(PDb.hasChildNodes()) { if(PDb.childNodes.length > QDb) { PDb = PDb.childNodes[QDb]; } else { PDb = PDb.childNodes[QDb - 1]; if(PDb.nodeType != 3) { var BWb = iva(PDb, true); if(BWb != null) { PDb = BWb; } } } } if(PDb.nodeType != 3) { var SDb = wua(NDb, true, null); var BWb = Zwa(PDb, true, SDb); if(BWb != null) { PDb = BWb; } } if(PDb.nodeType == 3) { QDb = PDb.nodeValue.length; } else { QDb = 0; } } } SJb = new Hpa(NDb, ODb, PDb, QDb); } else { return null; } } else if (document.selection) {var range = document.selection.createRange(); if(range == null || range.text == null || range.text.length == 0) { if(top.frames.length>0) { var i=0; var tZb = top.frames.length; for(i = 0; i<tZb; i++) { try { var OUb = top.frames[i]; range = OUb.document.selection.createRange(); if(range != null && range.text != null && range.text.length > 0) { ZKb = OUb; SJb = range; break; } } catch(e) { pJb(e); } } } } else { ZKb = window; SJb = range; } if(SJb != null && SJb.parentElement() != null && SJb.parentElement().tagName.toLowerCase() =="input") { SJb = new String(SJb.text); } } if(ZKb != null && SJb != null) { return {frame:ZKb, range:SJb}; } else { return null; }}function XDb(){ var UKb = HDb(); if(UKb != null && UKb.range != null && !(UKb.range instanceof String)) { if(hga) { UKb.range = LFb(UKb.frame.document.body, UKb.range); } else if(UKb.range instanceof Hpa) { UKb.range = wFb(UKb.range); } } return UKb;}function aDb(){ var kRb = HDb(); if(kRb != null) { var UKb = kRb.range; if(UKb instanceof String) { return UKb; } else if(UKb instanceof cpa) { return UKb.toString(); } else { return kRb.range.text; } } return"";}function hDb(oYb){ try { var ZKb = mJb(oYb); if(ZKb == null || oYb == null || oYb.parentNode == null) { return; } var x = 0; var y = 0; var kRb = oYb; if(kRb.nodeType == 3) { kRb = kRb.parentNode; } var dDb = kRb; var eDb = kRb.ownerDocument.body; var fDb = false; var gDb = null; while(dDb != null && dDb != eDb) { if(dDb.tagName.toLowerCase() =="div"|| dDb.tagName.toLowerCase() =="form") { var jDb = dDb.clientHeight; var kDb = dDb.clientWidth; var lDb = ICb(dDb); var mDb = false; if(lDb != null && lDb.overflow !="visible") { if(dDb.scrollHeight > jDb && lDb.overflowY !="visible") { mDb = true; } if(dDb.scrollWidth > kDb && lDb.overflowX !="visible") { mDb = true; } } if(mDb) { var nDb = 0; var oDb = 0; var fHb = kRb; while(fHb != dDb && fHb != null) { nDb += fHb.offsetTop; oDb += fHb.offsetLeft; fHb = BEb(fHb, dDb); } if(dDb.scrollTop > nDb || (dDb.scrollTop + jDb) < (nDb + kRb.offsetHeight)) { if(jDb > (kRb.offsetHeight * 6)) { dDb.scrollTop = nDb - kRb.offsetHeight; } else { dDb.scrollTop = nDb; } } if(dDb.scrollLeft > oDb || (dDb.scrollLeft + kDb) < (oDb + kRb.offsetWidth)) { dDb.scrollLeft = oDb; } fDb = true; gDb = dDb; } } dDb = dDb.parentNode; } if(gDb != null) { kRb = gDb; } while (kRb != null) { x += kRb.offsetLeft; y += kRb.offsetTop; kRb = kRb.offsetParent; } var qDb; var rDb; var sDb; var tDb; var uDb = 30; if (oYb.nodeType == 3) { uDb = 10 + 5 * oYb.nodeValue.length; if (uDb > 60) { uDb = 60; } } qDb = rw_getScreenOffsetLeft(ZKb); rDb = rw_getScreenOffsetTop(ZKb); if(typeof( ZKb.innerWidth ) =='number') { sDb = ZKb.innerWidth; tDb = ZKb.innerHeight; } else if(ZKb.document.documentElement.clientHeight > 0 && ZKb.document.documentElement.clientWidth > 0) { sDb = ZKb.document.documentElement.clientWidth; tDb = ZKb.document.documentElement.clientHeight; } else { sDb = ZKb.document.body.clientWidth; tDb = ZKb.document.body.clientHeight; } sDb = sDb - uDb; tDb = tDb - 20; var vDb; var wDb; if(fDb) { } vDb = (x < qDb || x > (qDb + sDb)); wDb = (y < rDb || y > (rDb + tDb)); if (vDb || wDb && (x != 0 || y != 0)) { if (x > (qDb + sDb)) { x = (x + qDb) / 2; } if (y > (rDb + tDb)) { y = (y + rDb) / 2; } var xDb = $g_bMouseSpeech; if($g_bMouseSpeech) { $g_bMouseSpeech = false; } ZKb.scrollTo((vDb?x:qDb), (wDb?y:rDb)); if(xDb) { var yDb = setTimeout("$g_bMouseSpeech = true;", 500); } } } catch(ignore) { pJb(ignore); } g_bDidScroll = false;}function BEb(yYb, GNb){ var zDb = yYb; var AEb = zDb.offsetParent; if(AEb == null) { return null; } if(GNb == null) { return AEb; } while(zDb != null && zDb != AEb) { if(zDb == GNb) { return null; } zDb = zDb.parentNode; } return AEb;}function FEb(){ var xTb =""+"rw_getDisplayWidth="+ rw_getDisplayWidth() +"  rw_getDisplayWidthAdjusted="+ rw_getDisplayWidthAdjusted() +"  rw_getDocumentDisplayWidth="+ rw_getDocumentDisplayWidth() +"  rw_getDocumentDisplayWidthAdjusted="+ rw_getDocumentDisplayWidthAdjusted() +"  rw_getDisplayHeight="+ rw_getDisplayHeight() +"  rw_getDisplayHeightAdjusted="+ rw_getDisplayHeightAdjusted() +"  rw_getDocumentDisplayHeight="+ rw_getDocumentDisplayHeight() +"  rw_getDocumentDisplayHeightAdjusted="+ rw_getDocumentDisplayHeightAdjusted() +"  rw_getScreenOffsetLeft="+ rw_getScreenOffsetLeft() +"  rw_getScreenOffsetTop="+ rw_getScreenOffsetTop() +"  rw_getScrollBarWidth="+ rw_getScrollBarWidth() +"  rw_getScrollBarHeight="+ rw_getScrollBarHeight(); ILb(xTb);}function LEb(){ var GEb = HDb(); var HEb = XDb(); var IEb = aDb();}function NEb(OEb){ hDb(document.getElementById(OEb));}var JEb = null;function PEb(QEb){ var xTb ="th_tmp$"; var HVb = 1; var WXb; var TEb = true; while(TEb) { WXb = xTb + HVb; if(QEb.document.getElementById(WXb)) { ++HVb; } else { TEb = false; } } return WXb;}function rw_getTargetNodeAsCaretIE(evt, aEb){ try { if(kga && aEb && !wna(evt)) { var UEb = evt.srcElement; var ZKb = mJb(UEb); var WEb = UEb.childNodes.length; var i; var XEb = false; for(i=0; i<WEb; i++) { if(UEb.childNodes[i].nodeType == 3) { XEb = true; break; } } if(XEb) { if(JEb == null) { JEb = PEb(ZKb); } var YEb = ZKb.document.getElementById(JEb); if(YEb != null) { YEb.parentNode.removeChild(YEb); } var range = ZKb.document.selection.createRange(); range.collapse(); range.pasteHTML("<span id='"+ JEb +"'></span>"); var cab = ZKb.document.getElementById(JEb); var cEb; var dEb = null; if(cab.nextSibling != null && cab.nextSibling.nodeType == 3) { dEb = cab.nextSibling; cEb = new THCaret(cab.nextSibling, 0, true); } else if(cab.previousSibling != null && cab.previousSibling.nodeType == 3) { dEb = cab.previousSibling; cEb = new THCaret(cab.previousSibling, cab.previousSibling.nodeValue.length, false); } else if(cab.nextSibling != null && cab.nextSibling.nodeType == 1) { cEb = new THCaret(cab.nextSibling, 0, true); } else if(cab.previousSibling != null && cab.previousSibling.nodeType == 1) { cEb = new THCaret(cab.previousSibling, 0, true); } else { cEb = new THCaret(cab.parentNode, 0, true); } cab.parentNode.removeChild(cab); if(dEb != null) { cEb.node = wIb(dEb); } return cEb; } else { return new THCaret(UEb, 0, true); } } var eEb = Yma(evt); var fEb = dJb(evt.srcElement.ownerDocument.body); fEb.moveToPoint(eEb.x, eEb.y); var mEb = dJb(evt.srcElement.ownerDocument.body); var hEb = dJb(evt.srcElement.ownerDocument.body); var iEb = evt.srcElement.firstChild; while((iEb != null)) { if(iEb.nodeType == 3 && iEb.nodeValue.trimTH().length > 0) { wIb(iEb); var mYb = iEb.previousSibling; while(mYb != null && mYb.nodeType != 1) { mYb = mYb.previousSibling; } if(mYb != null) { mEb.moveToElementText(mYb); mEb.collapse(false); } else { mEb.moveToElementText(iEb.parentNode); } var kEb = iEb.nextSibling; while(kEb != null && kEb.nodeType != 1) { kEb = kEb.nextSibling; } if(kEb != null) { hEb.moveToElementText(kEb); mEb.setEndPoint("EndToStart", hEb); } else { hEb.moveToElementText(iEb.parentNode); mEb.setEndPoint("EndToEnd", hEb); } if(mEb.inRange(fEb)) { var Kab = uEb(iEb, mEb, fEb); return new THCaret(iEb, Kab, true); } } iEb = iEb.nextSibling; } } catch(exc) { oJb("rw_getTargetNodeAsCaretIE error:"+ exc.message); } return null;}function rw_getTextRangeAsRefPtIE(eJb, NFb){ try { var mEb = dJb(eJb); var parentNode = NFb.parentElement(); mEb.moveToElementText(parentNode); var Kab = uEb(parentNode, mEb, NFb); var oEb = npa(parentNode, Kab); return oEb; } catch(exc) { oJb("rw_getTextRangeAsRefPtIE error:"+ exc.message); } return null;}function uEb(vEb, HTb, xEb){ try { var Kab = 0; var range = HTb.duplicate(); range.collapse(); range.move("character", 1); range.move("character", -1); var yEb = 0; var zEb = 0; while(range.compareEndPoints("EndToEnd", xEb) == -1) { range.moveEnd("character", 1); yEb = range.text.length; if(yEb > zEb) { ++Kab; zEb = yEb; } } return Kab; } catch(err) { return 0; }}function LFb(eJb, NFb){ var ZUb = NFb.duplicate(); ZUb.collapse(true); var BFb = rw_getTextRangeAsRefPtIE(eJb, ZUb); ZUb = NFb.duplicate(); ZUb.collapse(false); var CFb = rw_getTextRangeAsRefPtIE(eJb, ZUb); return new cpa(eJb, BFb, CFb);}function rw_getAsTextRange(eJb, cFb, eFb, dFb, fFb){ var range = dJb(eJb); var fWb = UBb(eJb, cFb, -1, dFb, -1); var zVb = fWb.zVb; var AWb = fWb.AWb; if(zVb != null && AWb != null) { var GFb = zVb.node; if(GFb.nodeType == 3) { var Kab = Cqa(GFb); GFb = GFb.parentNode; eFb += Kab; } var IFb = AWb.node; if(IFb.nodeType == 3) { var Kab = Cqa(IFb); IFb = IFb.parentNode; fFb += Kab; } range.moveToElementText(GFb); range.collapse(); jFb(range, eFb); range.collapse(false); range.select(); var KFb = dJb(eJb); KFb.moveToElementText(IFb); KFb.collapse(); jFb(KFb, fFb); KFb.collapse(false); range.setEndPoint("EndToEnd", KFb); } else { range = null; oJb("Error with rw_getAsTextRange."); } return range;}function jFb(HTb, aZb){ var tZb; var hFb; var iFb; tZb = HTb.text.length; while(aZb != 0) { iFb = HTb.moveEnd("character", aZb); if(iFb == 0) { return; } hFb = HTb.text.length; aZb -= (hFb - tZb); tZb = hFb; }}function qFb(tFb){ if(tFb == null || tFb.zVb == null || tFb.AWb == null) { return null; } return new cpa(tFb.zVb.node.ownerDocument.body, npa(tFb.zVb.node, tFb.zVb.offset), npa(tFb.AWb.node, tFb.AWb.offset));}function wFb(BGb){ if(BGb == null || BGb.rVb == null || BGb.sVb == null) { return null; } else { return new cpa(BGb.body, BGb.rVb, BGb.sVb); }}function AGb(BGb){ if(BGb == null || BGb.rVb == null || BGb.sVb == null) { return null; } else { var zVb = ABb( BGb.body, BGb.rVb.path, BGb.rVb.offset, true); var AWb = ABb( BGb.body, BGb.sVb.path, BGb.sVb.offset, false); if(zVb != null && AWb != null) { return new qoa(BGb.body, zVb, AWb); } else { return null; } }}function CGb(HTb){ if(HTb == null || HTb.rVb == null || HTb.sVb == null) { return null; } else { var zVb = ABb( HTb.body, HTb.rVb.path, HTb.rVb.offset, true); var AWb = ABb( HTb.body, HTb.sVb.path, HTb.sVb.offset, false); if(zVb != null && AWb != null) { return new qoa(zVb, AWb); } else { return null; } }}var EGb = null;var FGb = null;function IGb(zTb){ var flash = null; var HGb; if (window.document.WebToSpeech) { HGb = window.document; } else {HGb = window; } switch(zTb) { case 1: flash = HGb.SWA1; break; case 2: flash = HGb.SWA2; break; case 3: flash = HGb.SWA3; break; case 4: flash = HGb.SWA4; break; case 5: flash = HGb.SWA5; break; case 6: flash = HGb.SWA6; break; case 7: flash = HGb.SWA7; break; case 8: flash = HGb.SWA8; break; case 9: flash = HGb.SWA9; break; case 10: flash = HGb.SWA10; break; default: flash = HGb.SWA1; } return flash;}function $rw_event_click(event, i){ return $rw_event_hover(event, i);}function $rw_event_hover(event, i){ if(Ida && oga) { $rw_tagSentences(); } if(!vfa) { return; } if(!Pda) { if(dca) { throw"The page has not fully loaded, click and speak is not available yet."; } else { ILb("The page has not fully loaded, click and speak is not available yet."); } return; } $g_bMouseSpeech = !$g_bMouseSpeech; if(i > -1) { wfa[i][8] = !wfa[i][8]; if(oga) { document.images[wfa[i][0]].src = wfa[i][Sha].src; } else { Nia(wfa[i][0],"toggleOn", true); } } if(Dha && $g_bMouseSpeech) { if(Lda > -1 && typeof($rw_event_sticky) !="undefined") { $rw_event_sticky(event, Lda); var KGb = Gga; Gga = 0; Foa("sticky"); Gga = KGb; } } if(!$g_bMouseSpeech) { $rw_event_stop(); jma(false); lma(false); } else { jma(true); } try { var flash = IGb(uga); if(flash != null) { flash.setClickToSpeakFlag($g_bMouseSpeech); } } catch(err) { oJb("call to flash click to speak failed."); }}function $rw_isPaused(){ return (vfa && cka && $rw_isSpeaking() && cka() != null && cka().isPaused());}function $rw_event_play(){ if(vfa) { try { if(g_speakableTextAreaTarget != null) { if($rw_isPaused()) { $rw_event_pause(); return; } if(g_nSpeakableTextAreaTimerId != 0) { clearTimeout(g_nSpeakableTextAreaTimerId); g_nSpeakableTextAreaTimerId = 0; if(g_speakableTextAreaTarget == null) { $rw_event_play(); return; } } var MGb = g_speakableTextAreaTarget; MGb.focus(); g_speakableTextAreaTarget = null; rw_speakHoverTarget(new THHoverTarget(MGb.ownerDocument.body, XAb(MGb), null)); } else if(wga) { var flash = IGb(uga); xga = true; flash.clickOnPlay(); flash.focus(); } else { if($rw_isPaused()) { $rw_event_pause(); return; } var OGb = XDb(); if(OGb != null && OGb.range != null) { var eSb = OGb.range; if(eSb instanceof String) { rw_speakHoverTarget(eSb); } else { if(hga) { var range = TJb(); range.collapse(); range.select(); } else { var range = TJb(); range.collapseToStart(); } var target = new THHoverTarget(null, null, eSb); var QGb; if(eda) { QGb = XGb(target); if(QGb == null) { gda = target; } } else { QGb = target; } if(QGb != null) { target = QGb; rw_speakHoverTarget(target); } else { target.blockCache = !kca; rw_speakHoverTarget(target); } } } else { if(xba != null) { if(Bea == null || yba == true) { yba = false; $rw_speakFirstSentence(); } else { $rw_speakCurrentSentence(); } } } } } catch(err) { pJb(err); } }}function XGb(YGb){ if(YGb == null) { return null; } var fWb = YGb.getCaretRange(); var TPb = xxa(fWb.zVb); var TGb = xxa(fWb.AWb); if(TPb.equals(TGb)) { return null; } else { if(!DLb(TPb)) { TPb = zxa(TPb, TGb.AWb.node); if(TPb == null) { return null; } if(TPb.equals(TGb)) { return null; } } if(!DLb(TGb)) { TGb = Lya(TGb, null); if(TGb == null) { return null; } if(TPb.equals(TGb)) { return null; } } var UGb; var VGb; var eSb = qFb(TPb ); UGb = new THHoverTarget(null, null, eSb); eSb = qFb(TGb ); VGb = new THHoverTarget(null, null, eSb); gda = VGb; return UGb; }}function $rw_event_funplay(){ $rw_event_play();}var ZGb = null;function $rw_speakText(cYb){ var gOb = (new Date).getTime(); if((gOb - vda) < Iea ) { return; } tba = gOb; $rw_event_stop(); var dGb = cYb; if(SpeechStream.pronunciation.checkPronunciation()) { cYb = fRb(cYb); } fGb(cYb, !lca, dGb);}function $rw_speak(cYb, bNoCache, bFilter){ var gOb = (new Date).getTime(); if((gOb - vda) < Iea ) { return; } tba = gOb; $rw_event_stop(); var dGb = cYb; if(bFilter) { if(SpeechStream.pronunciation.checkPronunciation()) { cYb = fRb(cYb); } } fGb(cYb, bNoCache, dGb);}var eGb = String.fromCharCode(160);function fGb(RXb, hGb, iGb){ if(typeof(eba_no_flash) =="boolean"&& eba_no_flash) { rw_sendSocketMessage("THStart"+ RXb +"THEnd"); return; } if(RXb == null && RXb.length == 0) { $rw_doSelection(-1); return; } if(!vfa) { $rw_doSelection(-1); return; } try { if(RXb.indexOf(eGb) > -1) { var Qab = RXb.indexOf(eGb) > -1; while(Qab > -1) { RXb = RXb.replace(eGb," "); Qab = RXb.indexOf(eGb, Qab + 1); } } if(typeof(iGb) =="undefinded"|| iGb == null ) { iGb = RXb; } else { if(iGb.indexOf(eGb) > -1) { var Qab = iGb.indexOf(eGb) > -1; while(Qab > -1) { iGb = iGb.replace(eGb," "); Qab = iGb.indexOf(eGb, Qab + 1); } } } var flash = cka(); if(flash != null) { if(Era && Era.isRange()) { jma(true); lma(true); $rw_doSelection(0); } if(hGb && eca && fca) { flash.startSpeechFromBackup(RXb, !Eha); oIb(); } else { if(SpeechStream.cacheMode.mode == SpeechStream.cacheMode.CACHE_ONLY || SpeechStream.cacheMode.mode == SpeechStream.cacheMode.CACHE_WITH_LIVE_SERVER) { var ePb = qPb(); var rGb; if(SpeechStream.cacheMode.mode == SpeechStream.cacheMode.CACHE_ONLY || SpeechStream.pronunciation.mode == SpeechStream.pronunciation.CLIENT_PRONUNCIATION_FOR_LIVE_SERVER) { rGb = OPb(RXb); } else { rGb = OPb(iGb); } var IWb; if(gca) { var kPb = rPb(rGb); ePb = ePb +"/"+ kPb ; IWb = ePb +"/"+rGb; } else { IWb = ePb +"/"+ rGb; } if(SpeechStream.cacheMode.mode == SpeechStream.cacheMode.CACHE_ONLY) { flash.startSpeechFromCache(IWb, RXb); } else { flash.startSpeechFromCacheWithGen(IWb, RXb, ePb, rGb, !Eha); } oIb(); } else if(SpeechStream.cacheMode.mode == SpeechStream.cacheMode.CACHE_BUILDING_MODE) { var ePb = qPb(); var rGb; if(SpeechStream.pronunciation.mode == SpeechStream.pronunciation.CLIENT_PRONUNCIATION_FOR_LIVE_SERVER) { rGb = OPb(RXb); } else { rGb = OPb(iGb); } var IWb; if(gca) { var kPb = rPb(rGb); ePb = ePb +"/"+ kPb ; IWb = ePb +"/"+rGb; } else { IWb = ePb +"/"+ rGb; } var uGb = KLb(true) + SpeechStream.cacheMode.getLiveServer() +"/"; flash.startSpeechGenerateCache(IWb, RXb, ePb, rGb, !Eha, uGb ); oIb(); } else { flash.startSpeech(RXb, !Eha); oIb(); } } }} catch(err) { pJb(err); }}function vGb(gIb, RXb){ if(RXb.indexOf("\n") > -1) { var yGb = KLb(true) + Hca +"/SpeechCache/"+ gIb +".xml"; var zGb = window.XMLHttpRequest ? new XMLHttpRequest() : new ActiveXObject("Microsoft.XMLHTTP"); zGb.open("HEAD", yGb, false); zGb.send(); return (zGb.status == 404); } return false;}function BHb(RXb, EHb){ if(RXb == null && RXb.length == 0) { $rw_doSelection(-1); return; } if(!vfa) { $rw_doSelection(-1); return; } try { var flash = cka(); if(flash != null) { jma(true); $rw_doSelection(0); flash.startSpeechFromFile(RXb, EHb); oIb(); } } catch(err) { pJb(err); }}function GHb(RXb){ if(RXb == null && RXb.length == 0) { $rw_doSelection(-1); return; } if(!vfa) { $rw_doSelection(-1); return; } try { var flash = cka(); if(flash != null) { jma(true); $rw_doSelection(0); flash.startHighlighting(RXb); } } catch(err) { pJb(err); }}function $rw_event_pause(){ if($rw_isSpeaking()) { var gOb = (new Date).getTime(); if((gOb - vda) < Iea ) { return; } tba = gOb; var flash = cka(); if(flash != null) { if(flash.isPaused()) { flash.resume(); } else { flash.pause(); } } }}function $rw_event_funstop(){ $rw_event_stop();}function $rw_event_stop(){ if(!vfa) { return; } try { if(Wda) { wja(); } jHb.length = 0; Uda = null; gda = null; if(Usa > 0) { clearTimeout(Usa); Usa = 0; } Ssa.length = 0; if(Qsa) { setTimeout("$rw_event_stop()", 100); return; } if(Fra > 0) { clearTimeout(Fra); Fra = 0; } if(Gra > 0) { clearTimeout(Gra); Gra = 0; } if(wga) { var flash = IGb(uga); xga = true; flash.clickOnStop(); flash.focus(); } else { jma(false); lma(false); var flash = cka(); if(flash != null) { flash.stopSpeechAlt(); } } Dra = null; } catch(err) { pJb(err); }}function $rw_event_stop_limited(){ if(!vfa) { return; } try { jHb.length = 0; Uda = null; if(wga) { var flash = IGb(uga); xga = true; flash.clickOnStop(); flash.focus(); } else { jma(false); lma(false); var flash = cka(); if(flash != null) { flash.stopSpeechAlt(); } } } catch(err) { pJb(err); }}function $rw_event_mp3(){ try { var OHb = null; if(Gda != null) { var target = document.getElementById(Gda); if(target!= null) { OHb = Nza(target); } } else { OHb = cHb(); } if(OHb != null) { OHb = OHb.trimTH(); if (OHb.length > 0) { if(OHb.length > Hda) { alert("Too much text was selected for making an MP3 file, there is a "+ (Hda/1024) +"k limit."); return; } var flash = cka(); if(flash != null) { var cYb ="<br>The MP3 file for the text is being generated, <br> "+"this could take some time depending on the amount of text selected.<br><p align=\"center\">"+"<img alt=\"loading\" src=\""+ $g_strFileLoc +"rwimgs/request-processing.gif\"> </p>"; Bna(Sga, cYb); Gna(true, Sga); flash.getMP3File(OHb); } } } } catch(err) { pJb(err); }}function $rw_mp3reply(cYb){ try { if(typeof(eba_mp3_callback) !="undefined") { Gna(false, Sga); eval(""+ eba_mp3_callback +"('"+ cYb +"')"); } else { if(cYb.length > 0) { var RHb ="Save Target As..."; if(!hga) { if(nga) { RHb ="Save Link As..."; } else if(oga) { RHb ="Download Linked File"; } else { RHb ="Save Link As..."; } } cYb ="<br>Right click on the link below and select "+"'"+ RHb +"' to save the mp3 file to your hard drive.<p></p>"+"<a type='application/octet-stream' href=\""+ cYb +"\">Download speech mp3 file.</a><p></p>"; Bna(Sga, cYb); Gna(true, Sga); } } } catch(err) { pJb(err); }}function $rw_event_spell(event, i){ try { if(wga) { wfa[i][8] = !wfa[i][8]; if(oga) { document.images[wfa[i][0]].src = wfa[i][Sha].src; } else { Nia(wfa[i][0],"toggleOn", true); } var flash = IGb(uga); xga = true; flash.setSpelling(wfa[i][8]); flash.focus(); } } catch(err) { pJb(err); }}function $rw_event_homophone(event, i){ try { if(wga) { wfa[i][8] = !wfa[i][8]; if(oga) { document.images[wfa[i][0]].src = wfa[i][Sha].src; } else { Nia(wfa[i][0],"toggleOn", true); } var flash = IGb(uga); xga = true; flash.setHomophone(wfa[i][8]); flash.focus(); } } catch(err) { pJb(err); }}function $rw_event_pred(event, i){ try { if(wga) { wfa[i][8] = !wfa[i][8]; if(oga) { document.images[wfa[i][0]].src = wfa[i][Sha].src; } else { Nia(wfa[i][0],"toggleOn", true); } var flash = IGb(uga); xga = true; flash.setPrediction(wfa[i][8]); flash.focus(); } } catch(err) { pJb(err); }}function $rw_event_submit(){ try { Fga = true; lm_doSubmit(); Fga = false; } catch(err) { pJb(err); }}var VHb ="setWarning";function setWarning(){ $rw_lexiSubmitEvent();}function $rw_lexiSubmitEvent(){ Fga = true;}function XHb(){ if (window.getSelection) {if (window.getSelection() != null && !window.getSelection().isCollapsed) { return true; } if (top.frames.length > 0) { var i = 0; var tZb = top.frames.length; for (i = 0; i < tZb; i++) { try { if (top.frames[i].getSelection() != null && !top.frames[i].getSelection().isCollapsed) { return true; } } catch(e) { pJb(e); } } } } else if (document.selection) {var range = document.selection.createRange(); if (range.text.length > 0) { return true; } if (top.frames.length > 0) { var i = 0; var tZb = top.frames.length; for (i = 0; i < tZb; i++) { try { var OUb = top.frames[i]; range = OUb.document.selection.createRange(); if (range.text != null && range.text.length > 0) { return true; } } catch(e) { pJb(e); } } } } return false;}function cHb(){ var cYb =''; if (window.getSelection) { var UJb = window.getSelection(); if(UJb.isCollapsed) { if(Dma && Dma.selectionStart != Dma.selectionEnd) { return Dma.value.substring( Dma.selectionStart, Dma.selectionEnd); } if(top.frames.length>0) { var i=0; var tZb = top.frames.length; for(i = 0; i<tZb; i++) { try { var fHb = top.frames[i].getSelection(); if(fHb != null && fHb.isCollapsed == false) { UJb = fHb; break; } } catch(e) { pJb(e); } } } } if(UJb.isCollapsed == false) { cYb = UJb.toString(); } else { cYb =""; } } else if (document.selection) {var range = document.selection.createRange(); if (range.text == null || range.text.length == 0) { if (top.frames.length > 0) { var i = 0; var tZb = top.frames.length; for (i = 0; i < tZb; i++) { try { var OUb = top.frames[i]; range = OUb.document.selection.createRange(); if (range.text != null && range.text.length > 0) { break; } } catch(e) { pJb(e); } } } } cYb = range.text; } return cYb;}var iHb = -1;var jHb = new Array();function $rw_doSelection(p_nPosition){ if (p_nPosition < 0) { if(p_nPosition == -2 && $rw_isSpeaking()) { $rw_speechCompleteCallback(); } jma(false); lma(false); nma(false); if(Wda) { wja(); } } else { nma(true); } if(Era && Era.isRange()) { if(p_nPosition != iHb) { if (p_nPosition == -1 || p_nPosition == -2 || p_nPosition == -3) { if (iHb > -1 && Era.hRb != null) { try { var hRb = Era.hRb; var tZb = hRb.length; if (iHb < tZb) { var eSb = hRb[iHb].range; var fWb = UBb(eSb.body, eSb.rVb.path, eSb.rVb.offset, eSb.sVb.path, eSb.sVb.offset); var zVb = fWb.zVb; var AWb = fWb.AWb; if(zVb != null && AWb != null) { rw_removeSpeechHighlight(MMb(zVb, AWb), true); } else { oJb("Cannot determine valid range to remove speech highlight from. "+ zVb +" "+ AWb); } } } catch(err) { oJb("$rw_doSelection:clear last speech:"+ err.toString()); } } iHb = -1; try { Era.unhighlightRange(); } catch(err){oJb("$rw_doSelection:unhighlightRange:"+ err.message);} } else if(Era.hRb != null) { if (iHb == p_nPosition) { return; } var hRb = Era.hRb; var tZb = hRb.length; try { if (iHb > -1 && iHb < tZb) { var eSb = hRb[iHb].range; var fWb = UBb(eSb.body, eSb.rVb.path, eSb.rVb.offset, eSb.sVb.path, eSb.sVb.offset); var zVb = fWb.zVb; var AWb = fWb.AWb; if(zVb != null && AWb != null) { rw_removeSpeechHighlight(MMb(zVb, AWb), true); } else { oJb("Cannot determine valid range to remove speech highlight from. "+ zVb +" "+ AWb); } } } catch(err) { pJb(err); } if (p_nPosition < 0 || p_nPosition >= tZb) { return; } iHb = p_nPosition; var eSb = hRb[p_nPosition].range; var Fab = hRb[p_nPosition].word; try { var fWb = UBb(eSb.body, eSb.rVb.path, eSb.rVb.offset, eSb.sVb.path, eSb.sVb.offset); var zVb = fWb.zVb; var AWb = fWb.AWb; if(zVb != null && AWb != null) { var result = rw_setSpeechRangeImpl(zVb.node, zVb.offset, AWb.node, AWb.offset,"csp"); if(result != null && result.node != null) { hDb(result.node); } else { hDb(zVb.node); } } else { oJb("Cannot determine valid range to add speech highlight from. "+ zVb +" "+ AWb); } } catch(err) { oJb("error with highlight speech range in rw_doSelection:"+ err.message); } } } } if (p_nPosition == -1 || p_nPosition == -2 || p_nPosition == -3) { iHb = -1; Era = null; if(p_nPosition == -1) { if(jHb.length > 0) { var GIb = jHb.shift(); eval(GIb); } } } if(p_nPosition == -3) { var flash = cka(); var EIb = flash.getLastError(); var xTb="An error occurred with speech.  "+ EIb; if(SpeechStream.actionOnError.action == SpeechStream.actionOnError.SKIP) { oJb(xTb); if(jHb.length > 0) { var GIb = jHb.shift(); eval(GIb); } } else { ILb(xTb); } }}function $displayMe(cYb){ ILb(cYb);}function KIb(LIb, MIb, NIb, OIb, a_bool_scrollbars, a_bool_resizable, a_bool_menubar, a_bool_toolbar, a_bool_addressbar, a_bool_statusbar, a_bool_fullscreen){ var HIb = (screen.width - NIb) / 2; var IIb = (screen.height - OIb) / 2; var JIb ='height='+ OIb +',width='+ NIb +',top='+ IIb +',left='+ HIb +',scrollbars='+ a_bool_scrollbars +',resizable='+ a_bool_resizable +',menubar='+ a_bool_menubar +',toolbar='+ a_bool_toolbar +',location='+ a_bool_addressbar +',statusbar='+ a_bool_statusbar +',fullscreen='+ a_bool_fullscreen +''; var PIb = window.open(LIb, MIb, JIb); if (parseInt(navigator.appVersion) >= 4) { PIb.window.focus(); }}function RIb(fIb){ var start = document.cookie.indexOf(fIb +"="); var TIb = start + fIb.length + 1; if (( !start ) && ( fIb != document.cookie.substring(0, fIb.length) )) { return null; } if (start == -1) { return null; } var end = document.cookie.indexOf(";", TIb); if (end == -1) { end = document.cookie.length; } return unescape(document.cookie.substring(TIb, end));}function XIb(fIb, gQb, aIb, gIb, hIb, dIb){ var VIb = new Date(); VIb.setTime(VIb.getTime()); if (aIb) { aIb = aIb * 1000 * 60 * 60 * 24; } var WIb = new Date(VIb.getTime() + (aIb)); document.cookie = fIb +"="+ escape(gQb) + ( ( aIb ) ?";expires="+ WIb.toGMTString() :"") + ( ( gIb ) ?";path="+ gIb :"") + ( ( hIb ) ?";domain="+ hIb :"") + ( ( dIb ) ?";secure":"");}function eIb(fIb, gIb, hIb){ if (RIb(fIb)) { document.cookie = fIb +"="+ ( ( gIb ) ?";path="+ gIb :"") + ( ( hIb ) ?";domain="+ hIb :"") +";expires=Thu, 01-Jan-1970 00:00:01 GMT"; }}function kIb(){ if(aVb()) { var Fab = iUb(); Bna(Wga, Fab); Gna(true, Wga); var jIb = Ona("rwcollatewrapper"); var lIb = document.getElementById("rwCollect"); if(lIb != null) { if(parseInt(jIb.scrollHeight) >= 380) {var rwTextCollect = Ona("rwTextCollect"); rwTextCollect.style.height = (360); } else {var rwTextCollect = Ona("rwTextCollect"); rwTextCollect.style.height = (jIb.scrollHeight + 24); } }}}function $rw_event_axendolink(event){ document.location ="http://www.browsealoud.info";}function dis(node){ ILb(node.tagName +"|"+ node.nodeValue +"|"+ XAb(node));}function $rw_event_test(event){ }function oIb(){ if(typeof(eba_speech_started_callback) =="string") { try { eval(eba_speech_started_callback +"();"); } catch(err) { pJb(err); } }}function $rw_renderingSpeechCallback(){ if(typeof(eba_rendering_speech_callback) =="string") { try { eval(eba_rendering_speech_callback +"();"); } catch(err) { pJb(err); } }}function $rw_speechCompleteCallback(){ if(typeof(eba_speech_complete_callback) =="string") { try { eval(eba_speech_complete_callback +"();"); } catch(err) { pJb(err); } }}function rw_pageCompleteCallBack(){ if(typeof(eba_page_complete_callback) =="string") { try { eval(eba_page_complete_callback +"();"); } catch(err) { pJb(err); } }} function $rw_event_calculator() { try { Bna(aga,""); Gna(true, aga); rw_calClearMem(); rw_calAddDigit('0'); } catch(err) { pJb(err); } }function $rw_event_generate_cache(){ try { $rwj.blockUI({ message:'<div id="rwDragMeGenerateCache" class="rwToolbarCaptionGenerateCache" ignore> Caching page please wait...</div><br><span id="pb1" ignore>0%</span>'}); $rwj('#pb1').progressBar(0); afa(); } catch(err) { pJb(err); }}function $rw_event_check_cache(){ try { $rwj.blockUI({ message:'<div id="rwDragMeGenerateCache" class="rwToolbarCaptionGenerateCache" ignore> Reading Cache please wait...</div><br><span id="pb1" ignore>0%</span>'}); $rwj('#pb1').progressBar(0); sfa(); } catch(err) { $rwj.unblockUI(); pJb(err); }}function wIb(oYb){ var iNb = oYb.ownerDocument; var vNb = oYb.parentNode; if(vNb != null && oYb.nodeType == 3) { while(oYb.previousSibling != null && oYb.previousSibling.nodeType == 3) { var cYb = oYb.previousSibling.nodeValue + oYb.nodeValue; var vXb = iNb.createTextNode(cYb); vNb.removeChild(oYb.previousSibling); vNb.replaceChild(vXb, oYb); oYb = vXb; } while(oYb.nextSibling != null && oYb.nextSibling.nodeType == 3) { var cYb = oYb.nodeValue + oYb.nextSibling.nodeValue; var vXb = iNb.createTextNode(cYb); vNb.removeChild(oYb.nextSibling); vNb.replaceChild(vXb, oYb); oYb = vXb; } } return oYb;}function BJb(CJb){ try { var cYb = CJb +""; cYb = cYb.trimTH(); CJb.collapseToStart(); var uVb = CJb.anchorNode; var EJb = CJb.anchorOffset; if(uVb.nodeType != 3) { uVb = Jxa(uVb, false, null); EJb = 0; } else if(EJb == uVb.nodeValue.length) { uVb = Jxa(uVb, false, null); EJb = 0; } if(uVb != null && uVb.nodeType == 3) { var FJb = uVb.nodeValue.substring(EJb); var GJb = FJb.trimStartTH(); while(FJb.length > GJb.length) { if(GJb.length == 0) { uVb = Jxa(uVb, false, null); EJb = 0; if(uVb == null || uVb.nodeType != 3) { break; } } else { EJb += FJb.length - GJb.length; } FJb = uVb.nodeValue.substring(EJb); GJb = FJb.trimStartTH(); } } var range = dJb(); if(uVb == null) { range.setStart(CJb.anchorNode, CJb.anchorOffset); range.setEnd(CJb.anchorNode, CJb.anchorOffset); } else { if(uVb.nodeType != 3) { range = MJb(uVb, EJb, cYb); } else { if((EJb + cYb.length) < uVb.nodeValue.length) { range.setStart(uVb, EJb); range.setEnd(uVb, EJb + cYb.length); } else { range = MJb(uVb, EJb, cYb); } } } return range; } catch(ignore) { var range = dJb(); range.setStart(CJb.anchorNode, CJb.anchorOffset); range.setEnd(CJb.anchorNode, CJb.anchorOffset); return range; }}function MJb(ENb, NWb, LKb){ var range = dJb(ENb.ownerDocument.body); range.setStart(ENb, NWb); range.setEnd(ENb, NWb); var tZb = 0; var IJb = LKb.length + NWb; var BWb = ENb; while(BWb != null && tZb < IJb) { if(BWb.nodeType == 3) { var cYb = BWb.nodeValue; tZb += cYb.length; } if(tZb < IJb) { BWb = Jxa(BWb, false, null); } else { var LJb = tZb - IJb; range.setEnd(BWb, BWb.nodeValue.length - LJb); } } return range;}function TJb(){ var SJb = null; if(window.getSelection) {var UJb = window.getSelection(); var VJb = null; if(UJb.isCollapsed == false) { VJb = UJb; } else { if(top.frames.length > 0) { var i = 0; var tZb = top.frames.length; for(i = 0; i < tZb; i++) { try { if(top.frames[i].getSelection() != null && top.frames[i].getSelection().isCollapsed == false) { VJb = top.frames[i].getSelection(); break; } } catch(e) { pJb(e); } } } } if(VJb == null) { return null; } SJb = VJb; } else if(document.selection) {var range = document.selection.createRange(); if(range.text.length > 0) { ZKb = window; SJb = range; } else { if(top.frames.length > 0) { var i = 0; var tZb = top.frames.length; for(i = 0; i < tZb; i++) { try { var OUb = top.frames[i]; range = OUb.document.selection.createRange(); if(range.text.length > 0) { ZKb = OUb; SJb = range; break; } } catch(e) { pJb(e); } } } } } return SJb;}function aJb(){ var cYb =""; if(document.body.createTextRange) { var range = document.body.createTextRange(); range.expand("textedit"); cYb = range.text; } else if(document.createRange) { var range = document.createRange(); range.setStartBefore(document.body); range.setEndAfter(document.body); cYb = range.toString(); } return cYb;}function bJb(oYb){ if(oYb.innerText) { return oYb.innerText; } else if(oYb.textContent) { return oYb.textContent; } else { return""; }}function dJb(eJb){ if(typeof(eJb) =='undefined'|| eJb == null) { eJb = document.body; } if(eJb.createTextRange) { return eJb.createTextRange(); } else if(document.createRange) { var iNb = eJb.ownerDocument; return iNb.createRange(); } else { return null; }}function kJb(oYb){ if(oYb.document) { return oYb.document.body; } else { return oYb.ownerDocument.body; }}function mJb(oYb){ if(oYb == null) { return window; } if(window.frames.length == 0) { return window; } else { var gJb = oYb.ownerDocument.body; var hJb = window.document.body; if(gJb == hJb) { return window; } var i=0; var tZb = top.frames.length; for(i = 0; i<tZb; i++) { var jJb = top.frames[i].document.body; if(jJb == gJb) { return top.frames[i]; } } } return window;}function oJb(Ura){ if(window.console && window.console.log) { window.console.log(Ura); } else if(typeof(dump) !='undefined') { dump(Ura +"\n"); }}function pJb(error){ if(error != null) { if(error.name && error.message) { oJb("Error: "+""+ error.name +". : "+ error.message); } else if(error.message) { oJb("Error: "+""+ error.message); } }}function qJb(cYb){ if(cYb == null) { return""; } cYb = cYb.trimTH(); var wJb =""; var i = 0; var n = cYb.length; var jXb = -1; var kXb = -1; for(i = 0; i < n; i++) { var sKb = cYb.charCodeAt(i); if((sKb > 64 && sKb < 91) || (sKb > 96 && sKb < 123 )) { if(jXb == -1) { jXb = i; } } else { if(jXb > -1) { if(sKb == 39) { if(i < (n - 1)) { nValNext = cYb.charCodeAt(i + 1); if((nValNext > 64 && nValNext < 91) || (nValNext > 96 && nValNext < 123 )) { ++i; } else { kXb = i; break; } } else { kXb = i; break; } } else { kXb = i; break; } } } } if(jXb > -1) { if(kXb > -1) { wJb = cYb.substring(jXb, kXb); } else { wJb = cYb.substring(jXb); } } return wJb;}function vJb(cYb){ if(cYb == null) { return""; } cYb = cYb.trimTH(); cYb = cYb.replace(/[\s\xA0]+/g," "); var wJb =""; var i = 0; var n = cYb.length; var jXb = -1; var kXb = -1; for(i = 0; i < n; i++) { var sKb = cYb.charCodeAt(i); if((sKb > 64 && sKb < 91) || (sKb > 96 && sKb < 123 ) || sKb > 127) { if(jXb == -1) { jXb = i; } } else { if(jXb > -1) { if(sKb == 39) { if(i < (n - 1)) { nValNext = cYb.charCodeAt(i + 1); if((nValNext > 64 && nValNext < 91) || (nValNext > 96 && nValNext < 123 ) || sKb > 127) { ++i; } else { kXb = i; break; } } else { kXb = i; break; } } else { kXb = i; break; } } } } if(jXb > -1) { if(kXb > -1) { wJb = cYb.substring(jXb, kXb); } else { wJb = cYb.substring(jXb); } } return wJb;}function AKb(FKb){ return (FKb > 64 && FKb < 91) || (FKb > 96 && FKb < 123);}function CKb(FKb){ return (FKb > 47 && FKb < 58);}function EKb(FKb){ return (FKb > 47 && FKb < 58) || (FKb > 63 && FKb < 91) || (FKb > 94 && FKb < 123);}function KKb(LKb){ var GKb = false; if (LKb.length > 0) { if (LKb.length > 2) { GKb = true; } if (LKb.length == 2) { var JKb = LKb.charCodeAt(0); var IKb = LKb.charCodeAt(1); if (JKb > 32 && JKb < 127 && IKb > 32 && IKb < 127) { GKb = true; } } else { var JKb = LKb.charCodeAt(0); if (JKb > 32 && JKb < 127) { GKb = true; } } } return GKb;}function NKb(cYb){ if(cYb == null) { return false; } for(var i = 0; i < cYb.length; i++) { var sKb = cYb.charCodeAt(i); if(sKb == 39 || (sKb > 47 && sKb < 58) || (sKb > 64 && sKb < 91) || sKb == 96 || (sKb > 96 && sKb < 123)) { return true; } } return false;}function QKb(RKb){ if(RKb == null || RKb.length == 0) { return RKb; } var tZb = RKb.length; for(var i = 0; i < tZb; i++) { var sKb = RKb.charCodeAt(i); if(! (sKb == 39 || sKb == 44 || sKb == 46 || (sKb > 47 && sKb < 58) || (sKb > 63 && sKb < 91) || (sKb > 94 && sKb < 123))) { RKb = RKb.replace(RKb.charAt(i),' '); } } return RKb.trimTH();}function TKb(range){ var cYb =""; if(range.text) { cYb = range.text; } else { cYb = range.toString(); } return cYb;}function VKb(){ var UKb = TJb(); if(UKb == null) { return; } if(UKb.collapseToStart) { UKb.collapseToStart(); } else if(UKb.execCommand) { UKb.execCommand("UnSelect", false, null); }}function cKb(oYb){ if(oYb != null) { if(hga) { var range = dJb(oYb.ownerDocument.body); range.moveToElementText(oYb) ; range.select(); } else { var BWb = Yva(oYb, false, null); if(BWb != null) { var range = new Hpa(oYb, 0, BWb, 0); eKb(range); } } }}function eKb(HTb){ if(hga) { HTb.select(); } else { var start = HTb.gWb; var end = HTb.hWb; var ZKb = mJb(start.node); if(!oga) { var qVb = ZKb.getSelection(); qVb.collapse(start.node, start.offset); qVb.extend(end.node, end.offset); } else { ZKb.getSelection().setBaseAndExtent(start.node, start.offset, end.node, end.offset); } }}function gKb(hKb){ return (hKb.search(/[\s\xa0]/) > -1);}function iKb(kRb){ var jKb = kRb +"  "; if(kRb.tagName != null) { jKb += kRb.tagName +" "; } if(kRb.className != null) { jKb += kRb.className +" "; } for(prop in kRb) { jKb += prop +"  "+" | "; } alert(jKb);}function kKb(kRb){ var jKb = kRb +"  "; for(prop in kRb) { jKb += prop +"  "+" | "; } return jKb;}function $rw_inputFieldFilter(oUb){ if(oUb == null || oUb.length == 0) { return oUb; } var i; var tZb = oUb.length; for(i = tZb - 1; i >= 0; i--) { var c = oUb.charCodeAt(i); if((c < 44 && c != 39) || c == 47 || (c > 57 && c < 65) || (c > 90 && c < 97 && c != 95) || (c > 122 && c < 128)) { oUb = oUb.substring(0, i) + oUb.substr(i + 1); } } return oUb;}function $rw_handleFieldInput(yYb){ var pre = yYb.value; var post = $rw_inputFieldFilter(pre); if(pre != post) { yYb.value = post; }}function $rw_handleFieldKeyDownInput(evt){ if(!evt.ctrlKey) { var c = evt.keyCode; if((c > 32 && c < 44 && c != 39) || c == 47 || (c > 57 && c < 65) || (c > 90 && c < 97 && c != 95) || (c > 122 && c < 128)) { return false; } } return true;}function pKb(RXb){ RXb = RXb.trimTH(); var tZb = RXb.length; var i; for(i=0; i<tZb; i++) { var c = RXb.charCodeAt(i); if((c > 47 && c < 58) || (c >63 && c<91) || (c>96 && c<123) || c==38 || c==39) { return RXb; } } return"";}function tKb(uKb){ var tZb = uKb.length; var i = 0; var sKb; for(i=0; i<tZb; i++) { sKb = uKb.charCodeAt(i); if((sKb > 63 && sKb < 91) || (sKb > 96 && sKb < 123) || (sKb > 127 && sKb != 160)) { return true; } else if(sKb > 46 && sKb < 58) { return true; } else if((sKb > 35 && sKb < 39) || sKb == 43 || sKb == 61) { return true; } else if(sKb == 39 || sKb == 42 || sKb == 45 || sKb == 92 || (sKb > 93 && sKb < 97)) { if(Xca != null) { if(Xca !="VW Kate") { return true; } } else { if(Nca !="VW Kate") { return true; } } } } return false;}function DLb(ELb){ try { if(ELb == null || ELb.zVb == null || ELb.AWb == null) { return false; } var zVb = ELb.zVb; var AWb = ELb.AWb; var xKb = zVb.node; var yKb = AWb.node; var zKb = true; var ALb = false; var SOb = xKb; var cYb =""; while(SOb != null) { ALb = fta(SOb); if(ALb || SOb.nodeType == 3) { var ARb = Wza(SOb); if(ARb != null && ARb !="") { if(SOb == yKb && AWb.offset > -1) { ARb = ARb.substring(0, AWb.offset); } if(SOb == xKb && zVb.offset > 0) { ARb = ARb.substring(zVb.offset); } if(tKb(ARb)) { return true; } } } if(ALb) { SOb = Yva(SOb, false, yKb); } else { if(zKb) { SOb = Kva(SOb, true, yKb); } else { SOb = Dva(SOb, false, yKb); } } zKb = false; } } catch(err) { pJb(err); } return false;}function GLb(d){ return d.toString(16);}function HLb(h){ return parseInt(h,16);}function ILb(oUb){ if(Aca) { alert(oUb); } else { oJb(oUb); }}function $rw_enable_alerts(p_bEnable){ if(typeof(p_bEnable) =="boolean") { Aca = p_bEnable; }}function $rw_uriEncode(oUb){ return encodeURIComponent(oUb);}function KLb(LLb){ if(LLb) { return ((Zda||ada)?"https://":"http://"); } else { return ((Zda||bda)?"https://":"http://"); }}function NLb(iEb){ var cYb =""; if (iEb.nodeType == 3) { cYb = iEb.nodeValue; } else if (iEb.nodeType == 1) { var OLb = iEb.firstChild; while (OLb != null) { if (OLb.nodeType == 3) { cYb += OLb.nodeValue; } else if (OLb.nodeType == 1) { cYb += NLb(OLb); } OLb = OLb.nextSibling; } } return cYb;};function SLb(iEb){ var TSb = null; var QLb = iEb.tagName.toLowerCase(); var eZb = XAb(iEb); if (QLb =="input") { var TLb = iEb.getAttribute("type"); if (TLb != null) { TLb = TLb.toLowerCase(); } var QSb =""; if (TLb == null || TLb.equalsTH("") || TLb.equalsTH("text")) { QSb = iEb.value; } else if (TLb.equalsTH("password")) { QSb ="Masked password field"; } else if (TLb.equalsTH("image")) { QSb =""; } else if (TLb.equalsTH("button") || TLb.equalsTH("submit") || TLb.equalsTH("reset")) { QSb = iEb.getAttribute("value"); } if (QSb.equalsTH("") == false) { TSb ="form:"+ eZb +";"+ QSb; } } else if (QLb =="select") { var QSb =""; var WLb = iEb.selectedIndex; var XLb =""; for (var HVb = 0; HVb < iEb.options.length; HVb++) { XLb += iEb.options[HVb].text +" "; } if (XLb.equalsTH("") == false) { if (WLb > -1) { QSb = iEb.options[WLb].text; QSb +=" selected from the list "+ XLb; } else { QSb ="No selection from the list "+ XLb; } TSb ="form"+ eZb +";"+ QSb; } } else if (QLb =="textarea") { var QSb = iEb.value; TSb ="form"+ eZb +";"+ QSb; } else if (QLb =="option") { var QSb = iEb.value; TSb ="form"+ eZb +";"+ QSb; } return TSb;}var bLb = null;function cLb(bLb){ bLb.setAttribute("onmouseover","top.doMouseOverTH(event)");}function dLb(iEb){ vLb(); if (document.getElementsByTagName("frameset").item(0) != null) { var eLb = document.getElementsByTagName("frameset").item(0); eLb.removeAttribute("thSafariReaderDetails"); eLb.removeAttribute("thSafariReaderAutoDetails"); eLb.removeAttribute("thSafariReaderFlag"); } else { document.body.removeAttribute("thSafariReaderDetails"); document.body.removeAttribute("thSafariReaderAutoDetails"); document.body.removeAttribute("thSafariReaderFlag"); }};function hLb(theFrameSet, strLoc){ var iNb = theFrameSet.document; if (iNb != null) { var sYb = iNb.body; if (sYb != null) { lLb(theFrameSet, strLoc +"."); } } var qLb; var size = theFrameSet.frames.length; for (var i = 0; i < size; i += 1) { var yLb = theFrameSet.frames[i]; qLb = strLoc +".frames["+ i +"]"; hLb(yLb, qLb); }};function lLb(aWindow, baseLoc){ aWindow.String.prototype.trimTH = function() { return this.replace(/^[\s\xA0]+/,"").replace(/[\s\xA0]+$/,""); }; aWindow.String.prototype.equalsTH = function(s) { if (this.length != s.length) { return false; } for (var i = 0; i < this.length; i += 1) { if (this.charAt(i) != s.charAt(i)) { return false; } } return true; }; var sYb = aWindow.document.body; var nLb = sYb.getAttribute("onmouseover"); var oLb = sYb.getAttribute("onclick"); var pLb = sYb.getAttribute("onUnload"); if (typeof nLb =='function') { aWindow.onmouseover = function(event) { nLb(event); top.doMouseOverTH(event); }; } else { aWindow.onmouseover = function(event) { top.doMouseOverTH(event); }; } if (typeof oLb =='function') { aWindow.onclick = function(event) { oLb(event); top.doMouseClickTH(event); }; } else { aWindow.onclick = function(event) { top.doMouseClickTH(event); }; } if (typeof pLb =='function') { aWindow.onunload = function() { pLb(); top.dLb(); }; } else { aWindow.onunload = function() { top.dLb(); }; } var qLb = baseLoc +"document.body"; sYb.setAttribute("body_loc", qLb);};function tLb(kRb){ var rLb = 0; if (kRb) { if (kRb.offsetParent) { while (kRb.offsetParent) { rLb += kRb.offsetLeft; kRb = kRb.offsetParent; if (kRb.offsetParent == null) { rLb += kRb.offsetLeft; } } } else if (kRb.offsetLeft) { rLb += kRb.offsetLeft; } } return rLb;};function uLb(kRb){ var sLb = 0; if (kRb) { if (kRb.offsetParent) { while (kRb.offsetParent) { sLb += kRb.offsetTop; kRb = kRb.offsetParent; if (kRb.offsetParent == null) { sLb += kRb.offsetTop; } } } else if (kRb.offsetTop) { sLb += kRb.offsetTop; } } return sLb;};function vLb(){ setSpeechDetailsTH(""); setSpeechAutoDetailsTH(""); if (document.getElementsByTagName("frameset").item(0) != null) { zLb(top); } else { var sYb = document.body; AMb(sYb); }};function zLb(theFrameSet){ var size = theFrameSet.frames.length; for (var i = 0; i < size; i += 1) { var yLb = theFrameSet.frames[i]; if (yLb.length == 0) { AMb(yLb.document.body); yLb.String.prototype.trimTH = function() { return this.replace(/^[\s\xA0]+/,"").replace(/[\s\xA0]+$/,""); }; yLb.String.prototype.equalsTH = function(s) { if (this.length != s.length) { return false; } for (i = 0; i < this.length; i += 1) { if (this.charAt(i) != s.charAt(i)) { return false; } } return true; }; } else { hLb(yLb); } }};function AMb(iEb){ if (iEb == null) { return; } if (iEb.nodeType == 1) { if (iEb.tagName.toLowerCase() == ("font") && iEb.getAttribute("started") =="1") { var cYb = NLb(iEb); var iNb = iEb.ownerDocument; var vXb = iNb.createTextNode(cYb); iEb.parentNode.replaceChild(vXb, iEb); } else { var EMb = iEb.firstChild; while (EMb != null) { var FMb = EMb; EMb = EMb.nextSibling; AMb(FMb); } } }};function aa(a){};function HMb(xTb){ var nn = 150; if (xTb.length > nn) { while (xTb.length > nn) { var GMb = xTb.substring(0, nn); xTb = xTb.substring(nn); oJb(GMb); } } else { oJb(xTb); }};String.prototype.trimSpaceTH = function(){ return this.replace(/^[\t\r\n ]+/,"").replace(/[ ]+$/,"");};String.prototype.trimSpaceStartTH = function(){ return this.replace(/^[\t\r\n ]+/,"");};String.prototype.trimSpaceEndTH = function(){ return this.replace(/[\t\r\n ]+$/,"");};String.prototype.trimTH = function(){ return this.replace(/^[\s\xA0]+/,"").replace(/[\s\xA0]+$/,"");};String.prototype.trimStartTH = function(){ return this.replace(/^[\s\xA0]+/,"");};String.prototype.trimEndTH = function(){ return this.replace(/[\s\xA0]+$/,"");};String.prototype.equalsTH = function(s){ if (this.length != s.length) { return false; } for (var i = 0; i < this.length; i += 1) { if (this.charAt(i) != s.charAt(i)) { return false; } } return true;};function MMb(NMb, OMb){ var IMb = Cea; Cea = false; var JMb = new Array(); try { var uVb = NMb.node; var vVb = OMb.node; if(uVb.nodeType != 3) { if(uVb.nodeType == 1 && uVb.tagName.toLowerCase() =="math") { JMb.push(uVb); if(uVb == vVb) { return JMb; } else { uVb = Axa(uVb, false, vVb); } } else if(hga && uVb.nodeType == 1 && uVb.firstChild != null && uVb.firstChild.tagName.toLowerCase() =="math") { JMb.push(uVb.firstChild); if(uVb == vVb) { return JMb; } else { uVb = uVb.firstChild; uVb = Axa(uVb, false, vVb); } } else { uVb = eva(uVb, false); if(uVb == null) { return JMb; } } } if(uVb == vVb) { if(uVb.nodeType == 3) { var cYb = uVb.nodeValue; if(cYb.length > 0 && NMb.offset < cYb.length && OMb.offset > 0 && OMb.offset > NMb.offset) { JMb.push(uVb); } } } else { if(uVb.nodeType == 3) { var cYb = uVb.nodeValue; if(cYb.length > 0 && NMb.offset < cYb.length) { JMb.push(uVb); } } else { if(uVb.nodeType == 1 && uVb.tagName.toLowerCase() =="math") { JMb.push(uVb); } else if(hga && uVb.nodeType == 1 && uVb.firstChild != null && uVb.firstChild.tagName.toLowerCase() =="math") { uVb = uVb.firstChild; JMb.push(uVb); } } var BWb = Qxa(uVb, false, vVb, true); while (BWb != null) { if (BWb == vVb) { if(vVb.nodeType == 3) { var cYb = vVb.nodeValue; if(cYb.length > 0 && OMb.offset > 0) { JMb.push(vVb); } } else { if(BWb.nodeType == 1 && BWb.tagName.toLowerCase() =="math") { JMb.push(BWb); } else if(hga && BWb.nodeType == 1 && BWb.firstChild != null && BWb.firstChild.tagName.toLowerCase() =="math") { JMb.push(BWb.firstChild); } } break; } else { JMb.push(BWb); } BWb = Qxa(BWb, false, vVb, true); } } } catch(err){oJb("rw_setHighlight error:"+ err.message);} Cea = IMb; return JMb;}function $rw_setSpeechRangeColours(p_strCols){ vba = p_strCols;}function $rw_setSpeechWordColours(p_strCols){ wba = p_strCols;}function $rw_getSpeechRangeColours(){ return vba;}function $rw_getSpeechWordColours(){ return wba;}var TMb = false;function rw_setHighlight(ENb, JNb, GNb, KNb, SVb){ var UMb = ENb; var VMb = GNb; try { var result = null; if (GNb == ENb) { result = rw_setNodeBackground(ENb, JNb, KNb,"ss", SVb); UMb = result.node; VMb = result.node; } else { if (JNb > 0) { result = rw_setNodeBackground(ENb, JNb, ENb.nodeValue.length,"ss", SVb); } else { result = rw_setNodeBackground(ENb, -1, -1,"ss", SVb); } UMb = result.node; var BWb = Qxa(result.node, false, GNb, true); while (BWb != null) { if (BWb == GNb) { result = rw_setNodeBackground(BWb, 0, KNb,"ss", SVb); BWb = result.node; VMb = BWb; break; } else { result = rw_setNodeBackground(BWb, -1, -1,"ss", SVb); BWb = result.node; } VMb = BWb; BWb = Qxa(BWb, false, GNb, true); } } } catch(err){oJb("rw_setHighlight error:"+ err.message); } return {start: UMb, end: VMb};}function lMb(rMb){ try { if (rMb == null || !(rMb instanceof Array) || rMb.length == 0) { return; } for (var i = 0; i < rMb.length; i++) { var ARb = rMb[i]; if (oMb(ARb)) { var vNb = ARb.parentNode; if(ARb.nextSibling != null || ARb.previousSibling != null) { var cYb = NLb(vNb); var iNb = vNb.ownerDocument; ARb = iNb.createTextNode(cYb); } var xMb = vNb.parentNode; xMb.replaceChild(ARb, vNb); ARb = wIb(ARb); rMb[i] = ARb; } } if(!cma ) { rw_removeSpeechHighlight(rMb, false); } } catch(err){oJb("rw_setHighlight error:"+ err.message);}}function oMb(oYb){ if (oYb.nodeType != 3 || oYb.parentNode == null || oYb.parentNode.parentNode == null) { return false; } var parent = oYb.parentNode; var yMb = parent.getAttribute("rwstate"); if (parent.tagName.toLowerCase() !="font"|| yMb == null || yMb !="ss") { return false; } return true;}function rw_removeSpeechHighlight(rMb, BNb){ try { if(typeof(BNb) =="undefined") { BNb=false; } if (rMb == null || !(rMb instanceof Array) || rMb.length == 0) { return; } for (var i = 0; i < rMb.length; i++) { var ARb = rMb[i]; if (zMb(ARb, BNb)) { var vNb = ARb.parentNode; if(ARb.nextSibling != null || ARb.previousSibling != null) { var cYb = NLb(vNb); var iNb = vNb.ownerDocument; ARb = iNb.createTextNode(cYb); } var xMb = vNb.parentNode; xMb.replaceChild(ARb, vNb); ARb = wIb(ARb); rMb[i] = ARb; if(zMb(ARb, BNb)) { --i; } } else { var tagName =""; if(ARb.nodeType == 1) { tagName = ARb.tagName.toLowerCase(); } if(tagName=="math") { wNb(ARb, null, null, false); } } } } catch(err) { oJb("rw_removeSpeechHighlight failed error:"+ err.message); }}function zMb(oYb, BNb){ if (oYb.nodeType != 3 || oYb.parentNode == null || oYb.parentNode.parentNode == null) { return false; } var parent = oYb.parentNode; var yMb = parent.getAttribute("rwstate"); if (parent.tagName.toLowerCase() =="font"&& yMb != null) { if((BNb == false && yMb =="sp") || yMb =="csp") { return true; } } return false;}function rw_setSpeechRangeImpl(ENb, JNb, GNb, KNb, LNb){ var result = null; try { if (GNb == ENb) { result = rw_setNodeBackground(ENb, JNb, KNb, LNb,""); return result; } if (JNb > 0) { result = rw_setNodeBackground(ENb, JNb, ENb.nodeValue.length, LNb,""); } else { result = rw_setNodeBackground(ENb, -1, -1, LNb,""); } var BWb = Qxa(result.node, false, GNb, true); while (BWb != null) { if (BWb == GNb) { result = rw_setNodeBackground(BWb, 0, KNb, LNb,""); BWb = result.node; break; } else { result = rw_setNodeBackground(BWb, -1, -1, LNb,""); BWb = result.node; } BWb = Qxa(BWb, false, GNb, true); } } catch(err) { oJb("rw_setSpeechRangeImpl error:"+ err.message); } return result;}function NNb(){ this.node = null; this.offset = 0;}function rw_setNodeBackground(dNb, eNb, fNb, gNb, hNb){ var uNb = new NNb(); uNb.node = dNb; uNb.offset = eNb; if (dNb.nodeType != 3) { if(dNb.nodeType == 1 && lta(dNb)) { if(dNb.tagName.toLowerCase() =="math") { var vNb = dNb.parentNode; uNb = bNb(vNb, dNb, eNb, fNb, gNb,""); } else { var WNb = eva(dNb, false); var XNb = iva(dNb, false); if(WNb != null && WNb.nodeType == 3 && XNb != null && XNb.nodeType == 3) { rw_setSpeechRangeImpl(WNb, 0, XNb, XNb.nodeValue.length, gNb); uNb.node = WNb; uNb.offset = 0; } else { } } return uNb; } else { return uNb; } } var iNb = dNb.ownerDocument; var vNb = dNb.parentNode; var aNb = null; if (vNb.tagName.toLowerCase() =="font") { aNb = vNb.getAttribute("rwstate"); } if (gNb =="ss") { if(aNb == null || aNb =="") { uNb = bNb(vNb, dNb, eNb, fNb, gNb, hNb); } else if (aNb =="ss") { return uNb; } else { return uNb; } } else if (gNb =="sp") { if (aNb =="csp") { oJb("fail in rw_setNodeBackground setting sp to csp"); return uNb; } if (aNb =="sp") { oJb("fail in rw_setNodeBackground setting sp to sp"); return uNb; } uNb = bNb(vNb, dNb, eNb, fNb, gNb,""); } else if (gNb =="csp") { if (aNb =="csp") { oJb("fail parent is csp for csp"); return uNb; } if (aNb =="sp") { uNb = bNb(vNb, dNb, eNb, fNb, gNb,""); } else { } } else { } return uNb;}function bNb(cNb, dNb, eNb, fNb, gNb, hNb){var tagName =""; if(dNb.nodeType == 1) { tagName = dNb.tagName.toLowerCase(); } if((dNb.nodeType == 3 && (fNb == -1 || fNb > eNb)) || tagName =="math") { var iNb = cNb.ownerDocument; var oab = false; if (eNb == -1 && fNb == -1) { oab = true; } else if (fNb == -1) { fNb = dNb.nodeValue.length; } if (eNb == 0 && fNb >= dNb.nodeValue.length) { oab = true; } var kNb; if (gNb =="ss") { kNb ="background:"+ hNb; } else if (gNb =="sp") { kNb = vba; } else if (gNb =="csp") { kNb = wba; } else { kNb ="color:#ff000; background:#00ff00"; } if(tagName =="math") { if(gNb !="ss") { wNb(dNb, gNb, kNb, true); } } else { if (oab) { var DOb = iNb.createElement("font"); if(hga) { DOb.style.setAttribute("cssText", kNb, 0); } else { DOb.setAttribute("style", kNb); } DOb.setAttribute("rwstate", gNb); if(gNb !="ss") { DOb.setAttribute("started","1"); } cNb.replaceChild(DOb, dNb); DOb.appendChild(dNb); } else { var cYb = dNb.nodeValue; var nNb; var oNb; var pNb; if (cNb.tagName.toLowerCase() =="span"&& cNb.getAttribute("pron") != null) { nNb =""; oNb = cYb; pNb =""; } else { nNb = cYb.substring(0, eNb); oNb = cYb.substring(eNb, fNb); pNb = cYb.substring(fNb); } var DOb = iNb.createElement("font"); if(hga) { DOb.style.setAttribute("cssText", kNb, 0); } else { DOb.setAttribute("style", kNb); } DOb.setAttribute("rwstate", gNb); if(gNb !="ss") { DOb.setAttribute("started","1"); } var rNb = null; var vXb = null; var tNb = null; if (nNb.length > 0) { rNb = iNb.createTextNode(nNb); } vXb = iNb.createTextNode(oNb); if (pNb.length > 0) { tNb = iNb.createTextNode(pNb); } DOb.appendChild(vXb); cNb.replaceChild(DOb, dNb); if (rNb != null) { cNb.insertBefore(rNb, DOb); } if (tNb != null) { if (DOb.nextSibling == null) { cNb.insertBefore(tNb, null); } else { cNb.insertBefore(tNb, DOb.nextSibling); } } dNb = vXb; } } } var uNb = new NNb(); uNb.node = dNb; if (eNb < 0) { uNb.offset = 0; } else { uNb.offset = eNb; } return uNb;}function wNb(xNb, yNb, zNb, AOb){ if(xNb == null) { return; } if(hga) { var vNb = xNb.parentNode; if(vNb == null) { return; } if(vNb.tagName.toLowerCase() =="font"&& vNb.getAttribute("started") != null) { if(AOb) { vNb.style.setAttribute("cssText", zNb, 0); vNb.setAttribute("rwstate", yNb); } else { var BOb = vNb.parentNode; if(BOb == null) { return; } BOb.replaceChild(xNb, vNb); } } else { if(AOb) { var COb = document.createElement("font"); COb.style.setAttribute("cssText", zNb, 0); COb.setAttribute("started","1"); COb.setAttribute("rwstate", yNb); vNb.replaceChild(COb, xNb); COb.appendChild(xNb); } } } else { var DOb = xNb.firstChild; while(DOb != null) { if(DOb.nodeType == 1) { if(AOb) { if(DOb.getAttribute("started") != null) { DOb.setAttribute("style", zNb); DOb.setAttribute("rwstate", yNb); } else { if(DOb.getAttribute("style") == null) { DOb.setAttribute("style", zNb); DOb.setAttribute("rwstate", yNb); DOb.setAttribute("started","1"); } } } else { if(DOb.getAttribute("started") != null) { DOb.removeAttribute("style"); DOb.removeAttribute("started"); DOb.removeAttribute("rwstate"); } } } DOb = DOb.nextSibling; } }}function GOb(HOb, IOb){ if (HOb == IOb) { return 0; } var EOb = dJb(HOb.ownerDocument.body); EOb.setStart(HOb, 0); EOb.setEnd(HOb, 0); var FOb = dJb(HOb.ownerDocument.body); FOb.setStart(IOb, 0); FOb.setEnd(IOb, 0); return (EOb.compareBoundaryPoints("START_TO_START", FOb));}function JOb(){ this.cYb =""; this.cta =""; this.voice = null; this.fWb = null; };function KOb(oYb){ return ZOb(QOb(oYb));}function MOb(oYb){ if(oYb != null && oYb.nodeType == 1) { return ZOb(oYb.getAttribute("lang")); } return null;}function QOb(oYb){ var SOb = oYb; while(SOb != null) { if(SOb.nodeType == 1) { var POb = SOb.getAttribute("lang"); if(POb != null && POb.length > 0) { return POb; } } SOb = SOb.parentNode; } return null;}function VOb(xKb, yKb, WOb){ var SOb = xKb; SOb = Kva(SOb, false, yKb); while(SOb != null) { var TOb = KOb(SOb); if(TOb != WOb) { var UOb = iwa(SOb, false, xKb); if(UOb.nodeType == 3) { return new THCaret(UOb, UOb.nodeValue.length, false); } else { return new THCaret(UOb, 0, true); } } SOb = Dva(SOb, false, yKb); } return null;}function ZOb(aOb){ if(aOb != null) { var xTb = aOb.toLowerCase(); var YOb; if(xTb =="en"|| xTb=="en-gb") { YOb = ENGLISH; } else if(xTb =="en-us") { YOb = ENGLISH_US; } else if(xTb =="es-us") { YOb = SPANISH; } else if(xTb =="es"|| xTb=="es-es") { YOb = ESPANOL; } else if(xTb =="fr"|| xTb =="fr-fr") { YOb = FRENCH; } else if(xTb =="fr-ca") { YOb = FRENCH_CN; } else if(xTb =="de") { YOb = GERMAN; } else if(xTb =="it") { YOb = ITALIAN; } else if(xTb =="nl") { YOb = DUTCH; } else if(xTb =="sv") { YOb = SWEDISH; } else if(xTb =="en-au") { YOb = AUSTRALIAN; } else { return null; } return Hba[YOb]; } else { return null; }}function eOb(fOb){ if(fOb != null) { if(fOb != Xca) { Xca = fOb; var flash = cka(); flash.setVoiceName(Xca); } } else { if(Xca != null) { Xca = null; var flash = cka(); flash.setVoiceName(Nca); } }}var dOb="ReadHeader1 ReadSection";function ReadHeader1(){ var gOb = (new Date).getTime(); if((gOb - vda) < Iea ) { return; } tba = gOb; var cab = document.getElementsByTagName("H1")[0]; var vXb = Kva(cab, true, cab); if(vXb == null) { return; } if(vXb.nodeType != 3) { vXb = Axa(vXb, true, cab); } if(vXb == null) { return; } var kOb = new THCaret(vXb, 0, true); var target = Dsa(kOb); if(target != null) { var lOb = target.getCaretRange(); if(DLb(lOb)) { var start = lOb.zVb.node; if(target.isRange()) { var end = lOb.AWb.node; start = dya(start); end = iya(end); var rVb = npa(start, 0); var sVb; if(end.nodeType == 1) { sVb = npa(end, 0); } else { sVb = npa(end, end.nodeValue.length); } target.range = new cpa(document.body, rVb, sVb); } var qOb = Tda; $rw_stopSpeech(); Tda = false; rw_speakHoverTarget(target); Tda = qOb; } }}function $rw_getHashCodes() { var rOb =""; var sOb = fxa(document.body); while(sOb != null) { var XPb = Yta(sOb , new Array()); rOb = rOb + qPb() +"/"; var jPb; if(SpeechStream.cacheMode.mode == SpeechStream.cacheMode.CACHE_ONLY || SpeechStream.pronunciation.mode == SpeechStream.pronunciation.CLIENT_PRONUNCIATION_FOR_LIVE_SERVER) { jPb = OPb(XPb.cYb); } else { jPb= OPb(XPb.cta); } rOb = rOb + jPb +"~"; sOb = zxa(sOb); } return rOb;}function $rw_getSoundFileLength(FBb){ var flash = cka(); flash.getSoundFileLength(FBb);}function $rw_soundFileLengthCallback(p_strLength){ alert(p_strLength);}function $rw_barCalInit(){ if(!Kga && Qda) { return; } if(hga) { eCb(Sia,"<link href=\""+ $g_strFileLoc +"rwcalculator.css\" type=\"text/css\" rel=\"stylesheet\" />", false); } else { eCb(Sia,"<link href=\""+ $g_strFileLoc +"rwcalculatorSFF.css\" type=\"text/css\" rel=\"stylesheet\" />", false); } var Tab =""; Tab +='<div id="rwCal" rwTHcomp="1" style="visibility:hidden" texthelpStopContinuous="1">'; Tab +=' <div class="rwCalPopupOutline">'; if(Vca == ENG_UK || Vca == ENG_US) { Tab +='  <div id="rwDragMeCal" class="rwToolbarCaptionCal" >'; } else { Tab +='  <div id="rwDragMeCal" class="rwToolbarSpanCaptionCal" >'; } Tab +='    <img name="calImg" align="right" src="'+ $g_strFileLoc +'rwimgs/thex.bmp" onmouseover="$rw_divOver(8);" onmouseout="$rw_divOut(8);" '+'onmouseup="$rw_divPress(8);" /></div>'; Tab +='<div class="rwCalPopupContent">'; Tab +=' <form name="rw_CalForm" class="rw_CalForm" id="rw_CalForm">'; Tab +='<table class="rw_CalTable">'; Tab +='<tr>'; Tab +='<td colspan="2">'; Tab +='<input type="text" class="rwcaldisplay" maxlength="40" name="rwCalDis" readonly="readonly" />'; Tab +='</td>'; Tab +='</tr>'; Tab +='<tr>'; Tab +='<td colspan="2" class="rwcalspeechbutton">'; Tab +='<input type="checkbox" name="rw_calspeechbutton" /><span>Speech on</span>'; Tab +='</td>'; Tab +='</tr>'; Tab +='<tr>'; Tab +='<td> '; Tab +='<table>'; Tab +='<tr>'; Tab +='<td><input type="button" class="rwcalbutton" value="7" name="seven" onclick="rw_calAddDigit(\'7\')"/></td>'; Tab +='<td><input type="button" class="rwcalbutton" value="8" name="eight" onclick="rw_calAddDigit(\'8\')"/></td>'; Tab +='<td><input type="button" class="rwcalbutton" value="9" name="nine" onclick="rw_calAddDigit(\'9\')"/></td>'; Tab +='</tr>'; Tab +='<tr>'; Tab +='<td><input type="button" class="rwcalbutton" value="4" name="four" onclick="rw_calAddDigit(\'4\')"/></td>'; Tab +='<td><input type="button" class="rwcalbutton" value="5" name="five" onclick="rw_calAddDigit(\'5\')"/></td>'; Tab +='<td><input type="button" class="rwcalbutton" value="6" name="six" onclick="rw_calAddDigit(\'6\')"/></td>'; Tab +='</tr>'; Tab +='<tr>'; Tab +='<td><input type="button" class="rwcalbutton" value="1" name="one" onclick="rw_calAddDigit(\'1\')"/></td>'; Tab +='<td><input type="button" class="rwcalbutton" value="2" name="two" onclick="rw_calAddDigit(\'2\')"/></td>'; Tab +='<td><input type="button" class="rwcalbutton" value="3" name="three" onclick="rw_calAddDigit(\'3\')"/></td>'; Tab +='</tr>'; Tab +='<tr>'; Tab +='<td><input type="button" class="rwcalbutton" value="+/-" name="toggle the sign of the number" onclick="rw_calPlusMinus()"/></td>'; Tab +='<td><input type="button" class="rwcalbutton" value="0" name="zero" onclick="rw_calAddDigit(\'0\')"/></td>'; Tab +='<td><input type="button" class="rwcalbutton" value="." name="decimal point" onclick="rw_calDec()"/></td>'; Tab +='</tr>'; Tab +='</table>'; Tab +='</td>'; Tab +='<td>'; Tab +='<table>'; Tab +='<tr>'; Tab +='<td><input type="button" class="rwcalbutton" value="C" name="clear" onclick="rw_calClearNum()" /></td>'; Tab +='<td><input type="button" class="rwcalbutton" value="AC" name="clear memory" onclick="rw_calClearMem()" /></td>'; Tab +='</tr>'; Tab +='<tr>'; Tab +='<td><input type="button" class="rwcalbutton" value="*" name="multiply" onclick="rw_calFunc(\'*\')" /></td>'; Tab +='<td><input type="button" class="rwcalbutton" value="/" name="divide" onclick="rw_calFunc(\'/\')" /></td>'; Tab +='</tr>'; Tab +='<tr>'; Tab +='<td><input type="button" class="rwcalbutton" value="+" name="plus" onclick="rw_calFunc(\'+\')" /></td>'; Tab +='<td><input type="button" class="rwcalbutton" value="-" name="minus" onclick="rw_calFunc(\'-\')" /></td>'; Tab +='</tr>'; Tab +='<tr>'; Tab +='<td colspan="2"><input type="button" class="rwcalEqbutton" value="=" name="equals" onclick="rw_calEquals()" /></td>'; Tab +='</tr>'; Tab +='</table>'; Tab +='</td>'; Tab +='</tr></table>'; Tab +='</form>'; Tab +='</div></div></div>'; eCb(Sia, Tab, false);}var xOb = 0; var yOb = 16; var zOb = 0; var APb ="0"; var BPb = 0;function rw_calFunc(DPb){ if(xOb != 0) { rw_calEquals(); } if(DPb.indexOf("*") > -1) { xOb = 1; } if(DPb.indexOf("/") > -1) { xOb = 2; } if(DPb.indexOf("+") > -1) { xOb = 3; } if(DPb.indexOf("-") > -1) { xOb = 4; } zOb = BPb; APb =""; }function rw_calDec(){ if(APb.length == 0) { APb ="0."; } else { if(( APb.indexOf(".") == -1) && ( APb.indexOf("e") == -1) ) { APb = APb +"."; } } BPb = parseFloat(APb); document.rw_CalForm.rwCalDis.value = APb; }function rw_calPlusMinus(){ if(APb.indexOf("!") == -1) { BPb = BPb * -1; APb =""+ BPb; } else { APb ="Press 'AC'!"; } document.rw_CalForm.rwCalDis.value = APb; }function rw_calEquals(){ if(APb !="") { if((APb.indexOf("!") == -1)) { if(xOb == 1) { BPb = zOb * BPb; } if(xOb == 2) { if(BPb != 0) { BPb = zOb / BPb; } else { APb ="Cannot divide by zero!"; } } if(xOb == 3) { BPb = zOb + BPb; } if(xOb == 4) { BPb = zOb - BPb; } if(xOb == 2 && BPb == 0) { } else { APb = BPb +""; } xOb = 0; zOb = 0; if(APb.indexOf("Infinity") != -1) { APb ="Value too long!"; } if(APb.indexOf("NaN") != -1) { APb ="N/A!"; } } else { APb ="Press 'AC'!"; } document.rw_CalForm.rwCalDis.value = APb; if(MPb()) { $rw_speakText(APb); } APb ="0"; }}function rw_calAddDigit(IPb){ if(APb.length < yOb) { if(APb.indexOf("!") == -1) { if((parseFloat(APb) == 0) && (APb.indexOf(".") == -1)) { APb = IPb; } else { APb = APb + IPb; } BPb = parseFloat(APb); } else { APb ="Press 'AC'!"; } } document.rw_CalForm.rwCalDis.value = APb; }function rw_calClearNum(){ BPb = 0; APb =""+ BPb; document.rw_CalForm.rwCalDis.value = APb; }function rw_calClearMem(){ BPb = 0; xOb = 0; zOb = 0; APb =""+ BPb; document.rw_CalForm.rwCalDis.value = APb; }function MPb(){ var LPb = document.rw_CalForm.rw_calspeechbutton.checked; if(LPb) { return true; } else { return false; }}function $rw_barCacheInit(){ if(!Kga && Qda) { return; } if(hga) { document.writeln("<link href=\""+ $g_strFileLoc +"rwcache.css\" type=\"text/css\" rel=\"stylesheet\">"); } else { document.writeln("<link href=\""+ $g_strFileLoc +"rwcacheSFF.css\" type=\"text/css\" rel=\"stylesheet\">"); } var Tab =""; Tab +='<div id="rwGenerateCache" rwTHcomp="1" texthelpStopContinuous>'; Tab +='<div class="rwGenerateCachePopupOutline">'; Tab +='<div id="rwDragMeGenerateCache" class="rwToolbarCaptionGenerateCache" ignore>'; Tab +='Loading, please wait...'; Tab +='<img name="displayImg" align="right" src="'+ $g_strFileLoc +'rwimgs/thex.bmp" onMouseOver="$rw_divOver(9)" onMouseOut="$rw_divOut(9)" '+'onMouseUp="$rw_divPress(9)" />'; Tab +='</div>'; Tab +='<div class="rwGenerateCachePopupContent">'; Tab +='<span id="rwGenerateCachedisplay" ignore>'; Tab +=''; Tab +='</span>'; Tab +='</div>'; Tab +='</div>'; Tab +='</div>'; document.writeln(Tab);}function OPb(oUb){ if(Sca == 200) { oUb = oUb.replace(/\s+/g," "); } else { oUb = oUb.replace(/(\x3cbookmark\x20mark\x3d\x22(\d)+\x22\x2f\x3e)/g,""); oUb = oUb.replace(/[\s\xA0]+/g," "); } return AQb(oUb);}function $rw_scholasticHashShort(p_asset){ var cYb = p_asset.replace(/^0+|[^0-9]/g,""); return"0001".substring(0, 4-cYb.length) + cYb.substring(0, 4);}function $rw_scholasticHash(p_asset){ var cYb = p_asset.replace(/^0+|[^0-9]/g,""); if(cYb.length < 4) { cYb ="0001".substring(0, 4-cYb.length) + cYb; } else { cYb = cYb.substring(0, 4); } return cYb;}function $rw_cachePage(fOb, p_strSpeed, p_strBookName) { var VPb = 0; try { if(Sda) { eba_cacheResult ="failure: The embedded speech toolbar cannot be added due to invalid html tag markup in this page."; window.external.completed(eba_cacheResult); return eba_cacheResult; } if(Sca == 300) { if(typeof(p_strBookName) =="string"&& p_strBookName != null && p_strBookName.length > 0) { Qca = p_strBookName; } else { Qca ="1"; } Rca ="1"; } if(dca) { if(p_strSpeed != null) { $rw_setSpeedValue(parseInt(p_strSpeed)); } if(fOb != null) { $rw_setVoice(fOb); } var TPb = fxa(document.body); $rw_doSelection(-2); VPb = aPb(TPb, VPb); } else { eba_cacheResult ="failure: The generate cache flag was set to false, no processing done for this page."; window.external.completed(eba_cacheResult); return eba_cacheResult; } } catch(err) { if(err.message != null) { eba_cacheResult ="failure:"+ err.message; } else { eba_cacheResult ="failure:"+ err; } window.external.completed(eba_cacheResult); return eba_cacheResult; } eba_cacheResult ="success"; if(VPb > 0) { eba_cacheResult = eba_cacheResult +":Warning, encountered "+ VPb +" zero length speech files."; } window.external.completed(eba_cacheResult); return"success";}function aPb(bPb, cPb){ var UPb = bPb; var VPb = cPb; var WPb = 0; while(UPb != null) { var XPb = Yta(UPb, new Array()); var cYb = XPb.cYb; if(cYb == null || cYb.trimTH().length == 0) { if(UPb != null) { var ZPb = zxa(UPb); if(ZPb != null) { UPb = ZPb; } else { if(WPb > 1) { throw"Speech engine generating empty files."; } hPb(); return VPb; } } else { if(WPb > 1) { throw"Speech engine generating empty files."; } hPb(); return VPb; } } var dPb = OPb(cYb); var ePb = oPb(); var cUb = window.external.Generate(cYb, ePb, dPb); if(cUb == 1) { WPb = 0; } else { if(cUb == 2) { throw"Got a Failure response from the speech engine."; } else if(cUb == 3) { ++VPb; ++WPb; if(WPb > 4) { throw"Speech engine generating empty files."; } } } UPb = zxa(UPb); } if(WPb > 1) { throw"Speech engine generating empty files."; } hPb(); return VPb;}function hPb(){ var pab = document.getElementById("pageComplete"); if(pab != null) { pab.click(); }}function lPb(RXb){ if(gca) { var kQb = qPb(); var jPb = OPb(RXb); var kPb = rPb(jPb); return kQb +"/"+ kPb +"/"+jPb; } else { return qPb() +"/"+ OPb(RXb); }}function oPb(){ var xTb = Nca.replace(" ","_"); if(Qda) { return tPb(Pca +"\\"+ Qca +"\\"+ $rw_scholasticHash(Rca) +"\\"+ Rca +"\\"+ xTb + (Zca)); } else { return tPb(Pca +"\\"+ Qca +"\\"+ Rca +"\\"+ xTb + Zca); }}function qPb(){ var xTb = Nca.replace(" ","_"); if(Qda) { return tPb(Pca +"/"+ Qca +"/"+ $rw_scholasticHash(Rca) +"/"+ Rca +"/"+ xTb + Zca); } else { return tPb(Pca +"/"+ Qca +"/"+ Rca +"/"+ xTb + Zca); }}function rPb(sPb){ if(sPb == null || sPb.length < 2) { return"1/1"; } return sPb.substr(0, 1) +"/"+ sPb.substr(1, 1);}function tPb(oUb){ return oUb.replace(/[\x26\x3a\x2a\x3f\x22<>\x7c]/g,""); }var vPb ="";function $rw_speechCacheGenErrorHandler(tfa){ vPb = tfa; var pab = document.getElementById("pageFailed"); if(pab != null) { pab.click(); }}function $rw_getLastError(){ return vPb;}/* The following code is derived from MD5 hash functions (c) Paul Johnston, http://pajhome.org.uk/crypt/md5/. */var xPb = 0; var yPb =""; var zPb = 8;function AQb(s){ return TQb(BQb(RQb(s), s.length * zPb));}function BQb(x, TIb){x[TIb >> 5] |= 0x80 << ((TIb) % 32); x[(((TIb + 64) >>> 9) << 4) + 14] = TIb; var a = 1732584193; var b = -271733879; var c = -1732584194; var d = 271733878; for(var i = 0; i < x.length; i += 16) { var CQb = a; var DQb = b; var EQb = c; var FQb = d; a = HQb(a, b, c, d, x[i+ 0], 7 , -680876936); d = HQb(d, a, b, c, x[i+ 1], 12, -389564586); c = HQb(c, d, a, b, x[i+ 2], 17, 606105819); b = HQb(b, c, d, a, x[i+ 3], 22, -1044525330); a = HQb(a, b, c, d, x[i+ 4], 7 , -176418897); d = HQb(d, a, b, c, x[i+ 5], 12, 1200080426); c = HQb(c, d, a, b, x[i+ 6], 17, -1473231341); b = HQb(b, c, d, a, x[i+ 7], 22, -45705983); a = HQb(a, b, c, d, x[i+ 8], 7 , 1770035416); d = HQb(d, a, b, c, x[i+ 9], 12, -1958414417); c = HQb(c, d, a, b, x[i+10], 17, -42063); b = HQb(b, c, d, a, x[i+11], 22, -1990404162); a = HQb(a, b, c, d, x[i+12], 7 , 1804603682); d = HQb(d, a, b, c, x[i+13], 12, -40341101); c = HQb(c, d, a, b, x[i+14], 17, -1502002290); b = HQb(b, c, d, a, x[i+15], 22, 1236535329); a = IQb(a, b, c, d, x[i+ 1], 5 , -165796510); d = IQb(d, a, b, c, x[i+ 6], 9 , -1069501632); c = IQb(c, d, a, b, x[i+11], 14, 643717713); b = IQb(b, c, d, a, x[i+ 0], 20, -373897302); a = IQb(a, b, c, d, x[i+ 5], 5 , -701558691); d = IQb(d, a, b, c, x[i+10], 9 , 38016083); c = IQb(c, d, a, b, x[i+15], 14, -660478335); b = IQb(b, c, d, a, x[i+ 4], 20, -405537848); a = IQb(a, b, c, d, x[i+ 9], 5 , 568446438); d = IQb(d, a, b, c, x[i+14], 9 , -1019803690); c = IQb(c, d, a, b, x[i+ 3], 14, -187363961); b = IQb(b, c, d, a, x[i+ 8], 20, 1163531501); a = IQb(a, b, c, d, x[i+13], 5 , -1444681467); d = IQb(d, a, b, c, x[i+ 2], 9 , -51403784); c = IQb(c, d, a, b, x[i+ 7], 14, 1735328473); b = IQb(b, c, d, a, x[i+12], 20, -1926607734); a = JQb(a, b, c, d, x[i+ 5], 4 , -378558); d = JQb(d, a, b, c, x[i+ 8], 11, -2022574463); c = JQb(c, d, a, b, x[i+11], 16, 1839030562); b = JQb(b, c, d, a, x[i+14], 23, -35309556); a = JQb(a, b, c, d, x[i+ 1], 4 , -1530992060); d = JQb(d, a, b, c, x[i+ 4], 11, 1272893353); c = JQb(c, d, a, b, x[i+ 7], 16, -155497632); b = JQb(b, c, d, a, x[i+10], 23, -1094730640); a = JQb(a, b, c, d, x[i+13], 4 , 681279174); d = JQb(d, a, b, c, x[i+ 0], 11, -358537222); c = JQb(c, d, a, b, x[i+ 3], 16, -722521979); b = JQb(b, c, d, a, x[i+ 6], 23, 76029189); a = JQb(a, b, c, d, x[i+ 9], 4 , -640364487); d = JQb(d, a, b, c, x[i+12], 11, -421815835); c = JQb(c, d, a, b, x[i+15], 16, 530742520); b = JQb(b, c, d, a, x[i+ 2], 23, -995338651); a = KQb(a, b, c, d, x[i+ 0], 6 , -198630844); d = KQb(d, a, b, c, x[i+ 7], 10, 1126891415); c = KQb(c, d, a, b, x[i+14], 15, -1416354905); b = KQb(b, c, d, a, x[i+ 5], 21, -57434055); a = KQb(a, b, c, d, x[i+12], 6 , 1700485571); d = KQb(d, a, b, c, x[i+ 3], 10, -1894986606); c = KQb(c, d, a, b, x[i+10], 15, -1051523); b = KQb(b, c, d, a, x[i+ 1], 21, -2054922799); a = KQb(a, b, c, d, x[i+ 8], 6 , 1873313359); d = KQb(d, a, b, c, x[i+15], 10, -30611744); c = KQb(c, d, a, b, x[i+ 6], 15, -1560198380); b = KQb(b, c, d, a, x[i+13], 21, 1309151649); a = KQb(a, b, c, d, x[i+ 4], 6 , -145523070); d = KQb(d, a, b, c, x[i+11], 10, -1120210379); c = KQb(c, d, a, b, x[i+ 2], 15, 718787259); b = KQb(b, c, d, a, x[i+ 9], 21, -343485551); a = NQb(a, CQb); b = NQb(b, DQb); c = NQb(c, EQb); d = NQb(d, FQb); } return Array(a, b, c, d);}function GQb(q, a, b, x, s, t){ return NQb(OQb(NQb(NQb(a, q), NQb(x, t)), s),b);}function HQb(a, b, c, d, x, s, t){ return GQb((b & c) | ((~b) & d), a, b, x, s, t);}function IQb(a, b, c, d, x, s, t){ return GQb((b & d) | (c & (~d)), a, b, x, s, t);}function JQb(a, b, c, d, x, s, t){ return GQb(b ^ c ^ d, a, b, x, s, t);}function KQb(a, b, c, d, x, s, t){ return GQb(c ^ (b | (~d)), a, b, x, s, t);}function NQb(x, y){ var LQb = (x & 0xFFFF) + (y & 0xFFFF); var MQb = (x >> 16) + (y >> 16) + (LQb >> 16); return (MQb << 16) | (LQb & 0xFFFF);}function OQb(num, cnt){ return (num << cnt) | (num >>> (32 - cnt));}function RQb(xTb){ var PQb = Array(); var mask = (1 << zPb) - 1; for(var i = 0; i < xTb.length * zPb; i += zPb) { PQb[i>>5] |= (xTb.charCodeAt(i / zPb) & mask) << (i%32); } return PQb;}function TQb(binarray){ var SQb = xPb ?"0123456789ABCDEF":"0123456789abcdef"; var xTb =""; for(var i = 0; i < binarray.length * 4; i++) { xTb += SQb.charAt((binarray[i>>2] >> ((i%4)*8+4)) & 0xF) + SQb.charAt((binarray[i>>2] >> ((i%4)*8 )) & 0xF); } return xTb;}function $rw_hash(oUb){ return AQb(oUb);}function VQb(mQb){ return(this["+"+ mQb]);}function YQb(mQb){ var dQb ="+"+ mQb; this[dQb] = null; delete this[dQb]; var Qab = this.Keys$__.indexOf(mQb); if(Qab > -1) { this.Keys$__.splice(Qab, 1); } Qab = this.AllPageKeys$__.indexOf(mQb); if(Qab > -1) { this.AllPageKeys$__.splice(Qab, 1); } if(mQb.indexOf(" ") > -1) { var Qab = mQb.indexOf(" "); var kQb = mQb.substring(0, Qab); Qab = this.MultiwordStart$__.indexOf(kQb); if(Qab > -1) { this.MultiwordStart$__.splice(Qab, 1); } }}function eQb(mQb, gQb, hQb){ var dQb ="+"+ mQb; if(mQb.substr(mQb.length - 3) =="$__") { mQb = mQb.substr(0, mQb.length - 1); } if(mQb != null && mQb.length > 0 && gQb != null && gQb.length > 0) { var iQb = false; if(this[dQb] != null) { iQb = true; if(hQb && !this.isAllPage$__(mQb)) { return; } } this[dQb] = gQb; if(this.Keys$__.indexOf(mQb) == -1) { this.Keys$__[this.Keys$__.length] = mQb; } if(hQb) { if(this.AllPageKeys$__.indexOf(mQb) == -1) { this.AllPageKeys$__[this.AllPageKeys$__.length] = mQb; } } else { if(this.AllPageKeys$__.indexOf(mQb) > -1) { this.AllPageKeys$__.splice(this.AllPageKeys$__.indexOf(mQb), 1); } } if(!iQb) { if(mQb.indexOf(" ") > -1) { var Qab = mQb.indexOf(" "); var kQb = mQb.substring(0, Qab); this.MultiwordStart$__.push(kQb); } } }}function lQb(mQb){ return this.AllPageKeys$__.indexOf(mQb) > -1;}function Dictionary(){ this.add$__ = eQb; this.get$__ = VQb; this.remove$__ = YQb; this.isAllPage$__ = lQb; this.Keys$__ = new Array(); this.AllPageKeys$__ = new Array(); this.MultiwordStart$__ = new Array();}Dictionary.prototype.deleteAll = function(){ if(typeof(this.Keys$__) !="undefined") { var vZb; var i; for(i=0; i< this.Keys$__.length; i++) { vZb = this.Keys$__[i]; this["+"+ vZb] = null; delete this["+"+ vZb]; } this.Keys$__ = new Array(); this.AllPageKeys$__ = new Array(); this.MultiwordStart$__ = new Array(); }};var pQb = new Dictionary();function sQb(oUb){ var Fab; var tZb; var i; var c; if(SpeechStream.pronunciation.encodeData()) { Fab =""; tZb = oUb.length; for(i=0; i<tZb; i++) { c = oUb.charCodeAt(i); if( (c<40 && c!= 33) || c==43 || c== 47 || c==60 || c==62 || c==92 || c==96 || c>126) { var qZb = GLb(c); switch(qZb.length) { case 1: qZb ="0"+ qZb; case 2: Fab +="/x"+ qZb; break; case 3: qZb ="0"+ qZb; case 4: Fab +="/u"+ qZb; break; default: } } else { Fab += oUb.charAt(i); } } } else { Fab =""; tZb = oUb.length; for(i=0; i<tZb; i++) { c = oUb.charCodeAt(i); if(c == 34) { Fab +="%22"; } else if(c == 39) { Fab +="%27"; } else { Fab += oUb.charAt(i); } } } return Fab;}function xQb(oUb){ var vZb = decodeURIComponent(oUb); var Fab =""; var tZb = vZb.length; var i; var ARb; var BRb; for(i=0; i<tZb; i++) { var c = vZb.charAt(i); if(c =='/') { if(i< tZb - 1) { var CRb = vZb.charAt(i + 1); switch(CRb) { case'/': Fab +='/'; i++; break; case'x': if(i<tZb - 3) { ARb = vZb.substr(i + 2, 2); BRb = HLb(ARb); Fab += String.fromCharCode(BRb); i+=3; } break; case'u': if(i<tZb - 5) { ARb = vZb.substr(i + 2, 4); BRb = HLb(ARb); Fab += String.fromCharCode(BRb); i+=5; } break; default: } } else { } } else if(c =='+') { Fab +=' '; } else if (c == 10 || c == 13) { } else if(c =='%') { if(i<tZb - 2) { ARb = vZb.substr(i, 3); if(ARb =="%2f") { Fab +='/'; i+=2; } else if(ARb =="%2a") { Fab +=':'; i-=2; } else if(ARb =="%60") { Fab +='`'; i-=2; } else { if(i<tZb - 9) { ARb = vZb.substr(i, 10); if(ARb =="%26quot%3b") { Fab +='"'; i+=9; } else { if(i<tZb - 6) { ARb = vZb.substr(i,7); if(ARb =="%26quot") { Fab +='"'; i+=6; } else { Fab += c; } } else { Fab += c; } } } else { Fab += c; } } } else { Fab += c; } } else if(c =='&') { if(i<tZb - 5) { ARb = vZb.substr(i, 6); if(ARb =="&#x27") { Fab +='\''; } else if(ARb =="&quot;") { Fab +='"'; } Fab += String.fromCharCode(BRb); i+=5; } } else { Fab += vZb.charAt(i); } } return Fab;}function ERb(oUb){ var Fab =""; var tZb = oUb.length; var i; for(i=0; i<tZb; i++) { var c = oUb.charCodeAt(i); if( (c<40 && c!= 33) || c==43 || c== 47 || c==60 || c==62 || c==92 || c==96 || c>126) { Fab +="&#"+ c +";"; } else { Fab += oUb.charAt(i); } } return Fab;}function IRb(oUb){ var Fab =""; var tZb = oUb.length; var i; for(i=0; i<tZb; i++) { var c = oUb.charCodeAt(i); if( (c<40 && c!= 33) || c==43 || c== 47 || c==60 || c==62 || c==92 || c==96 || c>126) { if(c == 34 || c == 39) { Fab +="\\&#"+ c +";"; } else { Fab +="&#"+ c +";"; } } else { Fab += oUb.charAt(i); } } return Fab;}var LRb ="\\x82\\x91\\x92";var MRb ="\\x93\\x94";var NRb = /^[,.?!;:\x27\x22$]+|[,.?!;:\x27\x22$]+$/g;function TRb(URb){ if(!Fha) { return false; } var nSb = false; var vZb; var QRb; var Fab; var tZb = URb.length; var i; for(i=0; i<tZb; i++) { QRb = URb[i]; Fab = QRb.word.trimTH(); if(Fab.indexOf(" ") > -1) { var WXb = fRb(Fab); if(WXb != Fab) { QRb.word = WXb; nSb = true; } continue; } var value; if(pQb.MultiwordStart$__.indexOf(Fab) > -1) { if(i < tZb - 1) { vZb = Fab +" "+ URb[i+1].word.trimTH(); if( (value = pQb.get$__(vZb)) != null ) { var aRb = value.split(" "); var bRb = aRb[0] +" "; var cRb = aRb[1] +" "; QRb.word = bRb; URb[i+1].word = cRb; nSb = true; continue; } } if(i < tZb - 2) { vZb = Fab +" "+ URb[i+1].word.trimTH() +" "+ URb[i+2].word.trimTH(); if( (value = pQb.get$__(vZb)) != null ) { var aRb = value.split(" "); var bRb = aRb[0] +" "; var cRb = aRb[1] +" "; var dRb = aRb[2] +" "; QRb.word = bRb; URb[i+1].word = cRb; URb[i+2].word = dRb; nSb = true; continue; } } } if( (value = pQb.get$__(Fab)) != null || (value = pQb.get$__(Fab.toLowerCase())) != null) { QRb.word = value +" "; nSb = true; continue; } else { vZb = Fab.replace(LRb,'\''); vZb = vZb.replace(MRb,'"'); if(Fab != vZb) { if( (value = pQb.get$__(vZb)) != null || (value = pQb.get$__(vZb.toLowerCase())) != null) { QRb.word = value +" "; nSb = true; continue; } else { Fab = vZb; vZb = Fab.replace(NRb,''); if(Fab != vZb) { if( (value = pQb.get$__(vZb)) != null || (value = pQb.get$__(vZb.toLowerCase())) != null ) { QRb.word = value +" "; nSb = true; continue; } } } } else { vZb = Fab.replace(NRb,''); if(Fab != vZb) { if( (value = pQb.get$__(vZb)) != null || (value = pQb.get$__(vZb.toLowerCase())) != null ) { QRb.word = value +" "; nSb = true; continue; } } } } } return nSb;}function fRb(RXb){ if(!Fha) { return RXb; } var Fab =""; var hRb = RXb.split(" "); var iRb = new Array(); var tZb = hRb.length; var i; for(i=0; i<tZb; i++) { var kRb = new Fta(null, hRb[i]); iRb.push(kRb); } if(TRb(iRb)) { tZb = iRb.length; for(i=0; i<tZb; i++) { Fab += iRb[i].word; if(i < tZb - 1) { Fab +=" "; } } return Fab; } else { return RXb; }}function pRb(RXb){ var n1; var n2; var lRb; var qab; var rab; var oRb = RXb.split("\r\n"); var i; for(i=0; i<oRb.length; i++) { lRb = oRb[i]; var rRb = lRb.indexOf("&p_pageID=*&") > -1; n1 = lRb.indexOf("&sayThis="); n2 = lRb.indexOf("&likeThis="); qab = lRb.substring(n1 + 9, n2); rab = lRb.substring(n2 + 10); qab = xQb(qab); rab = xQb(rab); pQb.add$__(qab, rab, rRb); } iab();}function uRb(){ }function vRb(){ if(Pca != null && Pca.length > 0 && Qca != null && Qca.length > 0 && Rca != null && Rca.length > 0) { var SSb; if(SpeechStream.cacheMode.getLiveServer() == null) { return; } SSb = KLb(true) + SpeechStream.cacheMode.getLiveServer(); var TSb ="&custID="+ Pca +"&bookID="+ Qca +"&pageID="+ Rca +"&combined=Y"; var flash = cka(); flash.getPronunciationDataAll(SSb, TSb); }}var xRb = 2;function $rw_loadPronCallback(XWb){ if(XWb == null) { if(xRb > 0) { --xRb; vRb(); } else { ILb("Failed to load pronunciation data, this may affect the text to speech function."); } } else { XWb = XWb.trimTH(); if(XWb =="") { if(SpeechStream.pronunciation.mode != SpeechStream.pronunciation.SERVER_PRONUNCIATION) { Eha = true; } } else if(XWb =="-1") { if(xRb > 0) { --xRb; vRb(); } else { ILb("Failed to load pronunciation data, this may affect the text to speech function."); } } else { if(SpeechStream.pronunciation.mode != SpeechStream.pronunciation.SERVER_PRONUNCIATION) { Eha = true; } pRb(XWb); } }}function ASb(VSb, MSb, WSb){ if(Pca != null && Pca.length > 0 && Qca != null && Qca.length > 0 && Rca != null && Rca.length > 0) { var SSb; if(SpeechStream.cacheMode.getLiveServer() == null) { return; } SSb = KLb(true) + SpeechStream.cacheMode.getLiveServer(); var TSb ="&custID="+ Pca +"&bookID="+ Qca +"&pageID="+ (WSb?"*":Rca) +"&sayThis="+ sQb(VSb) +"&likeThis="+ sQb(MSb); var flash = cka(); flash.addPronunciationData(SSb, TSb); }}function $rw_addPronCallback(XWb){ if(XWb == null) { document.getElementById("confirmPageMsg").innerHTML ="Failed to insert."; } else if(XWb =="-1") { document.getElementById("confirmPageMsg").innerHTML ="Failed to insert."; } else { var kab = document.getElementById('createSayThis').value.trimTH(); var QSb = document.getElementById('createLikeThis').value.trimTH(); var oab = document.getElementById('createAllPages').checked; pQb.add$__(kab, QSb, oab); document.getElementById('createSayThis').value =''; document.getElementById('createLikeThis').value =''; document.getElementById("confirmPageMsg").innerHTML ="Pronunciation inserted."; iab(); }}function KSb(VSb, MSb, WSb){ if(Pca != null && Pca.length > 0 && Qca != null && Qca.length > 0 && Rca != null && Rca.length > 0) { var SSb; if(SpeechStream.cacheMode.getLiveServer() == null) { return; } SSb = KLb(true) + SpeechStream.cacheMode.getLiveServer(); var TSb ="&custID="+ Pca +"&bookID="+ Qca +"&pageID="+ (WSb?"*":Rca) +"&sayThis="+ sQb(VSb) +"&likeThis="+ sQb(MSb); var flash = cka(); flash.updatePronunciationData(SSb, TSb); }}function $rw_updatePronCallback(XWb){ if(XWb == null) { document.getElementById("editPageMsg").innerHTML ="Failed to updated."; } else if(XWb =="-1") { document.getElementById("editPageMsg").innerHTML ="Failed to updated."; } else { var kab = document.getElementById('editSayThis').value.trimTH(); var QSb = document.getElementById('editLikeThis').value.trimTH(); var oab = document.getElementById('editAllPages').checked; pQb.add$__(kab, QSb, oab); document.getElementById('editSayThis').value =''; document.getElementById('editLikeThis').value =''; document.getElementById("editPageMsg").innerHTML ="Pronunciation updated."; uab(); iab(); }}function USb(VSb, WSb){ if(Pca != null && Pca.length > 0 && Qca != null && Qca.length > 0 && Rca != null && Rca.length > 0) { var SSb; if(SpeechStream.cacheMode.getLiveServer() == null) { return; } SSb = KLb(true) + SpeechStream.cacheMode.getLiveServer(); var TSb ="&custID="+ Pca +"&bookID="+ Qca +"&pageID="+ (WSb?"*":Rca) +"&sayThis="+ sQb(VSb); var flash = cka(); flash.removePronunciationData(SSb, TSb, VSb); }}function $rw_removePronCallback(XWb, p_strKey){ if(XWb == null) { document.getElementById("editPageMsg").innerHTML ="Failed to delete item."; } else if(XWb =="-1") { document.getElementById("editPageMsg").innerHTML ="Failed to delete item."; } else { pQb.remove$__(p_strKey); document.getElementById('editSayThis').value =''; document.getElementById('editLikeThis').value =''; document.getElementById("editPageMsg").innerHTML ="Pronunciation deleted."; iab(); }}
